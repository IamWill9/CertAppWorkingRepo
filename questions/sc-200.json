{
  "Topic 1": [
    {
      "type": "multiple_choice",
      "question": "\"You have a Microsoft 365 subscription that uses Microsoft Defender for Office 365. \n\n                         You have Microsoft SharePoint Online sites that contain sensitive documents.\n\n                         The documents contain customer account numbers that each consists of 32 alphanumeric characters.\n\n                         You need to create a data loss prevention (DLP) policy to protect the sensitive documents.\n\n                         What should you use to detect which documents are sensitive?",
      "options": [
        "A:SharePoint search",
        "B:a hunting query in Microsoft 365 Defender",
        "C:Azure Information Protection",
        "D:RegEx pattern matching"
      ],
      "answer": [
        "D"
      ],
      "explanation": "RegEx pattern matching is used to identify sensitive information by matching patterns in text."
    },
    {
      "type": "multiple_choice",
      "question": "You need to receive a security alert when a user attempts to sign in from a location that was\n never used by the other users in your organization to sign in. Which anomaly detection policy should you use?",
      "options": [
        "A:Impossible travel",
        "B:Activity from anonymous IP addresses",
        "C:Activity from infrequent country",
        "D:Malware detection"
      ],
      "answer": [
        "C"
      ],
      "explanation": "This is detected by infrequent country rule."
    },
    {
      "type": "multiple_choice",
      "question": "Your company uses line-of-business apps that contain Microsoft Office VBA macros.\n\n                    You need to prevent users from downloading and running additional payloads from\n\n                    the Office VBA macros as additional child processes.\n\n                    Which two commands can you run to achieve the goal? Each correct answer presents a complete solution.\n\n                    NOTE: Each correct selection is worth one point.",
      "options": [
        "A. Add-MpPreference -AttackSurfaceReductionRules_Ids D4F940AB-401B-4EFC-AADC-AD5F3C50688A -AttackSurfaceReductionRules_Actions Enabled",
        "B. Set-MpPreference -AttackSurfaceReductionRules_Ids D4F940AB-401B-4EFC-AADC-AD5F3C50688A -AttackSurfaceReductionRules_Actions AuditMode",
        "C. Add-MpPreference -AttackSurfaceReductionRules_Ids D4F940AB-401B-4EFC-AADC-AD5F3C50688A -AttackSurfaceReductionRules_Actions AuditMode",
        "D. Set-MpPreference -AttackSurfaceReductionRules_Ids D4F940AB-401B-4EFC-AADC-AD5F3C50688A -AttackSurfaceReductionRules_Actions Enabled"
      ],
      "answer": [
        "B",
        "C"
      ],
      "explanation": "Both commands enable audit mode."
    },
    {
      "type": "multiple_choice",
      "question": "Your company uses Microsoft Defender for Endpoint.\n\n                    The company has Microsoft Word documents that contain macros. The documents are used frequently on the devices of the company's accounting team.\n\n                    You need to hide false positive in the Alerts queue, while maintaining the existing security posture.\n\n                    Which three actions should you perform? Each correct answer presents part of the solution.\n\n                    NOTE: Each correct selection is worth one point.",
      "options": [
        "A. Resolve the alert automatically.",
        "B. Hide the alert.",
        "C. Create a suppression rule scoped to any device.",
        "D. Create a suppression rule scoped to a device group.",
        "E. Generate the alert."
      ],
      "answer": [
        "B",
        "D",
        "E"
      ],
      "explanation": "Hide the alert (B): This action removes the alert from the visible queue, ensuring that false positives do not clutter the view for analysts while keeping existing configurations intact.\n\n                           Create a suppression rule scoped to a specific device group (D): By scoping suppression to a specific device group (like the accounting team's devices), you avoid false positives from impacting the broader network while maintaining control over specific devices.\n\n                           Generate the alert (E): Ensures that alerts are created initially, enabling you to evaluate and suppress only those that are deemed false positives, maintaining security visibility for true positives."
    },
    {
      "type": "multiple_choice",
      "question": "You have the following advanced hunting query in Microsoft 365 Defender\n                            DeviceProcessEvents\n                            | where Timestamp > ago(24h)\n                            and InitiatingProcessFileName =~ 'run1132.exe'\n                            and initatingProcessCommandLine !contains '' and initiatingProcessCommandLine != ''\n                            and filename in~ ('schtasks.exe')\n                            and ProcessCommandLine has 'change' and ProcessCommandLine has 'systemrestore'\n                            and ProcessCommandLine has 'disable'\n                            | project Timestamp, AccountName, ProcessCommandLine\n\n                            You need to receive an alert when any process disables System Restore on a device managed by Microsoft Defender during the last 24 hours.\n                            Which two actions should you perform? Each correct answer presents part of the solution.\n                            Note: Each correct selection is worth one point.",
      "options": [
        "A. Create a detection rule.",
        "B. Create a suppression rule..",
        "C. Add | order by Timestamp to the query.",
        "D. Replace DeviceProcessEvents with DeviceNetworkEvents",
        "E. Add DeviceId and ReportId to the output of the query."
      ],
      "answer": [
        "A",
        "E"
      ],
      "explanation": "Correct query is:\n\n            DeviceProcessEvents\n            | where Timestamp > ago (24h)\n            // Pivoting for rundll32\n            | where InitiatingProcessFileName =~ 'rundll32.exe'\n            // Looking for empty command line\n            and InitiatingProcessCommandLine !contains \" \" and InitiatingProcessCommandLine != \"\"\n            // Looking for schtasks.exe as the created process\n            and FileName in~ ('schtasks.exe')\n            // Disabling system restore\n            and ProcessCommandLine has 'Change' and ProcessCommandLine has 'SystemRestore'\n            and ProcessCommandLine has 'disable'\n            | project Timestamp, AccountName, ProcessCommandLine, DeviceId, ReportId\n\n            Given answer is correct:\n            - Create a detection rule\n            - Add ReportId and DeviceId to the output. Both fields are supported in the DeviceProcessEvents table.\n\n            Docs reference:\n            - https://docs.microsoft.com/en-us/microsoft-365/security/defender/advanced-hunting-deviceprocessevents-table?view=o365-worldwide\n            - https://docs.microsoft.com/en-us/microsoft-365/security/defender/advanced-hunting-find-ransomware?view=o365-worldwide# turning-off-system-restore"
    },
    {
      "type": "multiple_choice",
      "question": "You are investigating a potential attack that deploys a new ransomware strain.\n                You have three custom device groups. The groups contain devices that store highly sensitive information.\n                You plan to perform automated actions on all devices.\n                You need to be able to temporarily group the machines to perform actions on the devices.\n                Which three actions should you perform? Each correct answer presents part of the solution.\n                NOTE: Each correct selection is worth one point.",
      "options": [
        "A. Assign a tag to the device group.",
        "B. Add the device users to the admin role.",
        "C. Add a tag to the machines.",
        "D. Create a new device group that has a rank of 1.",
        "E. Create a new admin role.",
        "F. Create a new device group that has a rank of 4."
      ],
      "answer": [
        "A",
        "C",
        "D"
      ],
      "explanation": "There are 3 device groups. You want to take action on all devices, which means you need one device group that includes them all.\n\n                → A: Create a custom group (e.g., AllDeviceTempGroup) and assign a tag filter (e.g., RansomIRTag) to group devices. Initially, no devices appear in this group because they haven't been tagged yet.\n\n                → C: Add the tag RansomIRTag to all the relevant machines.\n\n                → D: Promote the AllDeviceTempGroup to the highest rank (e.g., rank 1) so it overrides existing group memberships, allowing the action to target all tagged devices.\n\n                This enables temporary targeting of all machines via a tag-based, high-ranking device group."
    },
    {
      "type": "multiple_choice",
      "question": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.\n             After you answer a question in this section, you will NOT be able to return to it. As a result, these questions will not appear in the review screen.\n\n            You are configuring Microsoft Defender for Identity integration with Active Directory.\n            From the Microsoft Defender for Identity portal, you need to configure several accounts for attackers to exploit.\n\n            Solution: From Entity tags, you add the accounts as Honeytoken accounts.\n\n            Does this meet the goal?",
      "options": [
        "A. Yes",
        "B. No"
      ],
      "answer": [
        "A"
      ],
      "explanation": "In Microsoft Defender for Identity, a honeytoken account is a decoy user account used to detect attacker activity. By tagging selected Active Directory accounts as 'Honeytoken accounts' under Entity tags, you signal Defender for Identity to raise alerts when those accounts are accessed or used, even if no actual compromise occurs. This helps in early detection of lateral movement or credential harvesting attempts by attackers.\n            Therefore, using the Entity tags feature to mark these accounts as Honeytoken accounts is a correct and valid way to configure them for monitoring in Defender for Identity."
    },
    {
      "type": "multiple_choice",
      "question": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.\n        After you answer a question in this section, you will NOT be able to return to it. As a result, these questions will not appear in the review screen.\n\n        You are configuring Microsoft Defender for Identity integration with Active Directory.\n        From the Microsoft Defender for Identity portal, you need to configure several accounts for attackers to exploit.\n\n        Solution: From Azure AD Identity Protection, you configure the sign-in risk policy.\n\n        Does this meet the goal?",
      "options": [
        "A. Yes",
        "B. No"
      ],
      "answer": [
        "B"
      ],
      "explanation": "No, this does not meet the goal.\n\n            Azure AD Identity Protection's sign-in risk policy is used to detect and respond to suspicious sign-in behaviors, such as those from unfamiliar locations or devices. While useful for identity risk management, it does not relate to configuring decoy (honeypot/honeytoken) accounts within Microsoft Defender for Identity.\n            To configure accounts specifically for attacker exploitation detection, you must use the Defender for Identity portal to tag them as Honeytoken accounts, not configure policies in Azure AD Identity Protection.\n            Therefore, this solution does not meet the stated goal."
    },
    {
      "type": "multiple_choice",
      "question": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.\n            After you answer a question in this section, you will NOT be able to return to it. As a result, these questions will not appear in the review screen.\n\n            You are configuring Microsoft Defender for Identity integration with Active Directory.\n            From the Microsoft Defender for Identity portal, you need to configure several accounts for attackers to exploit.\n\n            Solution: You add the accounts to an Active Directory group and add the group as a Sensitive group.\n\n            Does this meet the goal?",
      "options": [
        "A. Yes",
        "B. No"
      ],
      "answer": [
        "B"
      ],
      "explanation": "Adding an account to an Active Directory group and marking that group as a Sensitive group is used by Microsoft Defender for Identity to prioritize monitoring and raise alerts when members of those groups are accessed or modified. However, that is not the correct method for configuring decoy or bait accounts.\n            To meet the goal of detecting attacker activity against bait accounts, you must specifically tag the accounts as Honeytoken accounts using the Entity tags feature in the Microsoft Defender for Identity portal.\n            Therefore, while marking a group as sensitive is a useful security practice, it does not fulfill the requirement of configuring accounts to be exploited for attacker detection, and thus does not meet the goal."
    },
    {
      "type": "multiple_choice",
      "question": "You implement Safe Attachments policies in Microsoft Defender for Office 365.\n            Users report that email messages containing attachments take longer than expected to be received.\n            You need to reduce the amount of time it takes to deliver messages that contain attachments without compromising security. The attachments must be scanned for malware, and any messages that contain malware must be blocked.\n            What should you configure in the Safe Attachments policies?",
      "options": [
        "A. Dynamic Delivery",
        "B. Replace",
        "C. Block and Enable redirect",
        "D. Monitor and Enable redirect"
      ],
      "answer": [
        "A"
      ],
      "explanation": "Dynamic Delivery delivers messages immediately while scanning attachments in the background.\n            Instead of delaying the entire email, it replaces the attachment with a placeholder until the Safe Attachments scan is complete.\n\n            This ensures:\n            - Messages are received quickly (avoiding delays).\n            - Attachments are still scanned for malware.\n            - Malware is blocked before the actual attachment is delivered.\n\n            It balances user experience and security effectively.\n\n            For more, see Microsoft documentation on Dynamic Delivery in Safe Attachments policies."
    },
    {
      "type": "multiple_choice",
      "question": "You receive a security bulletin about a potential attack that uses an image file.\n            You need to create an indicator of compromise (IoC) in Microsoft Defender for Endpoint to prevent the attack.\n            Which indicator type should you use?",
      "options": [
        "A. a URL/domain indicator that has Action set to Alert only",
        "B. a URL/domain indicator that has Action set to Alert and block",
        "C. a file hash indicator that has Action set to Alert and block",
        "D. a certificate indicator that has Action set to Alert and block"
      ],
      "answer": [
        "C"
      ],
      "explanation": "The attack vector is an image file, which means the most accurate and effective way to detect and block it is to use a file hash indicator.\n            A file hash uniquely identifies a specific file — in this case, the malicious image — and allows Defender for Endpoint to alert on or block the file if it appears in the environment.\n            Setting the action to 'Alert and block' ensures that Defender will actively prevent the file from executing or spreading.\n            URL/domain and certificate indicators are not appropriate here, since the threat is not web-based or certificate-related."
    },
    {
      "type": "multiple_choice",
      "question": "Your company deploys the following services:\n            ✑ Microsoft Defender for Identity\n            ✑ Microsoft Defender for Endpoint\n            ✑ Microsoft Defender for Office 365\n\n            You need to provide a security analyst with the ability to use the Microsoft 365 security center. The analyst must be able to approve and reject pending actions generated by Microsoft Defender for Endpoint. The solution must use the principle of least privilege.\n\n            Which two roles should you assign to the analyst? Each correct answer presents part of the solution.\n            NOTE: Each correct selection is worth one point.",
      "options": [
        "A. the Compliance Data Administrator in Azure Active Directory (Azure AD)",
        "B. the Active remediation actions role in Microsoft Defender for Endpoint",
        "C. the Security Administrator role in Azure Active Directory (Azure AD)",
        "D. the Security Reader role in Azure Active Directory (Azure AD)"
      ],
      "answer": [
        "B",
        "D"
      ],
      "explanation": "Provided answer B and D is correct.\n\n            → **Security Reader** – Allows the analyst to access the Microsoft 365 Security Center and view incidents, alerts, and data.\n\n            → **Active Remediation Actions** – Grants the ability to approve and reject pending actions within Microsoft Defender for Endpoint.\n\n            These roles together meet the requirements without over-provisioning access, adhering to the principle of least privilege."
    },
    {
      "type": "multiple_choice",
      "question": "You need to configure Microsoft Cloud App Security to generate alerts and trigger remediation actions in response to external sharing of confidential files.\n            Which two actions should you perform in the Cloud App Security portal? Each correct answer presents part of the solution.\n            NOTE: Each correct selection is worth one point.",
      "options": [
        "A. From Settings, select Information Protection, select Azure Information Protection, and then select Only scan files for Azure Information Protection classification labels and content inspection warnings from this tenant.",
        "B. Select Investigate files, and then filter App to Office 365.",
        "C. Select Investigate files, and then select New policy from search.",
        "D. From Settings, select Information Protection, select Azure Information Protection, and then select Automatically scan new files for Azure Information Protection classification labels and content inspection warnings.",
        "E. From Settings, select Information Protection, select Files, and then enable file monitoring.",
        "F. Select Investigate files, and then filter File Type to Document."
      ],
      "answer": [
        "D",
        "E"
      ],
      "explanation": "To detect and respond to external sharing of confidential files in Microsoft Cloud App Security (MCAS), you need to enable automatic scanning and monitoring of files:\n            → D: Enabling **automatic scanning for Azure Information Protection (AIP) classification labels** ensures that files containing sensitive information are evaluated as they are uploaded or shared. This enables MCAS to apply DLP policies and alerting logic based on AIP tags and content.\n            → E: **File monitoring** must be enabled to track access, sharing, and modification activity. Without this, MCAS cannot inspect files or trigger alerts based on user actions.\n            Other options such as filtering files or manually initiating searches (B, C, F) are useful for investigation but not sufficient to automate alerting and remediation. Option A limits scanning and does not enable the full monitoring required."
    },
    {
      "type": "multiple_choice",
      "question": "Your company has a single office in Istanbul and a Microsoft 365 subscription.\n            The company plans to use conditional access policies to enforce multi-factor authentication (MFA).\n            You need to enforce MFA for all users who work remotely.\n            What should you include in the solution?",
      "options": [
        "A. a fraud alert",
        "B. a user risk policy",
        "C. a named location",
        "D. a sign-in user policy"
      ],
      "answer": [
        "C"
      ],
      "explanation": "Named locations can be defined by IPv4/IPv6 address ranges or by countries.\n            By defining the Istanbul office IP range as a trusted named location, you can configure conditional access policies to enforce MFA for any sign-ins occurring outside that location — effectively targeting remote users.\n            Reference:\n            https://docs.microsoft.com/en-us/azure/active-directory/conditional-access/location-condition# named-locations"
    },
    {
      "type": "multiple_choice",
      "question": "You are configuring Microsoft Cloud App Security.\n            You have a custom threat detection policy based on the IP address ranges of your company's United States-based offices.\n            You receive many alerts related to impossible travel and sign-ins from risky IP addresses.\n            You determine that 99% of the alerts are legitimate sign-ins from your corporate offices.\n            You need to prevent alerts for legitimate sign-ins from known locations.\n            Which two actions should you perform? Each correct answer presents part of the solution.\n            NOTE: Each correct selection is worth one point.",
      "options": [
        "A. Configure automatic data enrichment.",
        "B. Add the IP addresses to the corporate address range category.",
        "C. Increase the sensitivity level of the impossible travel anomaly detection policy.",
        "D. Add the IP addresses to the other address range category and add a tag.",
        "E. Create an activity policy that has an exclusion for the IP addresses."
      ],
      "answer": [
        "A",
        "B"
      ],
      "explanation": "A. The Data Enrichment API enables you to manage identifiable IP address ranges, such as your physical office IP addresses. IP address ranges allow you to tag, categorize, and customize the way logs and alerts are displayed and investigated.\n\n        B. Add the IP addresses to the corporate address range category. This action allows you to define the IP address ranges that belong to your organization and exclude them from anomaly detection policies such as impossible travel or sign-ins from risky IP addresses."
    },
    {
      "type": "multiple_choice",
      "question": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.\n        After you answer a question in this section, you will NOT be able to return to it. As a result, these questions will not appear in the review screen.\n        You are configuring Microsoft Defender for Identity integration with Active Directory.\n        From the Microsoft Defender for Identity portal, you need to configure several accounts for attackers to exploit.\n        Solution: You add each account as a Sensitive account.\n        Does this meet the goal?",
      "options": [
        "A. Yes",
        "B. No"
      ],
      "answer": [
        "B"
      ],
      "explanation": "Marking accounts as Sensitive in Microsoft Defender for Identity helps prioritize monitoring and alerting for high-value targets, such as admins or executives.\n            However, to **bait attackers** and detect malicious activity early, you must **tag accounts as Honeytoken accounts** — specially designated decoy accounts meant to attract attacker attention.\n            Therefore, while 'Sensitive accounts' are useful for monitoring legitimate users, this solution does **not** fulfill the requirement of configuring accounts **for exploitation purposes**. You must use Honeytoken tagging instead."
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 tenant that uses Microsoft Exchange Online and Microsoft Defender for Office 365.\n        What should you use to identify whether zero-hour auto purge (ZAP) moved an email message from the mailbox of a user?",
      "options": [
        "A. the Threat Protection Status report in Microsoft Defender for Office 365",
        "B. the mailbox audit log in Exchange",
        "C. the Safe Attachments file types report in Microsoft Defender for Office 365",
        "D. the mail flow report in Exchange"
      ],
      "answer": [
        "A"
      ],
      "explanation": "The **Threat Protection Status report** in Microsoft Defender for Office 365 provides visibility into emails that were blocked or remediated by protection features, including **zero-hour auto purge (ZAP)**.\n            According to Microsoft documentation, this report shows counts and details of messages that were impacted by ZAP, Safe Links, Safe Attachments, and anti-phishing protections.\n            Reference: https://docs.microsoft.com/en-us/microsoft-365/security/office-365-security/view-email-security-reports?view=o365-worldwide# threat-protection-status-report"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 subscription that contains 1,000 Windows 10 devices. The devices have Microsoft Office 365 installed.\n        You need to mitigate the following device threats:\n        ✑ Microsoft Excel macros that download scripts from untrusted websites\n        ✑ Users that open executable attachments in Microsoft Outlook\n        ✑ Outlook rules and forms exploits\n        What should you use?",
      "options": [
        "A. Microsoft Defender Antivirus",
        "B. attack surface reduction rules in Microsoft Defender for Endpoint",
        "C. Windows Defender Firewall",
        "D. adaptive application control in Azure Defender"
      ],
      "answer": [
        "B"
      ],
      "explanation": "The correct solution is **attack surface reduction (ASR) rules** in Microsoft Defender for Endpoint.\n            ASR rules specifically mitigate threats like:\n            - Blocking Office applications from creating child processes (protects against malicious macros downloading payloads),\n          - Blocking executable content from email and webmail,\n          - Preventing abuse of Outlook rules and forms for exploitation.\n\n         Reference: https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/attack-surface-reduction-rules-reference?view=o365-worldwide"
    },
    {
      "type": "multiple_choice",
      "question": "You have a third-party security information and event management (SIEM) solution.\n        You need to ensure that the SIEM solution can generate alerts for Azure Active Directory (Azure AD) sign-in events in near real time.\n        What should you do to route events to the SIEM solution?",
      "options": [
        "A. Create an Azure Sentinel workspace that has a Security Events connector.",
        "B. Configure the Diagnostics settings in Azure AD to stream to an event hub.",
        "C. Create an Azure Sentinel workspace that has an Azure Active Directory connector.",
        "D. Configure the Diagnostics settings in Azure AD to archive to a storage account."
      ],
      "answer": [
        "B"
      ],
      "explanation": "The correct approach is to configure **Diagnostics settings in Azure AD to stream logs to an Event Hub**.\n         This allows **real-time streaming** of Azure AD sign-in logs and audit events to external SIEM solutions. Event Hub acts as a bridge for external systems to ingest Azure logs quickly.\n\n        → A and C involve Azure Sentinel, which is a Microsoft-native SIEM and not required here.\n        → D archives logs to storage, which is not suitable for real-time alerting.\n\n        Reference: https://learn.microsoft.com/en-us/azure/active-directory/reports-monitoring/howto-integrate-activity-logs-with-event-hub"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 E5 subscription that uses Microsoft SharePoint Online.\n        You delete users from the subscription.\n        You need to be notified if the deleted users downloaded numerous documents from SharePoint Online sites during the month before their accounts were deleted.\n        What should you use?",
      "options": [
        "A. a file policy in Microsoft Defender for Cloud Apps",
        "B. an access review policy",
        "C. an alert policy in Microsoft Defender for Office 365",
        "D. an insider risk policy"
      ],
      "answer": [
        "D"
      ],
      "explanation": "D: Insider risk policy.\n\n        When users leave your organization, there are specific risk indicators typically associated with data theft by departing users.\n        The 'Data theft by departing users' policy template in Microsoft 365 Insider Risk Management detects such behavior based on signals such as downloading large amounts of documents from SharePoint prior to account deletion.\n\n        Reference: https://learn.microsoft.com/en-us/microsoft-365/compliance/insider-risk-management-policies?view=o365-worldwide# data-theft-by-departing-users"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 subscription that has Microsoft 365 Defender enabled.\n        You need to identify all the changes made to sensitivity labels during the past seven days.\n        What should you use?",
      "options": [
        "A. the Incidents blade of the Microsoft 365 Defender portal",
        "B. the Alerts settings on the Data Loss Prevention blade of the Microsoft 365 compliance center",
        "C. Activity explorer in the Microsoft 365 compliance center",
        "D. the Explorer settings on the Email & collaboration blade of the Microsoft 365 Defender portal"
      ],
      "answer": [
        "C"
      ],
      "explanation": "C: Activity explorer in the Microsoft 365 compliance center\n\n        Activity Explorer provides visibility into user and admin actions across Microsoft 365, including changes to sensitivity labels.\n        It allows you to filter events over the past 7 days (or longer if audit log retention permits) and specifically track actions such as applying, removing, or modifying sensitivity labels on content.\n\n        Why not the others?\n        → A: The Incidents blade shows correlated alerts and incidents — not administrative label changes.\n        → B: DLP Alerts only reflect rule violations, not label change history.\n        → D: Email & collaboration Explorer focuses on threat detection (e.g., phishing), not compliance actions.\n\n        Reference: https://learn.microsoft.com/en-us/purview/sensitivity-labels"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 subscription that uses Microsoft 365 Defender.\n\n        You need to identify all the entities affected by an incident.\nWhich tab should you use in the Microsoft 365 Defender portal?",
      "options": [
        "A. Investigations",
        "B. Devices",
        "C. Evidence and Response",
        "D. Alerts"
      ],
      "answer": [
        "C"
      ],
      "explanation": "Correct Answer - C, Evidence and Response.\n\n        Question emphasizes on 'incident'. Though you can view affected entities by clicking on Alerts tab > Alert list, it will be for that particular\n        alert one alert doesn't necessarily be an incident. An incident can have multiple alerts. So you need to click on Incidents tab, open the Incident, go to Evidences and Response tab and look there."
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 E5 subscription that is linked to a hybrid Azure AD tenant.\nYou need to identify all the changes made to Domain Admins group during the past 30 days.\nWhat should you use?",
      "options": [
        "A. the Modifications of sensitive groups report in Microsoft Defender for Identity",
        "B. the identity security posture assessment in Microsoft Defender for Cloud Apps",
        "C. the Azure Active Directory Provisioning Analysis workbook",
        "D. the Overview settings of Insider risk management"
      ],
      "answer": [
        "A"
      ],
      "explanation": "A: The Modifications of sensitive groups report in Microsoft Defender for Identity provides visibility into changes made to sensitive groups, including the Domain Admins group."
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 subscription. The subscription uses Microsoft 365 Defender and has data loss prevention (DLP) policies that have aggregated alerts configured.\nYou need to identify the impacted entities in an aggregated alert.\nWhat should you review in the DLP alert management dashboard of the Microsoft 365 compliance center?",
      "options": [
        "A. the Events tab of the alert",
        "B. the Sensitive Info Types tab of the alert",
        "C. Management log",
        "D. the Details tab of the alert"
      ],
      "answer": [
        "A"
      ],
      "explanation": "\"The Events tab of the aggregated alert provides a summary of all the events that contributed to the alert, including the impacted entities. This allows you to see which users or items triggered the DLP policy violations that led to the aggregated alert."
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 subscription that uses Microsoft 365 Defender.\nYou plan to create a hunting query from Microsoft Defender.\n\n        You need to create a custom tracked query that will be used to assess the threat status of the subscription.\nFrom the Microsoft 365 Defender portal,\n\n         which page should you use to create the query?",
      "options": [
        "A. Threat analytics",
        "B. Advanced Hunting",
        "C. Explorer",
        "D. Policies & rules"
      ],
      "answer": [
        "B"
      ],
      "explanation": "The Advanced Hunting page in Microsoft 365 Defender allows you to create custom queries using Kusto Query Language (KQL) to assess the threat status of your subscription. You can track these queries and use them for ongoing assessments."
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 subscription that uses Microsoft Defender for Endpoint.\nYou need to add threat indicators for all the IP addresses in a range of 171.23.34.32-171.23.34.63. The solution must minimize administrative effort.\nWhat should you do in the Microsoft 365 Defender portal?",
      "options": [
        "A. Create an import file that contains the individual IP addresses in the range. Select Import and import the file.",
        "B. Create an import file that contains the IP address of 171.23.34.32/27. Select Import and import the file.",
        "C. Select Add indicator and set the IP address to 171.23.34.32-171.23.34.63.",
        "D. Select Add indicator and set the IP address to 171.23.34.32/27."
      ],
      "answer": [
        "A"
      ],
      "explanation": "The most efficient way to add a range of IP addresses as threat indicators in Microsoft Defender for Endpoint is to create an import file that contains the individual IP addresses in the specified range. This allows you to import all the addresses at once, minimizing administrative effort. "
    },
    {
      "type": "multiple_choice",
      "question": "You have an Azure subscription that uses Microsoft Defender for Endpoint.\n\n        You need to ensure that you can allow or block a user-specified range of IP addresses and URLs.\n\n        What should you enable first in the Advanced features from the Endpoints Settings in the Microsoft 365 Defender portal?",
      "options": [
        "A. custom network indicators",
        "B. live response for servers",
        "C. endpoint detection and response (EDR) in block mode",
        "D. web content filtering"
      ],
      "answer": [
        "A"
      ],
      "explanation": "To allow or block user-specified ranges of IP addresses and URLs, you need to enable **custom network indicators** in the Advanced features section of the Microsoft 365 Defender portal. This feature allows you to create custom indicators for network traffic filtering."
    },
    {
      "type": "multiple_choice",
      "question": "Your company has an on-premises network that uses Microsoft Defender for Identity.\n\n        The Microsoft Secure Score for the company includes a security assessment associated with unsecure Kerberos delegation.\n\n        You need remediate the security risk.\n\n        What should you do?",
      "options": [
        "A. Disable legacy protocols on the computers listed as exposed entities.",
        "B. Enforce LDAP signing on the computers listed as exposed entities.",
        "C. Modify the properties of the computer objects listed as exposed entities.",
        "D. Install the Local Administrator Password Solution (LAPS) extension on the computers listed as exposed entities."
      ],
      "answer": [
        "C"
      ],
      "explanation": "The correct remediation for unsecure Kerberos delegation is to update the computer object settings in Active Directory.\n        This typically involves changing the delegation type from 'unconstrained' to either 'none' or 'constrained delegation' to limit which services the account can delegate to.\n\n        Microsoft Defender for Identity flags systems that allow unconstrained delegation because it can expose credentials to attackers if a system is compromised.\n\n        Reference: https://learn.microsoft.com/en-us/defender-for-identity/alerts/alerts-unsecure-kerberos-delegation"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 subscription that uses Microsoft 365 Defender.\n\n        A remediation action for an automated investigation quarantines a file across multiple devices.\n\n        You need to mark the file as safe and remove the file from quarantine on the devices.\n\n        What should you use in the Microsoft 365 Defender portal?",
      "options": [
        "A. From the History tab in the Action center, revert the actions.",
        "B. From the investigation page, review the AIR processes.",
        "C. From Quarantine from the Review page, modify the rules.",
        "D. From Threat tracker, review the queries."
      ],
      "answer": [
        "A"
      ],
      "explanation": "To mark a quarantined file as safe and undo the remediation actions taken by automated investigation and response (AIR), you must use the **History tab in the Action center**.\n\n        The Action center provides a central location where all remediation actions—whether manual or automated—are logged. From the History tab, you can **revert actions**, including releasing quarantined files if they're determined to be false positives.\n\n        → B is used for reviewing process behavior but not for reverting actions.\n        → C is incorrect because modifying rules in the Quarantine Review page doesn't impact already quarantined files.\n        → D, Threat tracker, is used for threat trend analysis, not remediation actions.\n\n        Reference: https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/action-center?view=o365-worldwide"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 E5 subscription that uses Microsoft 365 Defender.\n\n        You need to review new attack techniques discovered by Microsoft and identify vulnerable resources in the subscription. The solution must minimize administrative effort.\n\n        Which blade should you use in the Microsoft 365 Defender portal?",
      "options": [
        "A. Advanced hunting",
        "B. Threat analytics",
        "C. Incidents & alerts",
        "D. Learning hub"
      ],
      "answer": [
        "B"
      ],
      "explanation": "The **Threat analytics** blade in Microsoft 365 Defender is designed to provide security teams with real-time intelligence about emerging threats, including newly discovered attack techniques. It includes:\n\n        - Technical write-ups and threat summaries from Microsoft researchers\n        - Associated indicators of compromise (IOCs)\n        - Insights into how the threat may affect your environment\n        - Automatic correlation with your organization's data to identify at-risk devices and users\n\n        This feature significantly reduces administrative effort by combining threat intelligence with your tenant's exposure data.\n\n        → A (Advanced hunting) is for building custom queries, not for reviewing pre-analyzed threat campaigns.\n        → C (Incidents & alerts) shows alerts but doesn’t provide deep threat intelligence context.\n        → D (Learning hub) provides educational content and is not a tool for operational threat review.\n\n        Reference: https://learn.microsoft.com/en-us/microsoft-365/security/defender/threat-analytics?view=o365-worldwide"
    },
    {
      "type": "multiple_choice",
      "question": "You have an Azure subscription that uses Microsoft Defender for Servers Plan 1 and contains a server named Server1.\n\n        You enable agentless scanning.\n\n        You need to prevent Server1 from being scanned. The solution must minimize administrative effort.\n\n        What should you do?",
      "options": [
        "A. Create an exclusion tag.",
        "B. Upgrade the subscription to Defender for Servers Plan 2.",
        "C. Create a governance rule.",
        "D. Create an exclusion group."
      ],
      "answer": [
        "A"
      ],
      "explanation": "To exclude a specific server from agentless scanning in Microsoft Defender for Servers Plan 1, you can use **exclusion tags**. This approach allows you to tag a machine (e.g., with a specific resource tag like `DefenderAgentlessScan: Exclude`) and configure Defender for Cloud to ignore resources with that tag during agentless scanning.\n\n        This method aligns with the requirement to **minimize administrative effort**, as it's straightforward and doesn't require altering the overall configuration or upgrading the plan.\n\n        → B is incorrect because upgrading to Plan 2 does not inherently stop scanning and would increase administrative overhead.\n        → C (governance rule) and D (exclusion group) are not supported mechanisms for managing agentless scanning exclusions.\n\n        Reference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/agentless-scanning-overview# how-to-exclude-resources"
    },
    {
      "type": "multiple_choice",
      "question": "Case study -\n\nThis is a case study. Case studies are not timed separately. You can use as much exam time as you would like to complete each case. However, there may be additional case studies and sections on this exam. You must manage your time to ensure that you are able to complete all questions included on this exam in the time provided.\n\n            \nTo answer the questions included in a case study, you will need to reference information that is provided in the case study.\n            Case studies might contain exhibits and other resources that provide more information about the scenario that is described in the case study.\n            Each question is independent of the other questions in this case study.\n\nAt the end of this case study,\n            a review screen will appear. This screen allows you to review your answers and to make changes before you move to the next section of the exam.\n            After you begin a new section, you cannot return to this section.\n\nTo start the case study -\nTo display the first question in this case study,\n             click the Next button. Use the buttons in the left pane to explore the content of the case study before you answer the questions.\n             Clicking these buttons displays information such as business requirements, existing environment, and problem statements.\n             If the case study has an All Information tab, note that the information displayed is identical to the information displayed on the subsequent tabs.\n               When you are ready to answer a question, click the Question button to return to the question.\n\n               \nOverview -\n\n               \nFabrikam, Inc. is a financial services company.\n\nThe company has branch offices in New York, London, and Singapore. Fabrikam has remote users located across the globe.\n               The remote users access company resources, including cloud resources, by using a VPN connection to a branch office.\n\n               \nExisting Environment -\n\n               \nIdentity Environment -\n\n               \nThe network contains an Active Directory Domain Services (AD DS) forest named fabrikam.com that syncs with an Azure AD tenant named fabrikam.com. To sync the forest, Fabrikam uses Azure AD Connect with pass-through authentication enabled and password hash synchronization disabled.\n\n               \nThe fabrikam.com forest contains two global groups named Group1 and Group2.\n\n               \nMicrosoft 365 Environment -\n\n               \nAll the users at Fabrikam are assigned a Microsoft 365 E5 license and an Azure Active Directory Premium Plan 2 license.\n\n               \nFabrikam implements Microsoft Defender for Identity and Microsoft Defender for Cloud Apps and enables log collectors.\n\n               \nAzure Environment -\n\nFabrikam has an Azure subscription that contains the resources shown in the following table.\n\n               \nAmazon Web Services (AWS) Environment\n\n               \nFabrikam has an Amazon Web Services (AWS) account named Account1. Account1 contains 100 Amazon Elastic Compute Cloud (EC2) instances that run a custom Windows Server 2022. The image includes Microsoft SQL Server 2019 and does NOT have any agents installed.\n\n               \nCurrent Issues -\n\n               \nWhen the users use the VPN connections, Microsoft 365 Defender raises a high volume of impossible travel alerts that are false positives.\n\n               \nDefender for Identity raises a high volume of Suspected DCSync attack alerts that are false positives.\n\nRequirements -\n\n               \nPlanned changes -\n\n               \nFabrikam plans to implement the following services:\n               \n• Microsoft Defender for Cloud\n• Microsoft Sentinel\n\nBusiness Requirements -\n\n               \nFabrikam identifies the following business requirements:\n\n               • Use the principle of least privilege, whenever possible.\n\n               • Minimize administrative effort.\n\n               \nMicrosoft Defender for Cloud Apps Requirements\n\n               \nFabrikam identifies the following Microsoft Defender for Cloud Apps requirements:\n               \n• Ensure that impossible travel alert policies are based on the previous activities of each user.\n               \n• Reduce the amount of impossible travel alerts that are false positives.\n\n               \nMicrosoft Defender for Identity Requirements\n\n               \nMinimize the administrative effort required to investigate the false positive alerts.\n\n               \nMicrosoft Defender for Cloud Requirements\n\n               \nFabrikam identifies the following Microsoft Defender for Cloud requirements:\n• Ensure that the members of Group2 can modify security policies.\n               \n• Ensure that the members of Group1 can assign regulatory compliance policy initiatives at the Azure subscription level.\n\n               • Automate the deployment of the Azure Connected Machine agent for Azure Arc-enabled servers to the existing and future resources of Account1.\n\n               • Minimize the administrative effort required to investigate the false positive alerts.\n\n               \nMicrosoft Sentinel Requirements -\n\nFabrikam identifies the following Microsoft Sentinel requirements:\n               \n• Query for NXDOMAIN DNS requests from the last seven days by using built-in Advanced Security Information Model (ASIM) unifying parsers.\n               \n• From AWS EC2 instances, collect Windows Security event log entries that include local group membership changes.\n\n               • Identify anomalous activities of Azure AD users by using User and Entity Behavior Analytics (UEBA).\n\n               • Evaluate the potential impact of compromised Azure AD user credentials by using UEBA.\n\n               • Ensure that App1 is available for use in Microsoft Sentinel automation rules.\n\n               • Identify the mean time to triage for incidents generated during the last 30 days.\n\n               • Identify the mean time to close incidents generated during the last 30 days.\n\n               • Ensure that the members of Group1 can create and run playbooks.\n\n               • Ensure that the members of Group1 can manage analytics rules.\n\n               • Run hunting queries on Pool1 by using Jupyter notebooks.\n\n               • Ensure that the members of Group2 can manage incidents.\n\n               • Maximize the performance of data queries.\n\n               • Minimize the amount of collected data.\n\n               \nYou need to minimize the effort required to investigate the Microsoft Defender for Identity false positive alerts.\n\n               \nWhat should you review?",
      "options": [
        "A. the status update time",
        "B. the resolution method of the source computer",
        "C. the alert status",
        "D. the certainty of the source computer"
      ],
      "answer": [
        "D"
      ],
      "explanation": "Reviewing the certainty of the source computer helps determine how confident Defender for Identity is in the classification of a threat. High certainty means fewer false positives, while low certainty may indicate suspicious but inconclusive data. This helps prioritize investigations efficiently and reduce unnecessary manual triage.\n  Reference: https://learn.microsoft.com/en-us/defender-for-identity/view-alerts# alert-confidence-certainty",
      "image": "Images/casestudy1.png"
    },
    {
      "type": "multiple_choice",
      "question": "You need to configure Microsoft Defender for Cloud Apps to generate alerts and trigger remediation actions in response to external sharing of confidential files.\n\n\n        Which two actions should you perform in the Microsoft 365 Defender portal? Each correct answer presents part of the solution.\n\n\n        NOTE: Each correct selection is worth one point.",
      "options": [
        "A. From Settings, select Information Protection, select Azure Information Protection, and then select Only scan files for Azure Information Protection classification labels and content inspection warnings from this tenant.",
        "B. From Cloud apps, select Files, and then filter File Type to Document.",
        "C. From Settings, select Information Protection, select Files, and then enable file monitoring.",
        "D. From Cloud apps, select Files, and then filter App to Office 365.",
        "E. From Cloud apps, select Files, and then select New policy from search.",
        "F. From Settings, select Information Protection, select Azure Information Protection, and then select Automatically scan new files for Azure Information Protection classification labels and content inspection warnings."
      ],
      "answer": [
        "C",
        "F"
      ],
      "explanation": "To detect and remediate external sharing of confidential files in Microsoft Defender for Cloud Apps, you must ensure that files are being **actively monitored and scanned**:\n\n        \n\n        → **C. Enable file monitoring**: This is a prerequisite for tracking file activities such as access, sharing, and changes. Without this, Cloud App Security (MCAS) cannot detect or trigger any remediation.\n\n        \n\n        → **F. Automatically scan new files for Azure Information Protection classification labels**: This ensures that any newly uploaded or modified files are scanned for sensitivity labels and inspected for content, enabling accurate detection of confidential files.\n\n        \n\n        Other options:\n\n        - **A** limits scanning only to labels from your own tenant, which is too restrictive.\n\n        - **B** and **D** are investigation filters and do not enable proactive policy enforcement.\n\n        - **E** helps create a policy, but does not enable the required scanning or monitoring features.\n\n        \n\n        Reference: https://learn.microsoft.com/en-us/cloud-app-security/information-protection"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 E5 subscription that uses Microsoft Defender for Endpoint.\n\n        \n\n        You need to identify any devices that triggered a malware alert and collect evidence related to the alert. The solution must ensure that you can use the results to initiate device isolation for the affected devices.\n\n        \n\n        What should you use in the Microsoft 365 Defender portal?",
      "options": [
        "A. incidents",
        "B. Remediation",
        "C. Investigations",
        "D. Advanced hunting"
      ],
      "answer": [
        "D"
      ],
      "explanation": "The correct answer is **Advanced hunting**, a powerful query-based threat-hunting tool in Microsoft 365 Defender.\n\n        \n\n        Advanced hunting enables security teams to:\n\n        - **Query detailed telemetry data** from across Defender services (including malware alerts and device activity).\n\n        - **Correlate events**, such as a malware alert and the device(s) it occurred on.\n\n        - **Extract identifiers**, like device IDs, alert IDs, or file hashes.\n\n        - Use query results as a basis for **automated actions**, such as triggering device isolation, collecting forensics, or running live response scripts.\n\n        \n\n        → **A. Incidents** are good for grouping and triaging alerts, but don't offer detailed query flexibility.\n\n        → **B. Remediation** focuses on managing actions already decided, not on finding new evidence.\n\n        → **C. Investigations** is used for automated investigation but doesn’t provide the same level of control or insight as custom queries.\n\n        \n\n        Reference: https://learn.microsoft.com/en-us/microsoft-365/security/defender/advanced-hunting-overview?view=o365-worldwide"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 subscription that uses Microsoft Purview and Microsoft Teams.\n\nYou have a team named Team1 that has a project named Project1.\n\nYou need to identify any Project1 files that were stored on the team site of Team1 between February 1, 2023, and February 10, 2023.\n\nWhich KQL query should you run?",
      "options": [
        "A. (c:c)(Project1)(date=(2023-02-01)..date=(2023-02-10))",
        "B. AuditLogs -\n| where Timestamp between (datetime(2023-02-01)..datetime(2023-02-10))\n| where FileName contains “Project1”",
        "C. Project1(c:c)(date=2023-02-01..2023-02-10)",
        "D. AuditLogs -\n| where Timestamp > ago(10d)\n| where FileName contains “Project1”"
      ],
      "answer": [
        "C"
      ],
      "explanation": "C. Project1(c:c)(date=2023-02-01..2023-02-10)\n\nThis query uses Microsoft Purview Content Search Keyword Query Language (KQL) syntax to find all content containing the term 'Project1' within the time range February 1 to February 10, 2023.\nIt correctly filters by both content and date using the format supported by Purview searches.\n\n→ Option A uses a malformed date query structure.\n→ Options B and D are formatted for audit log (Kusto Query Language), not for content search via Microsoft Purview.\n\nReference:\nhttps://learn.microsoft.com/en-us/microsoft-365/compliance/keyword-queries-and-search-conditions?view=o365-worldwide"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 E5 subscription that uses Microsoft Defender for Endpoint.\n\nYou need to create a query that will link the AlertInfo, AlertEvidence, and DeviceLogonEvents tables. The solution must return all the rows in the tables.\n\nWhich operator should you use?",
      "options": [
        "A. search *",
        "B. union kind = inner",
        "C. join kind = inner",
        "D. evaluate hint.remote ="
      ],
      "answer": [
        "B"
      ],
      "explanation": "The correct operator is **union kind=inner**, which ensures that the query combines rows from all specified tables but only includes columns that are common across all of them. This is useful when you need to return all records from multiple tables like AlertInfo, AlertEvidence, and DeviceLogonEvents and want to ensure that only matching columns are returned.\n\n→ Option A (`search *`) performs a full-text search but is not suitable for combining tables.\n→ Option C (`join kind=inner`) performs a relational join but limits results to matching keys, not all rows.\n→ Option D (`evaluate hint.remote =`) is for distributed queries across remote clusters and doesn't apply here.\n\nReference:\nhttps://learn.microsoft.com/en-us/azure/data-explorer/kusto/query/unionoperator"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 E5 subscription that contains 100 Windows 10 devices.\n\nYou onboard the devices to Microsoft Defender 365.\n\nYou need to ensure that you can initiate remote shell connections to the onboarded devices from the Microsoft 365 Defender portal.\n\nWhat should you do first?",
      "options": [
        "A. Modify the permissions for Microsoft 365 Defender.",
        "B. Create a device group.",
        "C. From Advanced features in the Endpoints settings of the Microsoft 365 Defender portal, enable automated investigation.",
        "D. Configure role-based access control (RBAC)."
      ],
      "answer": [
        "C"
      ],
      "explanation": "To initiate remote shell connections (also known as Live Response) to onboarded devices from the Microsoft 365 Defender portal, you must first enable the **'Live Response'** capability. This is done from the **Advanced Features** section in the Endpoints settings.\n\n→ Option C is the correct step to enable this feature initially.\n→ Option A (modifying permissions) is necessary for long-term access control but not the first step.\n→ Option B (device group) is useful for scoping automation but not required to enable Live Response.\n→ Option D (RBAC) is important for permissions but assumes the capability is already enabled.\n\nReference:\nhttps://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/live-response?view=o365-worldwide"
    },
    {
      "type": "multiple_choice",
      "question": "You need to configure Microsoft Defender for Cloud Apps to generate alerts and trigger remediation actions in response to external sharing of confidential files.\n\nWhich two actions should you perform in the Microsoft 365 Defender portal? Each correct answer presents part of the solution.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "A. From Settings, select Cloud App, select Microsoft Information Protection, and then select Only scan files for Microsoft Information Protection sensitivity labels and content inspection warnings from this tenant.",
        "B. From Cloud apps, select Files, and then filter File Type to Document.",
        "C. From Settings, select Cloud App, select Microsoft Information Protection, select Files, and then enable file monitoring.",
        "D. From Cloud apps, select Files, and then filter App to Office 365.",
        "E. From Cloud apps, select Files, and then select New policy from search.",
        "F. From Settings, select Cloud App, select Microsoft Information Protection, and then select Automatically scan new files for Microsoft Information Protection sensitivity labels and content inspection warnings."
      ],
      "answer": [
        "C",
        "F"
      ],
      "explanation": "To detect and respond to external sharing of confidential files in Microsoft Defender for Cloud Apps (MCAS), the following steps are required:\n\n→ **C. Enable file monitoring**: This ensures MCAS is actively tracking activities like sharing, downloading, or modifying files, which is critical to triggering alerts.\n\n→ **F. Automatically scan new files for Microsoft Information Protection sensitivity labels**: This ensures that MCAS can inspect files for sensitivity and compliance issues when they are added or shared.\n\nThese two settings together allow for real-time scanning and actionable alerts.\n\nReference:\nhttps://learn.microsoft.com/en-us/defender-cloud-apps/file-policies"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 subscription that uses Microsoft Purview.\n\nYour company has a project named Project1.\n\nYou need to identify all the email messages that have the word Project1 in the subject line. The solution must search only the mailboxes of users that worked on Project1.\n\nWhat should you do?",
      "options": [
        "A. Perform a user data search.",
        "B. Create a records management disposition.",
        "C. Perform an audit search.",
        "D. Perform a content search."
      ],
      "answer": [
        "D"
      ],
      "explanation": "D: Perform a content search.\n\nMicrosoft Purview’s Content Search feature allows you to search for keywords (like 'Project1') within specific locations, such as user mailboxes.\nYou can scope the search to just the mailboxes of users who worked on the project, making it both accurate and efficient.\n\n→ A is incorrect because 'user data search' isn't a Microsoft Purview tool.\n→ B applies to retention and records—not discovery.\n→ C is for auditing access and activity, not keyword content.\n\nReference: https://learn.microsoft.com/en-us/microsoft-365/compliance/content-search?view=o365-worldwide"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 subscription that uses Microsoft Defender XDR.\n\nYou discover that when Microsoft Defender for Endpoint generates alerts for a commonly used executable file, it causes alert fatigue.\n\nYou need to tune the alerts.\n\nWhich two actions can an alert tuning rule perform for the alerts? Each correct answer presents a complete solution.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "A. delete",
        "B. hide",
        "C. resolve",
        "D. merge",
        "E. assign"
      ],
      "answer": [
        "B",
        "C"
      ],
      "explanation": "Alert tuning rules in Microsoft Defender XDR allow analysts to reduce noise by automatically hiding alerts or marking them as resolved.\n\n→ Hide: Suppresses the alert from appearing in the queue.\n→ Resolve: Automatically closes the alert to prevent further action.\n\nReference: https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/tune-alerts"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 subscription.\n\nYou have 1,000 Windows devices that have a third-party antivirus product installed and Microsoft Defender Antivirus in passive mode.\n\nYou need to ensure that the devices are protected from malicious artifacts that were undetected by the third-party antivirus product.\n\nSolution: You configure endpoint detection and response (EDR) in block mode.\n\nDoes this meet the goal?",
      "options": [
        "A. Yes",
        "B. No"
      ],
      "answer": [
        "A"
      ],
      "explanation": "EDR in block mode blocks behaviors that are malicious even when Defender Antivirus is in passive mode, allowing Microsoft Defender for Endpoint to still act against threats missed by the third-party AV.\n\nReference: https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/edr-in-block-mode"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 subscription.\n\nYou have 1,000 Windows devices that have a third-party antivirus product installed and Microsoft Defender Antivirus in passive mode.\n\nYou need to ensure that the devices are protected from malicious artifacts that were undetected by the third-party antivirus product.\n\nSolution: You configure Controlled folder access.\n\nDoes this meet the goal?",
      "options": [
        "A. Yes",
        "B. No"
      ],
      "answer": [
        "B"
      ],
      "explanation": "Controlled Folder Access protects folders from unauthorized changes by untrusted apps, but it does not actively scan or remediate malware missed by third-party antivirus tools.\n\nReference: https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/controlled-folders"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 subscription.\n\nYou have 1,000 Windows devices that have a third-party antivirus product installed and Microsoft Defender Antivirus in passive mode.\n\nYou need to ensure that the devices are protected from malicious artifacts that were undetected by the third-party antivirus product.\n\nSolution: You enable automated investigation and response (AIR).\n\nDoes this meet the goal?",
      "options": [
        "A. Yes",
        "B. No"
      ],
      "answer": [
        "B"
      ],
      "explanation": "AIR helps with analysis and remediation but doesn't directly block threats on passive-mode Defender Antivirus. Blocking is handled by EDR in block mode.\n\nReference: https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/automated-investigations"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 subscription that uses Microsoft Defender XDR.\n\nYou need to implement deception rules. The solution must ensure that you can limit the scope of the rules.\n\nWhat should you create first?",
      "options": [
        "A. device groups",
        "B. device tags",
        "C. honeytoken entity tags",
        "D. sensitive entity tags"
      ],
      "answer": [
        "B"
      ],
      "explanation": "Device tags allow fine-grained targeting of rules and configurations in Microsoft Defender for Endpoint, including deception settings.\n\nReference: https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/machine-tags"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 subscription.\n\nYou have 1,000 Windows devices that have a third-party antivirus product installed and Microsoft Defender Antivirus in passive mode.\nAll Windows devices are onboarded to Microsoft Defender for Endpoint.\n\nYou need to ensure that the devices are protected from malicious artifacts that were undetected by the third-party antivirus product.\n\nSolution: You enable Live Response.\n\nDoes this meet the goal?",
      "options": [
        "A. Yes",
        "B. No"
      ],
      "answer": [
        "B"
      ],
      "explanation": "Live Response provides manual access to investigate and respond to incidents on devices, but does not proactively block threats missed by third-party antivirus.\n\nReference: https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/live-response"
    },
    {
      "type": "multiple_choice",
      "question": "You plan to create a custom Azure Sentinel query that will provide a visual representation of the security alerts generated by Azure Security Center.\nYou need to create a query that will be used to display a bar graph.\nWhat should you include in the query?",
      "options": [
        "A. extend",
        "B. bin",
        "C. count",
        "D. workspace"
      ],
      "answer": [
        "C"
      ],
      "explanation": "The `count` operator is used in Kusto Query Language (KQL) to aggregate results, such as counting the number of events or alerts that match a query. This is essential for creating visual summaries like bar graphs, which represent quantities or frequencies.\n\nReference: https://learn.microsoft.com/en-us/kusto/query/visualization-barchart?view=microsoft-fabric"
    },
    {
      "type": "multiple_choice",
      "question": "You use Azure Sentinel.\nYou need to receive an alert in near real-time whenever Azure Storage account keys are enumerated.\nWhich two actions should you perform? Each correct answer presents part of the solution.\nNOTE: Each correct selection is worth one point.",
      "options": [
        "A. Create a livestream",
        "B. Add a data connector",
        "C. Create an analytics rule",
        "D. Create a hunting query.",
        "E. Create a bookmark."
      ],
      "answer": [
        "B",
        "C"
      ],
      "explanation": "To detect and alert on suspicious activity such as storage account key enumeration, you need to first ingest relevant telemetry data using a data connector (e.g., Azure Activity logs). Then, use an analytics rule to define detection logic that will trigger alerts.\n\nLivestream is used for ad hoc investigations, hunting queries are for manual threat discovery, and bookmarks help mark important events but don't trigger alerts.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/connect-data-sources\nhttps://learn.microsoft.com/en-us/azure/sentinel/tutorial-detect-threats-custom"
    },
    {
      "type": "multiple_choice",
      "question": "You are investigating an incident in Azure Sentinel that contains more than 127 alerts.\nYou discover eight alerts in the incident that require further investigation.\nYou need to escalate the alerts to another Azure Sentinel administrator.\nWhat should you do to provide the alerts to the administrator?",
      "options": [
        "A. Create a Microsoft incident creation rule",
        "B. Share the incident URL",
        "C. Create a scheduled query rule",
        "D. Assign the incident"
      ],
      "answer": [
        "D"
      ],
      "explanation": "The correct way to escalate alerts to another Azure Sentinel administrator is by assigning the incident. This allows for effective collaboration and handoff between team members who are handling security investigations. Azure Sentinel provides role-based access and incident assignment as part of its incident management system.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/tutorial-investigate-cases"
    },
    {
      "type": "multiple_choice",
      "question": "You are configuring Azure Sentinel.\nYou need to send a Microsoft Teams message to a channel whenever an incident representing a sign-in risk event is activated in Azure Sentinel.\nWhich two actions should you perform in Azure Sentinel? Each correct answer presents part of the solution.\nNOTE: Each correct selection is worth one point.",
      "options": [
        "A. Enable Entity behavior analytics.",
        "B. Associate a playbook to the analytics rule that triggered the incident.",
        "C. Enable the Fusion rule.",
        "D. Add a playbook.",
        "E. Create a workbook."
      ],
      "answer": [
        "B",
        "D"
      ],
      "explanation": "To send a Microsoft Teams message when a specific incident is triggered in Azure Sentinel, you must:\n- Create and **add a playbook** (D) that defines the automation logic, such as sending a Teams message.\n- **Associate the playbook** (B) with the analytics rule that triggers the incident so the action executes automatically.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/tutorial-respond-threats-playbook"
    },
    {
      "type": "multiple_choice",
      "question": "Azure Sentinel -\n\n✑ A Microsoft 365 subscription\n✑ Microsoft Defender for Identity\n✑ An Azure Active Directory (Azure AD) tenant\nYou configure Azure Sentinel to collect security logs from all the Active Directory member servers and domain controllers.\nYou deploy Microsoft Defender for Identity by using standalone sensors.\nYou need to ensure that you can detect when sensitive groups are modified in Active Directory.\nWhich two actions should you perform? Each correct answer presents part of the solution.\nNOTE: Each correct selection is worth one point.",
      "options": [
        "A. Configure the Advanced Audit Policy Configuration settings for the domain controllers.",
        "B. Modify the permissions of the Domain Controllers organizational unit (OU).",
        "C. Configure auditing in the Microsoft 365 compliance center.",
        "D. Configure Windows Event Forwarding on the domain controllers."
      ],
      "answer": [
        "A",
        "D"
      ],
      "explanation": "To detect when sensitive groups are modified in Active Directory using Microsoft Defender for Identity and Azure Sentinel, you must ensure that the relevant audit events are being captured:\n\n- **Advanced Audit Policy Configuration**: This must be enabled on domain controllers to capture changes to security groups and privileged accounts.\n- **Windows Event Forwarding (WEF)**: This is required to forward relevant security events (e.g., group membership changes) from domain controllers to a central system like Azure Sentinel.\n\nReference:\nhttps://learn.microsoft.com/en-us/defender-for-identity/configure-windows-event-collection\nhttps://learn.microsoft.com/en-us/windows/security/threat-protection/auditing/advanced-security-audit-policy-settings"
    },
    {
      "type": "multiple_choice",
      "question": "You use Azure Sentinel.\nYou need to use a built-in role to provide a security analyst with the ability to edit the queries of custom Azure Sentinel workbooks. The solution must use the principle of least privilege.\nWhich role should you assign to the analyst?",
      "options": [
        "A. Azure Sentinel Contributor",
        "B. Security Administrator",
        "C. Azure Sentinel Responder",
        "D. Logic App Contributor"
      ],
      "answer": [
        "A"
      ],
      "explanation": "The **Azure Sentinel Contributor** role allows a user to create and edit workbooks, analytics rules, and other configurations in Azure Sentinel. It is the most appropriate role that aligns with the principle of least privilege for a security analyst needing to edit custom workbook queries.\n\nReference:\nhttps://learn.microsoft.com/en-us/azure/sentinel/roles"
    },
    {
      "type": "multiple_choice",
      "question": "You create a hunting query in Azure Sentinel.\nYou need to receive a notification in the Azure portal as soon as the hunting query detects a match on the query. The solution must minimize effort.\nWhat should you use?",
      "options": [
        "A. a playbook",
        "B. a notebook",
        "C. a livestream",
        "D. a bookmark"
      ],
      "answer": [
        "C"
      ],
      "explanation": "Livestream in Azure Sentinel allows you to monitor data in near real-time using a hunting query. When the query condition is met, it triggers an alert in the Azure portal, which is ideal for detecting and responding to threats with minimal configuration.\n\nReference:\nhttps://learn.microsoft.com/en-us/azure/sentinel/hunting#livestream"
    },
    {
      "type": "multiple_choice",
      "question": "You have an Azure subscription named Sub1 and a Microsoft 365 subscription. Sub1 is linked to an Azure Active Directory (Azure AD) tenant named contoso.com.\nYou create an Azure Sentinel workspace named workspace1. In workspace1, you activate an Azure AD connector for contoso.com and an Office 365 connector for the Microsoft 365 subscription.\nYou need to use the Fusion rule to detect multi-staged attacks that include suspicious sign-ins to contoso.com followed by anomalous Microsoft Office 365 activity.\nWhich two actions should you perform? Each correct answer presents part of the solution.\nNOTE: Each correct selection is worth one point.",
      "options": [
        "A. Create custom rule based on the Office 365 connector templates.",
        "B. Create a Microsoft incident creation rule based on Azure Security Center.",
        "C. Create a Microsoft Cloud App Security connector.",
        "D. Create an Azure AD Identity Protection connector."
      ],
      "answer": [
        "C",
        "D"
      ],
      "explanation": "The Azure Sentinel Fusion rule uses machine learning to correlate alerts and anomalous activities across different sources.\nTo enable detection of complex multi-stage attacks such as suspicious sign-ins followed by Office 365 anomalies, connectors like Microsoft Cloud App Security (Defender for Cloud Apps) and Azure AD Identity Protection are essential.\nThese connectors enrich Sentinel with identity and cloud application signals used by Fusion.\n\nReference:\nhttps://learn.microsoft.com/en-us/azure/sentinel/fusion\nhttps://learn.microsoft.com/en-us/azure/sentinel/connect-data-sources?tabs=defender-portal\n"
    },
    {
      "type": "multiple_choice",
      "question": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.\nAfter you answer a question in this section, you will NOT be able to return to it. As a result, these questions will not appear in the review screen.\n\nYou are configuring Azure Sentinel.\nYou need to create an incident in Azure Sentinel when a sign-in to an Azure virtual machine from a malicious IP address is detected.\nSolution: You create a livestream from a query.\nDoes this meet the goal?",
      "options": [
        "A. Yes",
        "B. No"
      ],
      "answer": [
        "B"
      ],
      "explanation": "Creating a livestream from a query allows for near real-time monitoring of data but does not automatically create incidents. To generate incidents based on threat detections, you need to use scheduled analytics rules or Microsoft incident creation rules.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/detect-threats-built-in\nhttps://learn.microsoft.com/en-us/azure/sentinel/connect-defender-for-cloud\n"
    },
    {
      "type": "multiple_choice",
      "question": "You have an Azure subscription that uses Microsoft Sentinel.\nYou need to minimize the administrative effort required to respond to the incidents and remediate the security threats detected by Microsoft Sentinel.\nWhich two features should you use? Each correct answer presents part of the solution.\nNOTE: Each correct selection is worth one point.",
      "options": [
        "A. Microsoft Sentinel bookmarks",
        "B. Azure Automation runbooks",
        "C. Microsoft Sentinel automation rules",
        "D. Microsoft Sentinel playbooks",
        "E. Azure Functions apps"
      ],
      "answer": [
        "C",
        "D"
      ],
      "explanation": "To minimize administrative effort in Microsoft Sentinel:\n\n- **Automation Rules (C)**: Help manage incident handling by automating triage, assignment, and tagging. They streamline responses by automatically applying logic when incidents are created.\n\n- **Playbooks (D)**: Are built using Logic Apps and help automate responses such as sending alerts, blocking users, or updating tickets, minimizing manual remediation effort.\n\nOther options like bookmarks (A) are for marking artifacts for threat hunting, not automation. Azure Automation and Functions (B, E) are powerful but require more setup compared to Sentinel-native tools.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/automation/automate-responses-with-playbooks\n"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft Sentinel workspace named workspace1 that contains custom Kusto queries.\nYou need to create a Python-based Jupyter notebook that will create visuals. The visuals will display the results of the queries and be pinned to a dashboard. The solution must minimize development effort.\nWhat should you use to create the visuals?",
      "options": [
        "A. plotly",
        "B. TensorFlow",
        "C. msticpy",
        "D. matplotlib"
      ],
      "answer": [
        "C"
      ],
      "explanation": "**msticpy** is a Python package developed by Microsoft that provides tools for security investigations and threat hunting in Microsoft Sentinel. It includes built-in functions for querying Sentinel using Kusto Query Language (KQL), creating visualizations, and analyzing results efficiently in Jupyter Notebooks.\n\nWhile libraries like matplotlib and plotly are excellent for generic plotting, msticpy is tailored for Sentinel and includes many pre-built functions and visual tools that minimize development effort.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/notebook-get-started"
    },
    {
      "type": "multiple_choice",
      "question": "You have two Azure subscriptions that use Microsoft Defender for Cloud.\nYou need to ensure that specific Defender for Cloud security alerts are suppressed at the root management group level. The solution must minimize administrative effort.\nWhat should you do in the Azure portal?",
      "options": [
        "A. Create an Azure Policy assignment.",
        "B. Modify the Workload protections settings in Defender for Cloud.",
        "C. Create an alert rule in Azure Monitor.",
        "D. Modify the alert settings in Defender for Cloud."
      ],
      "answer": [
        "A"
      ],
      "explanation": "To suppress specific security alerts across multiple subscriptions with minimal administrative effort, you should use **Azure Policy** assigned at the **root management group level**. This ensures consistent enforcement and suppression across all descendant subscriptions and resources.\n\nReference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/alerts-suppression-rules"
    },
    {
      "type": "multiple_choice",
      "question": "You have an Azure subscription that has the enhanced security features in Microsoft Defender for Cloud enabled and contains a user named User1.\nYou need to ensure that User1 can export alert data from Defender for Cloud. The solution must use the principle of least privilege.\nWhich role should you assign to User1?",
      "options": [
        "A. User Access Administrator",
        "B. Owner",
        "C. Contributor",
        "D. Reader"
      ],
      "answer": [
        "D"
      ],
      "explanation": "The Reader role in Microsoft Defender for Cloud allows users to view recommendations, alerts, security policies, and security states, but not make any changes. This is the **least privileged role** that enables User1 to **export alert data**.\n\nThe other options are more privileged than required:\n- **Option A**: User Access Administrator allows managing access but not exporting alert data.\n- **Option B**: Owner includes full access including altering settings, which is unnecessary here.\n- **Option C**: Contributor allows applying recommendations and dismissing alerts, which exceeds the needs for export-only access.\n\nReference: https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#reader"
    },
    {
      "type": "multiple_choice",
      "question": "You have an Azure subscription that contains an Azure logic app named app1 and a Microsoft Sentinel workspace that has an Azure Active Directory (Azure AD) connector.\nYou need to ensure that app1 launches when Microsoft Sentinel detects an Azure AD-generated alert.\nWhat should you create first?",
      "options": [
        "A. a repository connection",
        "B. a watchlist",
        "C. an analytics rule",
        "D. an automation rule"
      ],
      "answer": [
        "D"
      ],
      "explanation": "To trigger a Logic App like app1 in response to an alert in Microsoft Sentinel, you must first create an **automation rule**. Automation rules define how incidents and alerts should be handled automatically, including triggering Logic Apps.\n\n- **Option A**: A repository connection is used for version control and is not relevant here.\n- **Option B**: A watchlist is used to enrich queries and detections with external data.\n- **Option C**: Analytics rules detect threats and generate alerts, but on their own, they don’t launch Logic Apps.\n\n**Correct answer**: An automation rule is what links Sentinel alerts to logic apps.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/create-manage-use-automation-rules?tabs=defender-portal%2Conboarded"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft Sentinel workspace.\nYou need to identify which rules are used to detect advanced multistage attacks that comprise two or more alerts or activities. The solution must minimize administrative effort.\nWhich rule type should you query?",
      "options": [
        "A. Fusion",
        "B. Microsoft Security",
        "C. ML Behavior Analytics",
        "D. Scheduled"
      ],
      "answer": [
        "A"
      ],
      "explanation": "Fusion rules in Microsoft Sentinel are designed to detect advanced multistage attacks by correlating alerts and signals across different data sources using machine learning. These rules automatically identify threats that may not be apparent when looking at individual alerts in isolation.\n\n- **Option A (Correct)**: Fusion rules use AI and ML to detect complex, multistage attacks.\n- **Option B**: Microsoft Security rules are prebuilt alert types from Microsoft services.\n- **Option C**: ML Behavior Analytics focuses on anomalies but not necessarily multistage correlations.\n- **Option D**: Scheduled rules detect threats based on custom KQL queries, not fused multi-alert logic.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/fusion"
    },
    {
      "type": "multiple_choice",
      "question": "You have an Azure subscription that uses Microsoft Sentinel and contains 100 Linux virtual machines.\nYou need to monitor the virtual machines by using Microsoft Sentinel. The solution must meet the following requirements:\n✑ Minimize administrative effort.\n✑ Minimize the parsing required to read log data.\nWhat should you configure?",
      "options": [
        "A. a Log Analytics Data Collector API",
        "B. REST API integration",
        "C. a Common Event Format (CEF) connector",
        "D. a Syslog connector"
      ],
      "answer": [
        "C"
      ],
      "explanation": "The **Common Event Format (CEF) connector** is the recommended solution for integrating logs from Linux systems with Microsoft Sentinel. It provides structured log data that requires minimal custom parsing and simplifies setup.\n\n- **Option A** requires custom scripting and manual parsing effort.\n- **Option B** (REST API) requires significant development and maintenance.\n- **Option C (Correct)**: The CEF connector simplifies integration using a standard format.\n- **Option D** (Syslog) is less structured and typically requires more parsing.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/connect-cef-syslog-ama?tabs=portal"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft Sentinel workspace.\n\nYou have a query named Query1 as shown in the following exhibit.\n\nYou plan to create a custom parser named Parser1.\n\nYou need to use Query1 in Parser1.\n\nWhat should you do first?",
      "options": [
        "A. Remove line 5.",
        "B. Remove line 2.",
        "C. In line 3, replace the !contains operator with the !has operator.",
        "D. In line 4, remove the TimeGenerated predicate."
      ],
      "answer": [
        "B"
      ],
      "image": "Images/hotspot50.png",
      "explanation": "When defining a custom parser in Microsoft Sentinel using Kusto Query Language (KQL), you should avoid using `datatable` or inline data constructs as part of the query body. Line 2 in the query likely defines a `datatable`, which is not allowed in parser definitions. Removing line 2 ensures the query adheres to parser syntax requirements.\n\nhttps://learn.microsoft.com/en-us/azure/sentinel/normalization-develop-parsers"
    },
    {
      "type": "multiple_choice",
      "question": "You have an Azure subscription that uses Microsoft Sentinel.\n\nYou need to create a custom report that will visualize sign-in information over time.\n\nWhat should you create first?",
      "options": [
        "A. a hunting query",
        "B. a workbook",
        "C. a notebook",
        "D. a playbook"
      ],
      "answer": [
        "B"
      ],
      "explanation": "In Microsoft Sentinel, **workbooks** are the appropriate tool for creating custom reports and dashboards. They allow you to visualize data over time using charts, tables, and graphs, and can query underlying data from connected sources such as sign-in logs.\n\nWhile hunting queries (A) are used to investigate threats, notebooks (C) support advanced analysis using Jupyter, and playbooks (D) are used for automated response—none are optimized for reporting and visualization.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/monitor-your-data?tabs=defender-portal"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft Sentinel workspace.\n\nYou receive multiple alerts for failed sign-in attempts to an account.\nYou identify that the alerts are false positives.\n\nYou need to prevent additional failed sign-in alerts from being generated for the account. The solution must meet the following requirements:\n\n• Ensure that failed sign-in alerts are generated for other accounts.\n• Minimize administrative effort.\n\nWhat should you do?",
      "options": [
        "A. Modify the analytics rule.",
        "B. Create a watchlist.",
        "C. Add an activity template to the entity behavior.",
        "D. Create an automation rule."
      ],
      "answer": [
        "A"
      ],
      "explanation": "Modifying the analytics rule allows you to refine the logic that triggers alerts—such as adding exceptions or exclusions for specific accounts. This satisfies the need to stop alerts for one account while still monitoring others and ensures a low administrative overhead.\n\nOption B, creating a watchlist, is primarily used for including or excluding entities in queries, but would require integrating into query logic and may not minimize effort.\nOption C, activity templates in entity behavior, are used for modeling behavior and aren't ideal for alert suppression.\nOption D, automation rules can suppress alerts but are broader and may not provide the specific control needed.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/tutorial-detect-threats-custom"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft Sentinel workspace.\n\nYou need to prevent a built-in Advanced Security Information Model (ASIM) parser from being updated automatically.\n\nWhat are two ways to achieve this goal? Each correct answer presents a complete solution.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "A. Create a hunting query that references the built-in parser.",
        "B. Build a custom unifying parser and include the built-in parser version.",
        "C. Redeploy the built-in parser and specify a CallerContext parameter of Any and a SourceSpecificParser parameter of Any.",
        "D. Redeploy the built-in parser and specify a CallerContext parameter of Built-in.",
        "E. Create an analytics rule that includes the built-in parser."
      ],
      "answer": [
        "B",
        "C"
      ],
      "explanation": "To prevent automatic updates of a built-in ASIM parser in Microsoft Sentinel, you can:\n\n1. **Build a custom unifying parser** that references the built-in parser by version. This removes it from the automatic update pipeline.\n2. **Redeploy the parser** with `CallerContext=Any` and `SourceSpecificParser=Any`, which effectively disables the update path for the original parser.\n\nOther options like referencing the parser in a hunting query or analytics rule do not prevent updates.\n\nReferences:\n- https://learn.microsoft.com/en-us/azure/sentinel/normalization-manage-parsers\n- https://learn.microsoft.com/en-us/azure/sentinel/normalization-manage-parsers#prevent-an-automated-update-of-a-built-in-parser"
    },
    {
      "type": "multiple_choice",
      "question": "You have a custom Microsoft Sentinel workbook named Workbook1.\n\nYou need to add a grid to Workbook1. The solution must ensure that the grid contains a maximum of 100 rows.\n\nWhat should you do?",
      "options": [
        "A. In the grid query, include the take operator.",
        "B. In the grid query, include the project operator.",
        "C. In the query editor interface, configure Settings.",
        "D. In the query editor interface, select Advanced Editor."
      ],
      "answer": [
        "A"
      ],
      "explanation": "To limit the number of rows returned in a Microsoft Sentinel workbook grid, use the `take` operator in your Kusto query. This operator restricts the result set to the specified number of rows, such as `take 100`.\n\nReference: https://learn.microsoft.com/en-us/azure/data-explorer/kusto/query/takeoperator"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft Sentinel workspace named Workspace1.\n\nYou need to exclude a built-in, source-specific Advanced Security Information Model (ASIM) parser from a built-in unified ASIM parser.\n\nWhat should you create in Workspace1?",
      "options": [
        "A. an analytic rule",
        "B. a watchlist",
        "C. a workbook",
        "D. a hunting query"
      ],
      "answer": [
        "B"
      ],
      "explanation": "To exclude a source-specific ASIM parser from being used in a unified ASIM parser, you can use a watchlist. Watchlists in Microsoft Sentinel allow you to define exclusions and control logic for parser behavior. This provides flexibility without modifying parser code.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/normalization-manage-parsers"
    },
    {
      "type": "multiple_choice",
      "question": "You have an Azure subscription that contains a Microsoft Sentinel workspace.\n\nYou need to create a playbook that will run automatically in response to a Microsoft Sentinel alert.\n\nWhat should you create first?",
      "options": [
        "A. a hunting query in Microsoft Sentinel",
        "B. an Azure logic app",
        "C. an automation rule in Microsoft Sentinel",
        "D. a trigger in Azure Functions"
      ],
      "answer": [
        "B"
      ],
      "explanation": "To create a playbook that runs automatically in response to a Microsoft Sentinel alert, you must first create an Azure Logic App. This serves as the foundation of the playbook, which you can then integrate with Sentinel through an automation rule.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/tutorial-respond-threats-playbook?tabs=LAC%2Cincidents"
    },
    {
      "type": "multiple_choice",
      "question": "You have an Azure subscription that contains a Microsoft Sentinel workspace. The workspace contains a Microsoft Defender for Cloud data connector.\n\nYou need to customize which details will be included when an alert is created for a specific event.\n\nWhat should you do?",
      "options": [
        "A. Enable User and Entity Behavior Analytics (UEBA).",
        "B. Create a Data Collection Rule (DCR).",
        "C. Modify the properties of the connector.",
        "D. Create a scheduled query rule."
      ],
      "answer": [
        "D"
      ],
      "explanation": "To customize the alert details in Microsoft Sentinel, you need to create or modify a **scheduled query rule**. This allows you to define what data is included in the alert, including setting the entity mappings and other custom fields.\n\nOption D is correct because scheduled query rules support customization of alert details.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/customize-alert-details"
    },
    {
      "type": "multiple_choice",
      "question": "Case study -\n\nThis is a case study. Case studies are not timed separately. You can use as much exam time as you would like to complete each case. However, there may be additional case studies and sections on this exam. You must manage your time to ensure that you are able to complete all questions included in the time provided.\n\nTo answer the questions included in a case study, you will need to reference information that is provided in the case study. Case studies might contain exhibits and other resources that provide more information about the scenario that is described in the case study. Each question is independent of the other questions in this case study.\n\nAt the end of this case study, a review screen will appear. This screen allows you to review your answers and to make changes before you move to the next section of the exam. After you begin a new section, you cannot return to this section.\n\nTo start the case study -\nTo display the first question in this case study, click the Next button. Use the buttons in the left pane to explore the content of the case study before you answer the questions. Clicking these buttons displays information such as business requirements, existing environment, and problem statements. If the case study has an All Information tab, note that the information displayed is identical to the information displayed on the subsequent tabs. When you are ready to answer a question, click the Question button to return to the question.\n\nOverview -\n\nFabrikam, Inc. is a financial services company.\n\nThe company has branch offices in New York, London, and Singapore. Fabrikam has remote users located across the globe. The remote users access company resources, including cloud resources, by using a VPN connection to a branch office.\n\nExisting Environment -\n\nIdentity Environment -\n\nThe network contains an Active Directory Domain Services (AD DS) forest named fabrikam.com that syncs with an Azure AD tenant named fabrikam.com. To sync the forest, Fabrikam uses Azure AD Connect with pass-through authentication enabled and password hash synchronization disabled.\n\nThe fabrikam.com forest contains two global groups named Group1 and Group2.\n\nMicrosoft 365 Environment -\n\nAll the users at Fabrikam are assigned a Microsoft 365 E5 license and an Azure Active Directory Premium Plan 2 license.\n\nFabrikam implements Microsoft Defender for Identity and Microsoft Defender for Cloud Apps and enables log collectors.\n\nAzure Environment -\n\nFabrikam has an Azure subscription that contains the resources shown in the following table:\n\n| Name      | Type                              | Description                                                                                           |\n|-----------|-----------------------------------|-------------------------------------------------------------------------------------------------------|\n| App1      | Azure logic app                   | To automate incident generation in an internal ticketing system, the security operations (SecOps) team invokes App1 by using an HTTP endpoint. |\n| SAWkspc1  | Azure Synapse Analytics workspace | SAWkspc1 hosts an Apache Spark pool named Pool1.                                                      |\n| LAWkspc1  | Log Analytics workspace           | LAWkspc1 will be used in a planned Microsoft Sentinel implementation.                                 |\n\nAmazon Web Services (AWS) Environment\n\nFabrikam has an Amazon Web Services (AWS) account named Account1. Account1 contains 100 Amazon Elastic Compute Cloud (EC2) instances that run a custom Windows Server 2022. The image includes Microsoft SQL Server 2019 and does NOT have any agents installed.\n\nCurrent Issues -\n\nWhen the users use the VPN connections, Microsoft 365 Defender raises a high volume of impossible travel alerts that are false positives.\nDefender for Identity raises a high volume of Suspected DCSync attack alerts that are false positives.\n\nRequirements -\n\nPlanned changes -\n\nFabrikam plans to implement the following services:\n• Microsoft Defender for Cloud\n• Microsoft Sentinel\n\nBusiness Requirements -\n\nFabrikam identifies the following business requirements:\n• Use the principle of least privilege, whenever possible.\n• Minimize administrative effort.\n\nMicrosoft Defender for Cloud Apps Requirements\n\nFabrikam identifies the following Microsoft Defender for Cloud Apps requirements:\n• Ensure that impossible travel alert policies are based on the previous activities of each user.\n• Reduce the amount of impossible travel alerts that are false positives.\n\nMicrosoft Defender for Identity Requirements\n\nMinimize the administrative effort required to investigate the false positive alerts.\n\nMicrosoft Defender for Cloud Requirements\n\nFabrikam identifies the following Microsoft Defender for Cloud requirements:\n• Ensure that the members of Group2 can modify security policies.\n• Ensure that the members of Group1 can assign regulatory compliance policy initiatives at the Azure subscription level.\n• Automate the deployment of the Azure Connected Machine agent for Azure Arc-enabled servers to the existing and future resources of Account1.\n• Minimize the administrative effort required to investigate the false positive alerts.\n\nMicrosoft Sentinel Requirements\n\nFabrikam identifies the following Microsoft Sentinel requirements:\n• Query for NXDOMAIN DNS requests from the last seven days by using built-in Advanced Security Information Model (ASIM) unifying parsers.\n• From AWS EC2 instances, collect Windows Security event log entries that include local group membership changes.\n• Identify anomalous activities of Azure AD users by using User and Entity Behavior Analytics (UEBA).\n• Evaluate the potential impact of compromised Azure AD user credentials by using UEBA.\n• Ensure that App1 is available for use in Microsoft Sentinel automation rules.\n• Identify the mean time to triage for incidents generated during the last 30 days.\n• Identify the mean time to close incidents generated during the last 30 days.\n• Ensure that the members of Group1 can create and run playbooks.\n• Ensure that the members of Group1 can manage analytics rules.\n• Run hunting queries on Pool1 by using Jupyter notebooks.\n• Ensure that the members of Group2 can manage incidents.\n• Maximize the performance of data queries.\n• Minimize the amount of collected data.\nYou need to correlate data from the SecurityEvent Log Analytics table to meet the Microsoft Sentinel requirements for using UEBA.\n\nWhich Log Analytics table should you use?",
      "options": [
        "A. IdentityInfo",
        "B. AADRiskyUsers",
        "C. SentinelAudit",
        "D. IdentityDirectoryEvents"
      ],
      "answer": [
        "A"
      ],
      "explanation": "The IdentityInfo table contains enriched identity data such as user account details that are necessary for correlating with SecurityEvent logs in UEBA scenarios. It plays a critical role in normalizing user information to provide insights into user behavior across various data sources.\n\nReference: https://learn.microsoft.com/en-us/defender-xdr/advanced-hunting-identitydirectoryevents-table?WT.mc_id=M365-MVP-5003945"
    },
    {
      "type": "multiple_choice",
      "question": "Case study -\n\nThis is a case study. Case studies are not timed separately. You can use as much exam time as you would like to complete each case. However, there may be additional case studies and sections on this exam. You must manage your time to ensure that you are able to complete all questions included in the time provided.\n\nTo answer the questions included in a case study, you will need to reference information that is provided in the case study. Case studies might contain exhibits and other resources that provide more information about the scenario that is described in the case study. Each question is independent of the other questions in this case study.\n\nAt the end of this case study, a review screen will appear. This screen allows you to review your answers and to make changes before you move to the next section of the exam. After you begin a new section, you cannot return to this section.\n\nTo start the case study -\nTo display the first question in this case study, click the Next button. Use the buttons in the left pane to explore the content of the case study before you answer the questions. Clicking these buttons displays information such as business requirements, existing environment, and problem statements. If the case study has an All Information tab, note that the information displayed is identical to the information displayed on the subsequent tabs. When you are ready to answer a question, click the Question button to return to the question.\n\nOverview -\n\nFabrikam, Inc. is a financial services company.\n\nThe company has branch offices in New York, London, and Singapore. Fabrikam has remote users located across the globe. The remote users access company resources, including cloud resources, by using a VPN connection to a branch office.\n\nExisting Environment -\n\nIdentity Environment -\n\nThe network contains an Active Directory Domain Services (AD DS) forest named fabrikam.com that syncs with an Azure AD tenant named fabrikam.com. To sync the forest, Fabrikam uses Azure AD Connect with pass-through authentication enabled and password hash synchronization disabled.\n\nThe fabrikam.com forest contains two global groups named Group1 and Group2.\n\nMicrosoft 365 Environment -\n\nAll the users at Fabrikam are assigned a Microsoft 365 E5 license and an Azure Active Directory Premium Plan 2 license.\n\nFabrikam implements Microsoft Defender for Identity and Microsoft Defender for Cloud Apps and enables log collectors.\n\nAzure Environment -\n\nFabrikam has an Azure subscription that contains the resources shown in the following table:\n\n| Name      | Type                              | Description                                                                                           |\n|-----------|-----------------------------------|-------------------------------------------------------------------------------------------------------|\n| App1      | Azure logic app                   | To automate incident generation in an internal ticketing system, the security operations (SecOps) team invokes App1 by using an HTTP endpoint. |\n| SAWkspc1  | Azure Synapse Analytics workspace | SAWkspc1 hosts an Apache Spark pool named Pool1.                                                      |\n| LAWkspc1  | Log Analytics workspace           | LAWkspc1 will be used in a planned Microsoft Sentinel implementation.                                 |\n\nAmazon Web Services (AWS) Environment\n\nFabrikam has an Amazon Web Services (AWS) account named Account1. Account1 contains 100 Amazon Elastic Compute Cloud (EC2) instances that run a custom Windows Server 2022. The image includes Microsoft SQL Server 2019 and does NOT have any agents installed.\n\nCurrent Issues -\n\nWhen the users use the VPN connections, Microsoft 365 Defender raises a high volume of impossible travel alerts that are false positives.\nDefender for Identity raises a high volume of Suspected DCSync attack alerts that are false positives.\n\nRequirements -\n\nPlanned changes -\n\nFabrikam plans to implement the following services:\n• Microsoft Defender for Cloud\n• Microsoft Sentinel\n\nBusiness Requirements -\n\nFabrikam identifies the following business requirements:\n• Use the principle of least privilege, whenever possible.\n• Minimize administrative effort.\n\nMicrosoft Defender for Cloud Apps Requirements\n\nFabrikam identifies the following Microsoft Defender for Cloud Apps requirements:\n• Ensure that impossible travel alert policies are based on the previous activities of each user.\n• Reduce the amount of impossible travel alerts that are false positives.\n\nMicrosoft Defender for Identity Requirements\n\nMinimize the administrative effort required to investigate the false positive alerts.\n\nMicrosoft Defender for Cloud Requirements\n\nFabrikam identifies the following Microsoft Defender for Cloud requirements:\n• Ensure that the members of Group2 can modify security policies.\n• Ensure that the members of Group1 can assign regulatory compliance policy initiatives at the Azure subscription level.\n• Automate the deployment of the Azure Connected Machine agent for Azure Arc-enabled servers to the existing and future resources of Account1.\n• Minimize the administrative effort required to investigate the false positive alerts.\n\nMicrosoft Sentinel Requirements\n\nFabrikam identifies the following Microsoft Sentinel requirements:\n• Query for NXDOMAIN DNS requests from the last seven days by using built-in Advanced Security Information Model (ASIM) unifying parsers.\n• From AWS EC2 instances, collect Windows Security event log entries that include local group membership changes.\n• Identify anomalous activities of Azure AD users by using User and Entity Behavior Analytics (UEBA).\n• Evaluate the potential impact of compromised Azure AD user credentials by using UEBA.\n• Ensure that App1 is available for use in Microsoft Sentinel automation rules.\n• Identify the mean time to triage for incidents generated during the last 30 days.\n• Identify the mean time to close incidents generated during the last 30 days.\n• Ensure that the members of Group1 can create and run playbooks.\n• Ensure that the members of Group1 can manage analytics rules.\n• Run hunting queries on Pool1 by using Jupyter notebooks.\n• Ensure that the members of Group2 can manage incidents.\n• Maximize the performance of data queries.\n• Minimize the amount of collected data.\n• Ensure that App1 is available for use in Microsoft Sentinel automation rules.\n\nYou need to meet the Microsoft Sentinel requirements for App1.\n\nWhat should you configure for App1?",
      "options": [
        "A. a trigger",
        "B. a connector",
        "C. authorization",
        "D. an API connection"
      ],
      "answer": [
        "C"
      ],
      "explanation": "To allow Microsoft Sentinel to call a logic app (like App1) from an automation rule, proper authorization must be configured so Sentinel can authenticate and invoke the playbook. This ensures secure and seamless automation of responses to incidents.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/automate-responses-with-playbooks#incident-creation-automated-response"
    },
    {
      "type": "multiple_choice",
      "question": "Case study -\n\nThis is a case study. Case studies are not timed separately. You can use as much exam time as you would like to complete each case. However, there may be additional case studies and sections on this exam. You must manage your time to ensure that you are able to complete all questions included in the time provided.\n\nTo answer the questions included in a case study, you will need to reference information that is provided in the case study. Case studies might contain exhibits and other resources that provide more information about the scenario that is described in the case study. Each question is independent of the other questions in this case study.\n\nAt the end of this case study, a review screen will appear. This screen allows you to review your answers and to make changes before you move to the next section of the exam. After you begin a new section, you cannot return to this section.\n\nTo start the case study -\nTo display the first question in this case study, click the Next button. Use the buttons in the left pane to explore the content of the case study before you answer the questions. Clicking these buttons displays information such as business requirements, existing environment, and problem statements. If the case study has an All Information tab, note that the information displayed is identical to the information displayed on the subsequent tabs. When you are ready to answer a question, click the Question button to return to the question.\n\nOverview -\n\nFabrikam, Inc. is a financial services company.\n\nThe company has branch offices in New York, London, and Singapore. Fabrikam has remote users located across the globe. The remote users access company resources, including cloud resources, by using a VPN connection to a branch office.\n\nExisting Environment -\n\nIdentity Environment -\n\nThe network contains an Active Directory Domain Services (AD DS) forest named fabrikam.com that syncs with an Azure AD tenant named fabrikam.com. To sync the forest, Fabrikam uses Azure AD Connect with pass-through authentication enabled and password hash synchronization disabled.\n\nThe fabrikam.com forest contains two global groups named Group1 and Group2.\n\nMicrosoft 365 Environment -\n\nAll the users at Fabrikam are assigned a Microsoft 365 E5 license and an Azure Active Directory Premium Plan 2 license.\n\nFabrikam implements Microsoft Defender for Identity and Microsoft Defender for Cloud Apps and enables log collectors.\n\nAzure Environment -\n\nFabrikam has an Azure subscription that contains the resources shown in the following table:\n\n| Name      | Type                              | Description                                                                                           |\n|-----------|-----------------------------------|-------------------------------------------------------------------------------------------------------|\n| App1      | Azure logic app                   | To automate incident generation in an internal ticketing system, the security operations (SecOps) team invokes App1 by using an HTTP endpoint. |\n| SAWkspc1  | Azure Synapse Analytics workspace | SAWkspc1 hosts an Apache Spark pool named Pool1.                                                      |\n| LAWkspc1  | Log Analytics workspace           | LAWkspc1 will be used in a planned Microsoft Sentinel implementation.                                 |\n\nAmazon Web Services (AWS) Environment\n\nFabrikam has an Amazon Web Services (AWS) account named Account1. Account1 contains 100 Amazon Elastic Compute Cloud (EC2) instances that run a custom Windows Server 2022. The image includes Microsoft SQL Server 2019 and does NOT have any agents installed.\n\nCurrent Issues -\n\nWhen the users use the VPN connections, Microsoft 365 Defender raises a high volume of impossible travel alerts that are false positives.\nDefender for Identity raises a high volume of Suspected DCSync attack alerts that are false positives.\n\nRequirements -\n\nPlanned changes -\n\nFabrikam plans to implement the following services:\n• Microsoft Defender for Cloud\n• Microsoft Sentinel\n\nBusiness Requirements -\n\nFabrikam identifies the following business requirements:\n• Use the principle of least privilege, whenever possible.\n• Minimize administrative effort.\n\nMicrosoft Defender for Cloud Apps Requirements\n\nFabrikam identifies the following Microsoft Defender for Cloud Apps requirements:\n• Ensure that impossible travel alert policies are based on the previous activities of each user.\n• Reduce the amount of impossible travel alerts that are false positives.\n\nMicrosoft Defender for Identity Requirements\n\nMinimize the administrative effort required to investigate the false positive alerts.\n\nMicrosoft Defender for Cloud Requirements\n\nFabrikam identifies the following Microsoft Defender for Cloud requirements:\n• Ensure that the members of Group2 can modify security policies.\n• Ensure that the members of Group1 can assign regulatory compliance policy initiatives at the Azure subscription level.\n• Automate the deployment of the Azure Connected Machine agent for Azure Arc-enabled servers to the existing and future resources of Account1.\n• Minimize the administrative effort required to investigate the false positive alerts.\n\nMicrosoft Sentinel Requirements\n\nFabrikam identifies the following Microsoft Sentinel requirements:\n• Query for NXDOMAIN DNS requests from the last seven days by using built-in Advanced Security Information Model (ASIM) unifying parsers.\n• From AWS EC2 instances, collect Windows Security event log entries that include local group membership changes.\n• Identify anomalous activities of Azure AD users by using User and Entity Behavior Analytics (UEBA).\n• Evaluate the potential impact of compromised Azure AD user credentials by using UEBA.\n• Ensure that App1 is available for use in Microsoft Sentinel automation rules.\n• Identify the mean time to triage for incidents generated during the last 30 days.\n• Identify the mean time to close incidents generated during the last 30 days.\n• Ensure that the members of Group1 can create and run playbooks.\n• Ensure that the members of Group1 can manage analytics rules.\n• Run hunting queries on Pool1 by using Jupyter notebooks.\n• Ensure that the members of Group2 can manage incidents.\n• Maximize the performance of data queries.\n• Minimize the amount of collected data.\n• Ensure that App1 is available for use in Microsoft Sentinel automation rules.\n\nYou need to ensure that you can run hunting queries to meet the Microsoft Sentinel requirements.\n\nWhich type of workspace should you create?",
      "options": [
        "A. Azure Synapse Analytics",
        "B. Azure Machine Learning",
        "C. Log Analytics",
        "D. Azure Databricks"
      ],
      "answer": [
        "B"
      ],
      "explanation": "To run hunting queries using Jupyter notebooks in Microsoft Sentinel, Azure Machine Learning is required. This service allows security teams to use Python and notebooks for data exploration, visualization, and advanced threat hunting scenarios.\n\nMicrosoft Sentinel supports hunting via notebooks when integrated with Azure Machine Learning. These notebooks are stored and executed within Azure ML workspaces.\n\nOption A (Azure Synapse Analytics) is primarily used for big data analysis and not intended for executing Sentinel hunting notebooks.\nOption C (Log Analytics) is where the Sentinel data is stored but does not host or run notebooks.\nOption D (Azure Databricks) supports notebooks but is not integrated with Sentinel hunting features out-of-the-box.\n\nCorrect answer: Azure Machine Learning.\n\nReference: https://learn.microsoft.com/en-us/azure/machine-learning/how-to-run-jupyter-notebooks?view=azureml-api-2"
    },
    {
      "type": "multiple_choice",
      "question": "Case study -\n\nThis is a case study. Case studies are not timed separately. You can use as much exam time as you would like to complete each case. However, there may be additional case studies and sections on this exam. You must manage your time to ensure that you are able to complete all questions included in the time provided.\n\nTo answer the questions included in a case study, you will need to reference information that is provided in the case study. Case studies might contain exhibits and other resources that provide more information about the scenario that is described in the case study. Each question is independent of the other questions in this case study.\n\nAt the end of this case study, a review screen will appear. This screen allows you to review your answers and to make changes before you move to the next section of the exam. After you begin a new section, you cannot return to this section.\n\nTo start the case study -\nTo display the first question in this case study, click the Next button. Use the buttons in the left pane to explore the content of the case study before you answer the questions. Clicking these buttons displays information such as business requirements, existing environment, and problem statements. If the case study has an All Information tab, note that the information displayed is identical to the information displayed on the subsequent tabs. When you are ready to answer a question, click the Question button to return to the question.\n\nOverview -\n\nFabrikam, Inc. is a financial services company.\n\nThe company has branch offices in New York, London, and Singapore. Fabrikam has remote users located across the globe. The remote users access company resources, including cloud resources, by using a VPN connection to a branch office.\n\nExisting Environment -\n\nIdentity Environment -\n\nThe network contains an Active Directory Domain Services (AD DS) forest named fabrikam.com that syncs with an Azure AD tenant named fabrikam.com. To sync the forest, Fabrikam uses Azure AD Connect with pass-through authentication enabled and password hash synchronization disabled.\n\nThe fabrikam.com forest contains two global groups named Group1 and Group2.\n\nMicrosoft 365 Environment -\n\nAll the users at Fabrikam are assigned a Microsoft 365 E5 license and an Azure Active Directory Premium Plan 2 license.\n\nFabrikam implements Microsoft Defender for Identity and Microsoft Defender for Cloud Apps and enables log collectors.\n\nAzure Environment -\n\nFabrikam has an Azure subscription that contains the resources shown in the following table:\n\n| Name      | Type                              | Description                                                                                           |\n|-----------|-----------------------------------|-------------------------------------------------------------------------------------------------------|\n| App1      | Azure logic app                   | To automate incident generation in an internal ticketing system, the security operations (SecOps) team invokes App1 by using an HTTP endpoint. |\n| SAWkspc1  | Azure Synapse Analytics workspace | SAWkspc1 hosts an Apache Spark pool named Pool1.                                                      |\n| LAWkspc1  | Log Analytics workspace           | LAWkspc1 will be used in a planned Microsoft Sentinel implementation.                                 |\n\nAmazon Web Services (AWS) Environment\n\nFabrikam has an Amazon Web Services (AWS) account named Account1. Account1 contains 100 Amazon Elastic Compute Cloud (EC2) instances that run a custom Windows Server 2022. The image includes Microsoft SQL Server 2019 and does NOT have any agents installed.\n\nCurrent Issues -\n\nWhen the users use the VPN connections, Microsoft 365 Defender raises a high volume of impossible travel alerts that are false positives.\nDefender for Identity raises a high volume of Suspected DCSync attack alerts that are false positives.\n\nRequirements -\n\nPlanned changes -\n\nFabrikam plans to implement the following services:\n• Microsoft Defender for Cloud\n• Microsoft Sentinel\n\nBusiness Requirements -\n\nFabrikam identifies the following business requirements:\n• Use the principle of least privilege, whenever possible.\n• Minimize administrative effort.\n\nMicrosoft Defender for Cloud Apps Requirements\n\nFabrikam identifies the following Microsoft Defender for Cloud Apps requirements:\n• Ensure that impossible travel alert policies are based on the previous activities of each user.\n• Reduce the amount of impossible travel alerts that are false positives.\n\nMicrosoft Defender for Identity Requirements\n\nMinimize the administrative effort required to investigate the false positive alerts.\n\nMicrosoft Defender for Cloud Requirements\n\nFabrikam identifies the following Microsoft Defender for Cloud requirements:\n• Ensure that the members of Group2 can modify security policies.\n• Ensure that the members of Group1 can assign regulatory compliance policy initiatives at the Azure subscription level.\n• Automate the deployment of the Azure Connected Machine agent for Azure Arc-enabled servers to the existing and future resources of Account1.\n• Minimize the administrative effort required to investigate the false positive alerts.\n\nMicrosoft Sentinel Requirements\n\nFabrikam identifies the following Microsoft Sentinel requirements:\n• Query for NXDOMAIN DNS requests from the last seven days by using built-in Advanced Security Information Model (ASIM) unifying parsers.\n• From AWS EC2 instances, collect Windows Security event log entries that include local group membership changes.\n• Identify anomalous activities of Azure AD users by using User and Entity Behavior Analytics (UEBA).\n• Evaluate the potential impact of compromised Azure AD user credentials by using UEBA.\n• Ensure that App1 is available for use in Microsoft Sentinel automation rules.\n• Identify the mean time to triage for incidents generated during the last 30 days.\n• Identify the mean time to close incidents generated during the last 30 days.\n• Ensure that the members of Group1 can create and run playbooks.\n• Ensure that the members of Group1 can manage analytics rules.\n• Run hunting queries on Pool1 by using Jupyter notebooks.\n• Ensure that the members of Group2 can manage incidents.\n• Maximize the performance of data queries.\n• Minimize the amount of collected data.\n• Ensure that App1 is available for use in Microsoft Sentinel automation rules.\n\nYou need to identify which mean time metrics to use to meet the Microsoft Sentinel requirements.\n\nWhich workbook should you use?",
      "options": [
        "A. Event Analyzer",
        "B. Investigation Insights",
        "C. Security Operations Efficiency",
        "D.  Analytics Efficiency"
      ],
      "answer": [
        "C"
      ],
      "explanation": "To meet the requirement of identifying the mean time to triage and close incidents in Microsoft Sentinel, the appropriate tool is the **Security Operations Efficiency** workbook. \n\nThis built-in workbook is specifically designed to provide key operational metrics for security operations centers (SOCs), including:\n- Mean Time to Triage (MTTT)\n- Mean Time to Close (MTTC)\n- Open and closed incident counts\n\nThese metrics help organizations assess their incident response effectiveness and identify bottlenecks or delays in incident resolution.\n\nOther options:\n- A. Event Analyzer: Focuses on alert data and analytics rule performance but not incident response times.\n- B. Investigation Insights: Supports investigation tracking, not time metrics.\n- D. Analytics Efficiency: Primarily measures analytics rule performance, not incident handling metrics.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/manage-soc-with-incident-metrics#security-operations-efficiency-workbook"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft Sentinel playbook that is triggered by using the Azure Activity connector.\n\nYou need to create a new near-real-time (NRT) analytics rule that will use the playbook.\n\nWhat should you configure for the rule?",
      "options": [
        "A. the incident automation settings",
        "B. the query rule",
        "C. entity mapping",
        "D. the Alert automation settings"
      ],
      "answer": [
        "D"
      ],
      "explanation": "Near-real-time (NRT) rules in Microsoft Sentinel are designed to generate alerts quickly in response to events. Unlike scheduled rules, NRT rules do not support incident creation or incident automation directly. Instead, playbooks must be connected using the **Alert automation settings** within the rule configuration.\n\n• Option A is incorrect because incident automation does not apply to NRT rules.\n• Option B (query rule) defines the condition for alerts, not how to automate response.\n• Option C (entity mapping) enriches alert data but doesn't automate anything.\n\n✅ Correct: D. the Alert automation settings\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/tutorial-detect-threats-custom#alert-and-incident-automation"
    },
    {
      "type": "multiple_choice",
      "question": "You need to visualize Microsoft Sentinel data and enrich the data by using third-party data sources to identify indicators of compromise (IoC).\n\nWhat should you use?",
      "options": [
        "A. notebooks in Microsoft Sentinel",
        "B. Microsoft Defender for Cloud Apps",
        "C. Azure Monitor"
      ],
      "answer": [
        "A"
      ],
      "explanation": "✅ **Correct: A. notebooks in Microsoft Sentinel**\n\nNotebooks in Microsoft Sentinel are built on Jupyter notebooks and are highly flexible tools used for advanced hunting, data visualization, and enrichment with external or third-party threat intelligence such as IoCs. They are particularly useful for complex investigations, threat hunting, and correlation of Sentinel data with external sources.\n\n• **Option B** (Microsoft Defender for Cloud Apps) provides cloud app visibility and control but does not support direct enrichment and visualization of Sentinel IoC data.\n• **Option C** (Azure Monitor) is a telemetry platform for collecting and analyzing log and metric data but does not directly support advanced data correlation or enrichment workflows like notebooks.\n\n**Reference**: https://learn.microsoft.com/en-us/azure/sentinel/notebooks"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft Sentinel workspace.\n\nYou enable User and Entity Behavior Analytics (UEBA) by using Audit Logs and Signin Logs.\n\nThe following entities are detected in the Azure AD tenant:\n\n• App name: App1\n• IP address: 192.168.1.2\n• Computer name: Device1\n• Used client app: Microsoft Edge\n• Email address: user1@company.com\n• Sign-in URL: https://www.company.com\n\nWhich entities can be investigated by using UEBA?",
      "options": [
        "A. IP address and email address only",
        "B. app name, computer name, IP address, email address, and used client app only",
        "C. IP address only",
        "D. used client app and app name only"
      ],
      "answer": [
        "B"
      ],
      "explanation": "Microsoft Sentinel UEBA supports investigation based on various entity types including:\n- Account (user or email address)\n- Host (computer name)\n- IP address\n- Application (app name or client app)\n\nAll the entities listed except the sign-in URL are valid for UEBA analysis.\n\n🔗 Reference: https://learn.microsoft.com/en-us/azure/sentinel/identify-threats-with-entity-behavior-analytics\n https://learn.microsoft.com/en-us/azure/sentinel/ueba-reference?tabs=log-analytics"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft Sentinel workspace that uses the Microsoft 365 Defender data connector.\n\nFrom Microsoft Sentinel, you investigate a Microsoft 365 incident.\n\nYou need to update the incident to include an alert generated by Microsoft Defender for Cloud Apps.\n\nWhat should you use?",
      "options": [
        "A. the entity side panel of the Timeline card in Microsoft Sentinel",
        "B. the Timeline tab on the incidents page of Microsoft Sentinel",
        "C. the investigation graph on the incidents page of Microsoft Sentinel",
        "D. the Alerts page in the Microsoft 365 Defender portal"
      ],
      "answer": [
        "A"
      ],
      "explanation": "To associate additional alerts with an existing incident in Microsoft Sentinel, including those from Microsoft Defender for Cloud Apps, you can use the entity side panel within the Timeline card. This feature allows manual association of alerts based on entities involved, improving incident correlation and investigation.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/relate-alerts-to-incidents#add-alerts-using-the-entity-timeline-preview"
    },
    {
      "type": "multiple_choice",
      "question": "You investigate an incident that has the following entities:\n• A user account named User1\n• An IP address of 192.168.10.200\n• An Azure virtual machine named VM1\n• An on-premises server named Server1\n\nYou need to label an entity as an indicator of compromise (IoC) directly by using the incidents page.\n\nWhich entity can you label?",
      "options": [
        "A. 192.168.10.200",
        "B. VM1",
        "C. Server1",
        "D. User1"
      ],
      "answer": [
        "A"
      ],
      "explanation": "You can label IP addresses as indicators of compromise (IoCs) directly from the Microsoft Sentinel incidents page. This enables quick integration with threat intelligence and enhances automated detection.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/add-entity-to-threat-intelligence?tabs=incidents#add-an-entity-to-your-indicators-list"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft Sentinel workspace that has User and Entity Behavior Analytics (UEBA) enabled for Signin Logs.\n\nYou need to ensure that failed interactive sign-ins are detected. The solution must minimize administrative effort.\n\nWhat should you use?",
      "options": [
        "A. a scheduled alert query",
        "B. the Activity Log data connector",
        "C. a UEBA activity template",
        "D. a hunting query"
      ],
      "answer": [
        "A"
      ],
      "explanation": "Using a **scheduled alert query** is the most effective and low-maintenance solution to detect failed interactive sign-ins. Microsoft Sentinel provides built-in anomaly detection through scheduled analytics rules. This aligns with the goal of minimizing administrative effort while ensuring continuous monitoring.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/anomalies-reference#anomalous-failed-sign-in"
    },
    {
      "type": "multiple_choice",
      "question": "You have 50 Microsoft Sentinel workspaces.\n\nYou need to view all the incidents from all the workspaces on a single page in the Azure portal. The solution must minimize administrative effort.\n\nWhich page should you use in the Azure portal?",
      "options": [
        "A. Microsoft Sentinel - Incidents",
        "B. Microsoft Sentinel - Workbooks",
        "C. Microsoft Sentinel",
        "D. Log Analytics workspaces"
      ],
      "answer": [
        "A"
      ],
      "explanation": "To view incidents across multiple Microsoft Sentinel workspaces on a single page, you can use the **Microsoft Sentinel - Incidents** page in the Azure portal. This view supports multi-workspace incident investigation and monitoring, which minimizes administrative overhead.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/multiple-workspace-view#entering-multiple-workspace-view"
    },
    {
      "type": "multiple_choice",
      "question": "Case Study -\n\nThis is a case study. Case studies are not timed separately. You can use as much exam time as you would like to complete each case. However, there may be additional case studies and sections on this exam. You must manage your time to ensure that you are able to complete all questions included on this exam in the time provided.\n\nTo answer the questions included in a case study, you will need to reference information that is provided in the case study. Case studies might contain exhibits and other resources that provide more information about the scenario that is described in the case study. Each question is independent of the other questions in this case study.\n\nAt the end of this case study, a review screen will appear. This screen allows you to review your answers and to make changes before you move to the next section of the exam. After you begin a new section, you cannot return to this section.\n\nTo start the case study -\nTo display the first question in this case study, click the Next button. Use the buttons in the left pane to explore the content of the case study before you answer the questions. Clicking these buttons displays information such as business requirements, existing environment, and problem statements. If the case study has an All Information tab, note that the information displayed is identical to the information displayed on the subsequent tabs. When you are ready to answer a question, click the Question button to return to the question.\n\nOverview -\n\nAdatum Corporation is a United States-based financial services company that has regional offices in New York, Chicago, and San Francisco.\n\nExisting Environment -\n\nIdentity Environment -\nThe on-premises network contains an Active Directory Domain Services (AD DS) forest named corp.adatum.com that syncs with an Azure AD tenant named adatum.com. All user and group management tasks are performed in corp.adatum.com. The corp.adatum.com domain contains a group named Group1 that syncs with adatum.com.\n\nLicensing Status -\nAll the users at Adatum are assigned a Microsoft 365 E5 license and an Azure Active Directory Premium P2 license.\n\nCloud Environment -\nThe cloud environment contains a Microsoft 365 subscription, an Azure subscription linked to the adatum.com tenant, and the resources shown in the following table:\n\n| Name      | Type                          | Description                                                          |\n|-----------|-------------------------------|----------------------------------------------------------------------|\n| Sentinel1 | Microsoft Sentinel workspace  | Includes a custom hunting query named HuntingQuery1                 |\n| Server2   | Azure virtual machine         | Runs Windows Server 2022                                            |\n\nOn-premises Environment -\n\nThe on-premises network contains the resources shown in the following table:\n\n| Name      | Type                  | Description                                                                                       |\n|-----------|-----------------------|---------------------------------------------------------------------------------------------------|\n| Server1   | Server                | Runs Windows Server 2019. Has Azure Arc-enabled and the Azure Monitor agent installed             |\n| Webapp1   | Web service           | An on-premises, public-facing HTTP/HTTPS web service that generates JSON output in response to GET HTTP requests |\n| Infoblox1 | Infoblox DNS service  | A third-party DNS service appliance linked to Sentinel1 by using a data connector                 |\n\nRequirements -\n\nPlanned changes -\nAdatum plans to perform the following changes:\n• Implement a query named rulequery1 that will include the following KQL query:\n\nAzureActivity\n| where ResourceProviderValue == \"MICROSOFT.CLOUDSHELL\"\n| where ActivityStatusValue == \"Start\"\n| extend \n    Account_0_Name = tostring(split(Caller, '@', 0)[0]),\n    Account_0_UPNSuffix = tostring(split(Caller, '@', 1)[0])\n| project Account_0_Name, Account_0_UPNSuffix, CallerIpAddress, TimeGenerated\n\n• Implement a Microsoft Sentinel scheduled rule that generates incidents based on rulequery1.\n\nMicrosoft Defender for Cloud Requirements:\nAdatum identifies the following Microsoft Defender for Cloud requirements:\n• The members of Group1 must be able to enable Defender for Cloud plans and apply regulatory compliance initiatives.\n• Microsoft Defender for Servers Plan 2 must be enabled on all the Azure virtual machines.\n• Server2 must be excluded from agentless scanning.\n\nMicrosoft Sentinel Requirements:\nAdatum identifies the following Microsoft Sentinel requirements:\n• Implement an Advanced Security Information Model (ASIM) query that will return a count of DNS requests that results in an NXDOMAIN response from Infoblox1.\n• Ensure that multiple alerts generated by rulequery1 in response to a single user launching Azure Cloud Shell multiple times are consolidated as a single incident.\n• Implement the Windows Security Events via AMA connector for Microsoft Sentinel and configure it to monitor the Security event log of Server1.\n• Ensure that incidents generated by rulequery1 are closed automatically if Azure Cloud Shell is launched by the company’s SecOps team.\n• Implement a custom Microsoft Sentinel workbook named Workbook1 that will include a query to dynamically retrieve data from Webapp1.\n• Implement a Microsoft Sentinel near-real-time (NRT) analytics rule that detects sign-ins to a designated break glass account.\n• Ensure that HuntingQuery1 runs automatically when the Hunting page of Microsoft Sentinel in the Azure portal is accessed.\n• Ensure that higher than normal volumes of password resets for corp.adatum.com user accounts are detected.\n• Minimize the overhead associated with queries that use ASIM parsers.\n• Ensure that the Group1 members can create and edit playbooks.\n• Use built-in ASIM parsers whenever possible.\n\nBusiness Requirements:\nAdatum identifies the following business requirements:\n• Follow the principle of least privilege whenever possible.\n• Minimize administrative effort whenever possible.\n\nYou need to implement the scheduled rule for incident generation based on rulequery1.\n\nWhat should you configure first?",
      "options": [
        "A. custom details",
        "B. entity mapping",
        "C. event grouping",
        "D. alert details"
      ],
      "answer": [
        "B"
      ],
      "explanation": "When creating a scheduled analytics rule in Microsoft Sentinel, **entity mapping** is one of the key components to configure first. This ensures that Sentinel can identify and associate users, IP addresses, and other entities from the query output, enabling better detection and correlation.\n\nBy mapping fields such as `Account_0_Name` and `CallerIpAddress` to entity types like Account and IP, you empower Sentinel to use these entities in investigations, UEBA, and entity timelines.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/create-analytics-rules?tabs=azure-portal"
    },
    {
      "type": "multiple_choice",
      "question": "Case Study -\n\nThis is a case study. Case studies are not timed separately. You can use as much exam time as you would like to complete each case. However, there may be additional case studies and sections on this exam. You must manage your time to ensure that you are able to complete all questions included on this exam in the time provided.\n\nTo answer the questions included in a case study, you will need to reference information that is provided in the case study. Case studies might contain exhibits and other resources that provide more information about the scenario that is described in the case study. Each question is independent of the other questions in this case study.\n\nAt the end of this case study, a review screen will appear. This screen allows you to review your answers and to make changes before you move to the next section of the exam. After you begin a new section, you cannot return to this section.\n\nTo start the case study -\nTo display the first question in this case study, click the Next button. Use the buttons in the left pane to explore the content of the case study before you answer the questions. Clicking these buttons displays information such as business requirements, existing environment, and problem statements. If the case study has an All Information tab, note that the information displayed is identical to the information displayed on the subsequent tabs. When you are ready to answer a question, click the Question button to return to the question.\n\nOverview -\n\nAdatum Corporation is a United States-based financial services company that has regional offices in New York, Chicago, and San Francisco.\n\nExisting Environment -\n\nIdentity Environment -\nThe on-premises network contains an Active Directory Domain Services (AD DS) forest named corp.adatum.com that syncs with an Azure AD tenant named adatum.com. All user and group management tasks are performed in corp.adatum.com. The corp.adatum.com domain contains a group named Group1 that syncs with adatum.com.\n\nLicensing Status -\nAll the users at Adatum are assigned a Microsoft 365 E5 license and an Azure Active Directory Premium P2 license.\n\nCloud Environment -\nThe cloud environment contains a Microsoft 365 subscription, an Azure subscription linked to the adatum.com tenant, and the resources shown in the following table:\n\n| Name      | Type                          | Description                                                          |\n|-----------|-------------------------------|----------------------------------------------------------------------|\n| Sentinel1 | Microsoft Sentinel workspace  | Includes a custom hunting query named HuntingQuery1                 |\n| Server2   | Azure virtual machine         | Runs Windows Server 2022                                            |\n\nOn-premises Environment -\n\nThe on-premises network contains the resources shown in the following table:\n\n| Name      | Type                  | Description                                                                                       |\n|-----------|-----------------------|---------------------------------------------------------------------------------------------------|\n| Server1   | Server                | Runs Windows Server 2019. Has Azure Arc-enabled and the Azure Monitor agent installed             |\n| Webapp1   | Web service           | An on-premises, public-facing HTTP/HTTPS web service that generates JSON output in response to GET HTTP requests |\n| Infoblox1 | Infoblox DNS service  | A third-party DNS service appliance linked to Sentinel1 by using a data connector                 |\n\nRequirements -\n\nPlanned changes -\nAdatum plans to perform the following changes:\n• Implement a query named rulequery1 that will include the following KQL query:\n\nAzureActivity\n| where ResourceProviderValue == \"MICROSOFT.CLOUDSHELL\"\n| where ActivityStatusValue == \"Start\"\n| extend \n    Account_0_Name = tostring(split(Caller, '@', 0)[0]),\n    Account_0_UPNSuffix = tostring(split(Caller, '@', 1)[0])\n| project Account_0_Name, Account_0_UPNSuffix, CallerIpAddress, TimeGenerated\n\n• Implement a Microsoft Sentinel scheduled rule that generates incidents based on rulequery1.\n\nMicrosoft Defender for Cloud Requirements:\nAdatum identifies the following Microsoft Defender for Cloud requirements:\n• The members of Group1 must be able to enable Defender for Cloud plans and apply regulatory compliance initiatives.\n• Microsoft Defender for Servers Plan 2 must be enabled on all the Azure virtual machines.\n• Server2 must be excluded from agentless scanning.\n\nMicrosoft Sentinel Requirements:\nAdatum identifies the following Microsoft Sentinel requirements:\n• Implement an Advanced Security Information Model (ASIM) query that will return a count of DNS requests that results in an NXDOMAIN response from Infoblox1.\n• Ensure that multiple alerts generated by rulequery1 in response to a single user launching Azure Cloud Shell multiple times are consolidated as a single incident.\n• Implement the Windows Security Events via AMA connector for Microsoft Sentinel and configure it to monitor the Security event log of Server1.\n• Ensure that incidents generated by rulequery1 are closed automatically if Azure Cloud Shell is launched by the company’s SecOps team.\n• Implement a custom Microsoft Sentinel workbook named Workbook1 that will include a query to dynamically retrieve data from Webapp1.\n• Implement a Microsoft Sentinel near-real-time (NRT) analytics rule that detects sign-ins to a designated break glass account.\n• Ensure that HuntingQuery1 runs automatically when the Hunting page of Microsoft Sentinel in the Azure portal is accessed.\n• Ensure that higher than normal volumes of password resets for corp.adatum.com user accounts are detected.\n• Minimize the overhead associated with queries that use ASIM parsers.\n• Ensure that the Group1 members can create and edit playbooks.\n• Use built-in ASIM parsers whenever possible.\n\nBusiness Requirements:\nAdatum identifies the following business requirements:\n• Follow the principle of least privilege whenever possible.\n• Minimize administrative effort whenever possible.\n\nYou need to ensure that the processing of incidents generated by rulequery1 meets the Microsoft Sentinel requirements.\n\nWhat should you create first?",
      "options": [
        "A. a playbook with an incident trigger",
        "B. a playbook with an alert trigger",
        "C. an Azure Automation rule",
        "D. a playbook with an entity trigger"
      ],
      "answer": [
        "A"
      ],
      "explanation": "To meet the requirement of automatically processing and closing incidents generated by rulequery1, the first step is to create a **playbook with an incident trigger**. This ensures that the automation process is initiated whenever a new incident is created that matches the criteria. This aligns with the requirement to close incidents launched by the SecOps team and integrates with Sentinel's automation capabilities.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/automation/automation"
    },
    {
      "type": "multiple_choice",
      "question": "Case Study -\n\nThis is a case study. Case studies are not timed separately. You can use as much exam time as you would like to complete each case. However, there may be additional case studies and sections on this exam. You must manage your time to ensure that you are able to complete all questions included on this exam in the time provided.\n\nTo answer the questions included in a case study, you will need to reference information that is provided in the case study. Case studies might contain exhibits and other resources that provide more information about the scenario that is described in the case study. Each question is independent of the other questions in this case study.\n\nAt the end of this case study, a review screen will appear. This screen allows you to review your answers and to make changes before you move to the next section of the exam. After you begin a new section, you cannot return to this section.\n\nTo start the case study -\nTo display the first question in this case study, click the Next button. Use the buttons in the left pane to explore the content of the case study before you answer the questions. Clicking these buttons displays information such as business requirements, existing environment, and problem statements. If the case study has an All Information tab, note that the information displayed is identical to the information displayed on the subsequent tabs. When you are ready to answer a question, click the Question button to return to the question.\n\nOverview -\n\nAdatum Corporation is a United States-based financial services company that has regional offices in New York, Chicago, and San Francisco.\n\nExisting Environment -\n\nIdentity Environment -\nThe on-premises network contains an Active Directory Domain Services (AD DS) forest named corp.adatum.com that syncs with an Azure AD tenant named adatum.com. All user and group management tasks are performed in corp.adatum.com. The corp.adatum.com domain contains a group named Group1 that syncs with adatum.com.\n\nLicensing Status -\nAll the users at Adatum are assigned a Microsoft 365 E5 license and an Azure Active Directory Premium P2 license.\n\nCloud Environment -\nThe cloud environment contains a Microsoft 365 subscription, an Azure subscription linked to the adatum.com tenant, and the resources shown in the following table:\n\n| Name      | Type                          | Description                                                          |\n|-----------|-------------------------------|----------------------------------------------------------------------|\n| Sentinel1 | Microsoft Sentinel workspace  | Includes a custom hunting query named HuntingQuery1                 |\n| Server2   | Azure virtual machine         | Runs Windows Server 2022                                            |\n\nOn-premises Environment -\n\nThe on-premises network contains the resources shown in the following table:\n\n| Name      | Type                  | Description                                                                                       |\n|-----------|-----------------------|---------------------------------------------------------------------------------------------------|\n| Server1   | Server                | Runs Windows Server 2019. Has Azure Arc-enabled and the Azure Monitor agent installed             |\n| Webapp1   | Web service           | An on-premises, public-facing HTTP/HTTPS web service that generates JSON output in response to GET HTTP requests |\n| Infoblox1 | Infoblox DNS service  | A third-party DNS service appliance linked to Sentinel1 by using a data connector                 |\n\nRequirements -\n\nPlanned changes -\nAdatum plans to perform the following changes:\n• Implement a query named rulequery1 that will include the following KQL query:\n\nAzureActivity\n| where ResourceProviderValue == \"MICROSOFT.CLOUDSHELL\"\n| where ActivityStatusValue == \"Start\"\n| extend \n    Account_0_Name = tostring(split(Caller, '@', 0)[0]),\n    Account_0_UPNSuffix = tostring(split(Caller, '@', 1)[0])\n| project Account_0_Name, Account_0_UPNSuffix, CallerIpAddress, TimeGenerated\n\n• Implement a Microsoft Sentinel scheduled rule that generates incidents based on rulequery1.\n\nMicrosoft Defender for Cloud Requirements:\nAdatum identifies the following Microsoft Defender for Cloud requirements:\n• The members of Group1 must be able to enable Defender for Cloud plans and apply regulatory compliance initiatives.\n• Microsoft Defender for Servers Plan 2 must be enabled on all the Azure virtual machines.\n• Server2 must be excluded from agentless scanning.\n\nMicrosoft Sentinel Requirements:\nAdatum identifies the following Microsoft Sentinel requirements:\n• Implement an Advanced Security Information Model (ASIM) query that will return a count of DNS requests that results in an NXDOMAIN response from Infoblox1.\n• Ensure that multiple alerts generated by rulequery1 in response to a single user launching Azure Cloud Shell multiple times are consolidated as a single incident.\n• Implement the Windows Security Events via AMA connector for Microsoft Sentinel and configure it to monitor the Security event log of Server1.\n• Ensure that incidents generated by rulequery1 are closed automatically if Azure Cloud Shell is launched by the company’s SecOps team.\n• Implement a custom Microsoft Sentinel workbook named Workbook1 that will include a query to dynamically retrieve data from Webapp1.\n• Implement a Microsoft Sentinel near-real-time (NRT) analytics rule that detects sign-ins to a designated break glass account.\n• Ensure that HuntingQuery1 runs automatically when the Hunting page of Microsoft Sentinel in the Azure portal is accessed.\n• Ensure that higher than normal volumes of password resets for corp.adatum.com user accounts are detected.\n• Minimize the overhead associated with queries that use ASIM parsers.\n• Ensure that the Group1 members can create and edit playbooks.\n• Use built-in ASIM parsers whenever possible.\n\nBusiness Requirements:\nAdatum identifies the following business requirements:\n• Follow the principle of least privilege whenever possible.\n• Minimize administrative effort whenever possible.\n\nYou need to configure event monitoring for Server1. The solution must meet the Microsoft Sentinel requirements.\n\nWhat should you create first?",
      "options": [
        "A. a Microsoft Sentinel automation rule",
        "B. an Azure Event Grid topic",
        "C. a Microsoft Sentinel scheduled query rule",
        "D. a Data Collection Rule (DCR)"
      ],
      "answer": [
        "D"
      ],
      "explanation": "To monitor Windows Security events using the Azure Monitor Agent (AMA), the first step is to create a **Data Collection Rule (DCR)**. \n\nDCRs define how data should be collected and from which sources (like Server1), and they are required for ingesting data into Microsoft Sentinel via the AMA connector.\n\nThis enables Microsoft Sentinel to properly collect and process security event logs, especially from Arc-enabled servers such as Server1.\n\n**Reference**: https://learn.microsoft.com/en-us/azure/azure-monitor/essentials/data-collection-rule-overview?tabs=portal#data-collection-rule-associations-dcras"
    },
    {
      "type": "multiple_choice",
      "question": "Case Study -\n\nThis is a case study. Case studies are not timed separately. You can use as much exam time as you would like to complete each case. However, there may be additional case studies and sections on this exam. You must manage your time to ensure that you are able to complete all questions included on this exam in the time provided.\n\nTo answer the questions included in a case study, you will need to reference information that is provided in the case study. Case studies might contain exhibits and other resources that provide more information about the scenario that is described in the case study. Each question is independent of the other questions in this case study.\n\nAt the end of this case study, a review screen will appear. This screen allows you to review your answers and to make changes before you move to the next section of the exam. After you begin a new section, you cannot return to this section.\n\nTo start the case study -\nTo display the first question in this case study, click the Next button. Use the buttons in the left pane to explore the content of the case study before you answer the questions. Clicking these buttons displays information such as business requirements, existing environment, and problem statements. If the case study has an All Information tab, note that the information displayed is identical to the information displayed on the subsequent tabs. When you are ready to answer a question, click the Question button to return to the question.\n\nOverview -\n\nAdatum Corporation is a United States-based financial services company that has regional offices in New York, Chicago, and San Francisco.\n\nExisting Environment -\n\nIdentity Environment -\nThe on-premises network contains an Active Directory Domain Services (AD DS) forest named corp.adatum.com that syncs with an Azure AD tenant named adatum.com. All user and group management tasks are performed in corp.adatum.com. The corp.adatum.com domain contains a group named Group1 that syncs with adatum.com.\n\nLicensing Status -\nAll the users at Adatum are assigned a Microsoft 365 E5 license and an Azure Active Directory Premium P2 license.\n\nCloud Environment -\nThe cloud environment contains a Microsoft 365 subscription, an Azure subscription linked to the adatum.com tenant, and the resources shown in the following table:\n\n| Name      | Type                          | Description                                                          |\n|-----------|-------------------------------|----------------------------------------------------------------------|\n| Sentinel1 | Microsoft Sentinel workspace  | Includes a custom hunting query named HuntingQuery1                 |\n| Server2   | Azure virtual machine         | Runs Windows Server 2022                                            |\n\nOn-premises Environment -\n\nThe on-premises network contains the resources shown in the following table:\n\n| Name      | Type                  | Description                                                                                       |\n|-----------|-----------------------|---------------------------------------------------------------------------------------------------|\n| Server1   | Server                | Runs Windows Server 2019. Has Azure Arc-enabled and the Azure Monitor agent installed             |\n| Webapp1   | Web service           | An on-premises, public-facing HTTP/HTTPS web service that generates JSON output in response to GET HTTP requests |\n| Infoblox1 | Infoblox DNS service  | A third-party DNS service appliance linked to Sentinel1 by using a data connector                 |\n\nRequirements -\n\nPlanned changes -\nAdatum plans to perform the following changes:\n• Implement a query named rulequery1 that will include the following KQL query:\n\nAzureActivity\n| where ResourceProviderValue == \"MICROSOFT.CLOUDSHELL\"\n| where ActivityStatusValue == \"Start\"\n| extend \n    Account_0_Name = tostring(split(Caller, '@', 0)[0]),\n    Account_0_UPNSuffix = tostring(split(Caller, '@', 1)[0])\n| project Account_0_Name, Account_0_UPNSuffix, CallerIpAddress, TimeGenerated\n\n• Implement a Microsoft Sentinel scheduled rule that generates incidents based on rulequery1.\n\nMicrosoft Defender for Cloud Requirements:\nAdatum identifies the following Microsoft Defender for Cloud requirements:\n• The members of Group1 must be able to enable Defender for Cloud plans and apply regulatory compliance initiatives.\n• Microsoft Defender for Servers Plan 2 must be enabled on all the Azure virtual machines.\n• Server2 must be excluded from agentless scanning.\n\nMicrosoft Sentinel Requirements:\nAdatum identifies the following Microsoft Sentinel requirements:\n• Implement an Advanced Security Information Model (ASIM) query that will return a count of DNS requests that results in an NXDOMAIN response from Infoblox1.\n• Ensure that multiple alerts generated by rulequery1 in response to a single user launching Azure Cloud Shell multiple times are consolidated as a single incident.\n• Implement the Windows Security Events via AMA connector for Microsoft Sentinel and configure it to monitor the Security event log of Server1.\n• Ensure that incidents generated by rulequery1 are closed automatically if Azure Cloud Shell is launched by the company’s SecOps team.\n• Implement a custom Microsoft Sentinel workbook named Workbook1 that will include a query to dynamically retrieve data from Webapp1.\n• Implement a Microsoft Sentinel near-real-time (NRT) analytics rule that detects sign-ins to a designated break glass account.\n• Ensure that HuntingQuery1 runs automatically when the Hunting page of Microsoft Sentinel in the Azure portal is accessed.\n• Ensure that higher than normal volumes of password resets for corp.adatum.com user accounts are detected.\n• Minimize the overhead associated with queries that use ASIM parsers.\n• Ensure that the Group1 members can create and edit playbooks.\n• Use built-in ASIM parsers whenever possible.\n\nBusiness Requirements:\nAdatum identifies the following business requirements:\n• Follow the principle of least privilege whenever possible.\n• Minimize administrative effort whenever possible.\n\nYou need to ensure that the Group1 members can meet the Microsoft Sentinel requirements.\nWhich role should you assign to Group1?",
      "options": [
        "A. Microsoft Sentinel Playbook Operator",
        "B. Logic App Contributor",
        "C. Automation Operator",
        "D. Microsoft Sentinel Automation Contributor"
      ],
      "answer": [
        "B"
      ],
      "explanation": "To enable Group1 members to **create and edit playbooks**, they need permissions to manage Logic Apps. The **Logic App Contributor** role grants the required permissions to create, edit, and manage logic apps, which are used as playbooks in Microsoft Sentinel.\n\nOther roles such as 'Microsoft Sentinel Playbook Operator' or 'Automation Contributor' do not grant the necessary write permissions to logic apps.\n\n**Reference**: https://learn.microsoft.com/en-us/azure/sentinel/roles#other-roles-and-permissions"
    },
    {
      "type": "multiple_choice",
      "question": "Case Study -\n\nThis is a case study. Case studies are not timed separately. You can use as much exam time as you would like to complete each case. However, there may be additional case studies and sections on this exam. You must manage your time to ensure that you are able to complete all questions included on this exam in the time provided.\n\nTo answer the questions included in a case study, you will need to reference information that is provided in the case study. Case studies might contain exhibits and other resources that provide more information about the scenario that is described in the case study. Each question is independent of the other questions in this case study.\n\nAt the end of this case study, a review screen will appear. This screen allows you to review your answers and to make changes before you move to the next section of the exam. After you begin a new section, you cannot return to this section.\n\nTo start the case study -\nTo display the first question in this case study, click the Next button. Use the buttons in the left pane to explore the content of the case study before you answer the questions. Clicking these buttons displays information such as business requirements, existing environment, and problem statements. If the case study has an All Information tab, note that the information displayed is identical to the information displayed on the subsequent tabs. When you are ready to answer a question, click the Question button to return to the question.\n\nOverview -\n\nAdatum Corporation is a United States-based financial services company that has regional offices in New York, Chicago, and San Francisco.\n\nExisting Environment -\n\nIdentity Environment -\nThe on-premises network contains an Active Directory Domain Services (AD DS) forest named corp.adatum.com that syncs with an Azure AD tenant named adatum.com. All user and group management tasks are performed in corp.adatum.com. The corp.adatum.com domain contains a group named Group1 that syncs with adatum.com.\n\nLicensing Status -\nAll the users at Adatum are assigned a Microsoft 365 E5 license and an Azure Active Directory Premium P2 license.\n\nCloud Environment -\nThe cloud environment contains a Microsoft 365 subscription, an Azure subscription linked to the adatum.com tenant, and the resources shown in the following table:\n\n| Name      | Type                          | Description                                                          |\n|-----------|-------------------------------|----------------------------------------------------------------------|\n| Sentinel1 | Microsoft Sentinel workspace  | Includes a custom hunting query named HuntingQuery1                 |\n| Server2   | Azure virtual machine         | Runs Windows Server 2022                                            |\n\nOn-premises Environment -\n\nThe on-premises network contains the resources shown in the following table:\n\n| Name      | Type                  | Description                                                                                       |\n|-----------|-----------------------|---------------------------------------------------------------------------------------------------|\n| Server1   | Server                | Runs Windows Server 2019. Has Azure Arc-enabled and the Azure Monitor agent installed             |\n| Webapp1   | Web service           | An on-premises, public-facing HTTP/HTTPS web service that generates JSON output in response to GET HTTP requests |\n| Infoblox1 | Infoblox DNS service  | A third-party DNS service appliance linked to Sentinel1 by using a data connector                 |\n\nRequirements -\n\nPlanned changes -\nAdatum plans to perform the following changes:\n• Implement a query named rulequery1 that will include the following KQL query:\n\nAzureActivity\n| where ResourceProviderValue == \"MICROSOFT.CLOUDSHELL\"\n| where ActivityStatusValue == \"Start\"\n| extend \n    Account_0_Name = tostring(split(Caller, '@', 0)[0]),\n    Account_0_UPNSuffix = tostring(split(Caller, '@', 1)[0])\n| project Account_0_Name, Account_0_UPNSuffix, CallerIpAddress, TimeGenerated\n\n• Implement a Microsoft Sentinel scheduled rule that generates incidents based on rulequery1.\n\nMicrosoft Defender for Cloud Requirements:\nAdatum identifies the following Microsoft Defender for Cloud requirements:\n• The members of Group1 must be able to enable Defender for Cloud plans and apply regulatory compliance initiatives.\n• Microsoft Defender for Servers Plan 2 must be enabled on all the Azure virtual machines.\n• Server2 must be excluded from agentless scanning.\n\nMicrosoft Sentinel Requirements:\nAdatum identifies the following Microsoft Sentinel requirements:\n• Implement an Advanced Security Information Model (ASIM) query that will return a count of DNS requests that results in an NXDOMAIN response from Infoblox1.\n• Ensure that multiple alerts generated by rulequery1 in response to a single user launching Azure Cloud Shell multiple times are consolidated as a single incident.\n• Implement the Windows Security Events via AMA connector for Microsoft Sentinel and configure it to monitor the Security event log of Server1.\n• Ensure that incidents generated by rulequery1 are closed automatically if Azure Cloud Shell is launched by the company’s SecOps team.\n• Implement a custom Microsoft Sentinel workbook named Workbook1 that will include a query to dynamically retrieve data from Webapp1.\n• Implement a Microsoft Sentinel near-real-time (NRT) analytics rule that detects sign-ins to a designated break glass account.\n• Ensure that HuntingQuery1 runs automatically when the Hunting page of Microsoft Sentinel in the Azure portal is accessed.\n• Ensure that higher than normal volumes of password resets for corp.adatum.com user accounts are detected.\n• Minimize the overhead associated with queries that use ASIM parsers.\n• Ensure that the Group1 members can create and edit playbooks.\n• Use built-in ASIM parsers whenever possible.\n\nBusiness Requirements:\nAdatum identifies the following business requirements:\n• Follow the principle of least privilege whenever possible.\n• Minimize administrative effort whenever possible.\n\nYou need to ensure that the configuration of HuntingQuery1 meets the Microsoft Sentinel requirements.\nWhat should you do?",
      "options": [
        "A. Add HuntingQuery1 to a livestream.",
        "B. Create a watchlist.",
        "C. Create an Azure Automation rule.",
        "D. Add HuntingQuery1 to favorites."
      ],
      "answer": [
        "D"
      ],
      "explanation": "To ensure that a hunting query like **HuntingQuery1** runs automatically when the Hunting page is accessed in Microsoft Sentinel, you must **add the query to favorites**. This ensures it is evaluated each time the Hunting dashboard is loaded.\n\nAdding it to a livestream or automation rule does not automatically run the query in the hunting interface.\n\n**Reference**: https://learn.microsoft.com/en-us/azure/sentinel/hunting"
    },
    {
      "type": "multiple_choice",
      "question": "You have an Azure subscription that contains a Microsoft Sentinel workspace named Workspace1.\n\nFrom Content Hub, you deploy the Microsoft Entra solution for Microsoft Sentinel and configure a connector.\n\nYou need to analyze actions performed by users that have administrative privileges to the subscription.\n\nWhich workbook should you use?",
      "options": [
        "A. Azure Activity",
        "B. Microsoft Entra Audit logs",
        "C. Microsoft Entra Sign-ins logs",
        "D. Identity & Access"
      ],
      "answer": [
        "A"
      ],
      "explanation": "The **Azure Activity** workbook is used to monitor and analyze activity logs, including operations performed by users with administrative privileges. These logs provide detailed insights into control-plane operations in your subscription, which aligns with the goal of analyzing privileged user actions.\n\nReference: https://learn.microsoft.com/en-us/azure/azure-monitor/essentials/activity-log-insights"
    },
    {
      "type": "multiple_choice",
      "question": "You have an Azure subscription that contains a Microsoft Sentinel workspace named Workspace1 and a user named User1.\n\nYou need to ensure that User1 can investigate incidents by using Workspace1. The solution must follow the principle of least privilege.\n\nWhich role should you assign to User1?",
      "options": [
        "A. Microsoft Sentinel Responder",
        "B. Microsoft Sentinel Contributor",
        "C. Microsoft Sentinel Automation Contributor",
        "D. Microsoft Sentinel Reader"
      ],
      "answer": [
        "A"
      ],
      "explanation": "The **Microsoft Sentinel Responder** role provides the least privilege necessary for investigating incidents. It allows users to view, assign, and close incidents and to investigate entities and evidence, without giving them broader configuration or management permissions.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/investigate-incidents"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 subscription that uses Microsoft Defender XDR.\n\nYou are investigating an incident.\n\nYou need to review the incident tasks that were performed. The solution must include a query that will display the incidents in a workbook, and then display the tasks of each incident in another grid.\n\nWhich table should you target in the query?",
      "options": [
        "A. SecurityIncident",
        "B. SecurityEvent",
        "C. SentinelAudit",
        "D. SecurityAlert"
      ],
      "answer": [
        "A"
      ],
      "explanation": "The **SecurityIncident** table provides detailed information about security incidents, including status, severity, description, and tasks associated with each incident. This makes it the appropriate choice for visualizing incident tasks in Microsoft Sentinel workbooks.\n\nReference: https://learn.microsoft.com/en-us/azure/azure-monitor/reference/tables/securityincident"
    },
    {
      "type": "multiple_choice",
      "question": "You have an Azure subscription that contains a Microsoft Sentinel workspace named WS1 and 100 virtual machines that run Windows Server.\n\nYou need to configure the collection of Windows Security event logs for ingestion to WS1. The solution must meet the following requirements:\n\n• Capture a full user audit trail including user sign-in and user sign-out events.\n• Minimize the volume of events.\n• Minimize administrative effort.\n\nWhich event set should you select?",
      "options": [
        "A. Minimal",
        "B. Common",
        "C. All events",
        "D. Custom"
      ],
      "answer": [
        "B"
      ],
      "explanation": "The **Common** event set is designed to include the most important security events such as user sign-ins, sign-outs, and other relevant actions. It provides a balance between capturing necessary audit trails and minimizing event volume and administrative overhead.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/windows-security-event-id-reference"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 subscription that uses Microsoft Defender for Cloud Apps and has Cloud Discovery enabled.\n\nYou need to enrich the Cloud Discovery data. The solution must ensure that usernames in the Cloud Discovery traffic logs are associated with the user principal name (UPN) of the corresponding Microsoft Entra ID user accounts.\n\nWhat should you do first?",
      "options": [
        "A. From Conditional Access App Control, configure User monitoring.",
        "B. Create a Microsoft 365 app connector.",
        "C. Enable automatic redirection to Microsoft 365 Defender.",
        "D. Create an Azure app connector."
      ],
      "answer": [
        "B"
      ],
      "explanation": "To enrich Cloud Discovery data with usernames and map them to the corresponding Microsoft Entra ID user accounts, you must first create a **Microsoft 365 app connector**. This connector provides visibility into user activity and enables Microsoft Defender for Cloud Apps to associate traffic log usernames with user principal names (UPNs), allowing for better identity correlation.\n\nReference: https://learn.microsoft.com/en-us/defender-cloud-apps/cloud-discovery-aad-enrichment"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 E5 subscription that uses Microsoft Defender XDR and contains a user named User1.\n\nYou need to ensure that User1 can manage Microsoft Defender XDR custom detection rules and Endpoint security policies. The solution must follow the principle of least privilege.\n\nWhich role should you assign to User1?",
      "options": [
        "A. Security Administrator",
        "B. Security Operator",
        "C. Cloud Device Administrator",
        "D. Desktop Analytics Administrator"
      ],
      "answer": [
        "A"
      ],
      "explanation": "The **Security Administrator** role allows users to manage Microsoft Defender XDR security settings, including custom detection rules and endpoint security policies. This role is designed to provide full security configuration access while aligning with the principle of least privilege.\n\nOther roles such as Security Operator or Cloud Device Administrator lack sufficient permissions to manage custom detections or security configurations.\n\nReference: https://learn.microsoft.com/en-us/defender-endpoint/mde-security-settings-management"
    },
    {
      "type": "multiple_choice",
      "image": "Images/hotspot84.png",
      "question": "You have a Microsoft Sentinel workspace that contains a custom workbook named Workbook1.\n\nYou need to create a visual based on the SecurityEvent table. The solution must meet the following requirements:\n\n• Identify the number of security events ingested during the past week.\n• Display the count of events by day in a timechart.\n\nWhat should you add to Workbook1?",
      "options": [
        "A. a query",
        "B. a metric",
        "C. a group",
        "D. links or tabs"
      ],
      "answer": [
        "A"
      ],
      "explanation": "To visualize data in Microsoft Sentinel workbooks—such as counting SecurityEvents over time—you must use a Kusto Query Language (KQL) query. Queries allow you to retrieve and analyze the required log data, and then render it using visualization controls like timecharts.\n\nMetrics and groups are not applicable for this type of log analytics visualization, and links/tabs are used for navigation, not analysis.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/visualize-workbooks#add-visualizations-to-workbooks"
    },
    {
      "type": "multiple_choice",
      "question": "You have an Azure subscription.\n\nYou need to stream the Microsoft Graph activity logs to a third-party security information and event management (SIEM) tool. The solution must minimize administrative effort.\n\nTo where should you stream the logs?",
      "options": [
        "A. an Azure Event Hubs namespace",
        "B. an Azure Storage account",
        "C. an Azure Event Grid namespace",
        "D. a Log Analytics workspace"
      ],
      "answer": [
        "A"
      ],
      "explanation": "To stream Microsoft Graph activity logs to a third-party SIEM tool with minimal administrative overhead, you should use **Azure Event Hubs**. Event Hubs provides a scalable, low-latency, and cost-effective method for integrating Azure services with external SIEMs.\n\nThis setup allows Microsoft Graph activity logs to be streamed in near real-time to SIEM solutions, making Event Hubs the optimal choice.\n\nReference: https://techcommunity.microsoft.com/t5/microsoft-entra-blog/microsoft-graph-activity-logs-is-now-generally-available/ba-p/4094535"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 subscription that uses Microsoft Defender for Endpoint Plan 2 and contains 500 Windows devices.\n\nAs part of an incident investigation, you identify the following suspected malware files:\n\n• File1.sys\n• File2.pdf\n• File3.docx\n• File4.xlsx\n\nYou need to create indicator hashes to block users from downloading the files to the devices.\n\nWhich files can you block by using the indicator hashes?",
      "options": [
        "A. File1.sys only",
        "B. File1.sys and File3.docx only",
        "C. File1.sys, File3.docx, and File4.xlsx only",
        "D. File2.pdf, File3.docx, and File4.xlsx only",
        "E. File1.sys, File2.pdf, File3.docx, and File4.xlsx"
      ],
      "answer": [
        "E"
      ],
      "explanation": "Microsoft Defender for Endpoint Plan 2 supports blocking files through indicator hashes (such as SHA-256) for a variety of file types including `.sys`, `.pdf`, `.docx`, and `.xlsx`. When you create a file indicator of compromise (IOC) using a hash, Defender can block all these file types from being downloaded or executed on protected devices.\n\nReference: https://learn.microsoft.com/en-us/defender-endpoint/indicator-file"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 subscription that uses Microsoft Defender for Endpoint and contains a user named User1 and a Microsoft 365 group named Group1. All users are assigned a Defender for Endpoint Plan 1 license.\n\nYou enable Microsoft Defender XDR Unified role-based access control (RBAC) for Endpoints & Vulnerability Management.\n\nYou need to ensure that User1 can configure alerts that will send email notifications to Group1. The solution must follow the principle of least privilege.\n\nWhich permissions should you assign to User1?",
      "options": [
        "A. Defender Vulnerability Management - Remediation handling",
        "B. Alerts investigation",
        "C. Live response capabilities: Basic",
        "D. Manage security settings"
      ],
      "answer": [
        "C"
      ],
      "explanation": "To configure email notifications for alerts in Microsoft Defender for Endpoint, the minimum required permission is **Live response capabilities: Basic**. This permission includes the ability to configure and manage email alert settings while adhering to the principle of least privilege.\n\nReference: https://learn.microsoft.com/en-us/defender-xdr/configure-email-notifications"
    },
    {
      "type": "multiple_choice",
      "question": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.\n\nAfter you answer a question in this section, you will NOT be able to return to it. As a result, these questions will not appear in the review screen.\n\nYou have an Azure subscription that uses Microsoft Defender XDR.\n\nFrom the Microsoft Defender portal, you perform an audit search and export the results as a file named File1.csv that contains 10,000 rows.\n\nYou use Microsoft Excel to perform Get & Transform Data operations to parse the AuditData column from File1.csv. The operations fail to generate columns for specific JSON properties.\n\nYou need to ensure that Excel generates columns for the specific JSON properties in the audit search results.\n\nSolution: From Excel, you apply filters to the existing columns in File1.csv to reduce the number of JSON properties, and then you perform the Get & Transform Data operations to parse the AuditData column.\n\nDoes this meet the requirement?",
      "options": [
        "A. Yes",
        "B. No"
      ],
      "answer": [
        "A"
      ],
      "explanation": "Yes, filtering the existing columns in File1.csv to reduce the number of JSON properties before applying Get & Transform operations in Excel can help mitigate parsing issues. When parsing large datasets with complex JSON in Power Query, reducing the data scope improves reliability and allows Excel to properly extract and structure the data into columns.\n\nReference: https://learn.microsoft.com/en-us/purview/audit-log-export-records#step-2-format-the-exported-audit-log-using-the-power-query-editor"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 E5 subscription that contains two users named User1 and User2 and uses Microsoft Copilot for Security.\n\nFrom the Copilot for Security portal, User1 starts a session and creates the following prompts:\n\n• Prompt1: Provides access to the Entra plugin\n• Prompt2: Provides access to the Intune plugin\n• Prompt3: Provides access to the Entra plugin\n\nUser1 shares the session with User2.\n\nUser2 does NOT have access to Microsoft Intune.\n\nFor which prompts can User2 view results during the shared session?",
      "options": [
        "A. Prompt1 only",
        "B. Prompt1 and Prompt2 only",
        "C. Prompt3 only",
        "D. Prompt1 and Prompt3 only",
        "E. Prompt1, Prompt2, and Prompt3"
      ],
      "answer": [
        "E"
      ],
      "explanation": "When a session is shared in Microsoft Copilot for Security, the permissions and plugin access are based on the session owner's permissions, not the viewer's. This means that even if User2 does not have access to Intune, they can view the results of prompts that use the Intune plugin because User1, the session owner, does have access.\n\n**Therefore, User2 can view results from Prompt1, Prompt2, and Prompt3.**\n\nReference: https://learn.microsoft.com/en-us/copilot/security/authentication?tabs=entra-id#shared-sessions"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 E5 subscription that uses Microsoft Copilot for Security. Copilot for Security has the default settings configured.\n\nYou need to ensure that a user named User can use Copilot for Security to perform the following tasks:\n\n• Upload files.\n• View the usage dashboard.\n• Share promptbooks with all users.\n\nThe solution must follow the principle of least privilege.\n\nWhich role should you assign to User?",
      "options": [
        "A. Copilot owner",
        "B. Cloud Application Administrator",
        "C. Security Administrator",
        "D. Copilot Contributor"
      ],
      "answer": [
        "A"
      ],
      "explanation": "The **Copilot owner** role provides full administrative capabilities for Microsoft Copilot for Security, including the ability to:\n- Upload files\n- View the usage dashboard\n- Share promptbooks with all users\n\nThis role satisfies all the specified requirements while adhering to the principle of least privilege, since other roles like **Copilot Contributor** do not provide access to administrative dashboards or organization-wide sharing capabilities.\n\nReference: https://learn.microsoft.com/en-us/copilot/security/authentication#assign-roles"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 E5 subscription.\n\nYou have a PowerShell script that queries the unified audit log.\n\nYou discover that the query returns only the first page of results due to server-side paging.\n\nYou need to ensure that you get all the results.\n\nWhich property should you query in the results?",
      "options": [
        "A. @odata.context",
        "B. @odata.count",
        "C. @odata.nextLink",
        "D. @odata.deltaLink"
      ],
      "answer": [
        "C"
      ],
      "explanation": "The **@odata.nextLink** property is used in Microsoft Graph server-side paging to indicate that additional results are available. When a response includes this property, you must use its URL value to retrieve the next page of results. This ensures that you continue fetching data until all records are retrieved.\n\nReferences: https://learn.microsoft.com/en-us/graph/paging?tabs=javascript#server-side-paging"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 E5 subscription that contains two groups named Group1 and Group2 and uses Microsoft Copilot for Security.\n\nYou need to configure Copilot for Security role assignments to meet the following requirements:\n\n• Ensure that members of Group1 can run prompts and respond to Microsoft Defender XDR security incidents.\n• Ensure that members of Group2 can run prompts.\n• Follow the principle of least privilege.\n\nYou remove Everyone from the Copilot Contributor role.\n\nWhich two actions should you perform next? Each correct answer presents part of the solution.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "A. Assign the Security Operator role to Group1.",
        "B. Assign the Copilot Owner role to Group2.",
        "C. Assign the Copilot Owner role to Group1.",
        "D. Assign the Security Operator role to Group2.",
        "E. Assign the Copilot Contributor role to Group2."
      ],
      "answer": [
        "A",
        "E"
      ],
      "explanation": "To fulfill the requirements:\n\n- **Group1** needs to run prompts and also respond to Microsoft Defender XDR incidents, which requires assigning them the **Security Operator** role.\n- **Group2** only needs to run prompts. Therefore, they should be assigned the **Copilot Contributor** role, which grants permissions to initiate and use Copilot features.\n\nThis solution respects the principle of least privilege.\n\nReference: https://learn.microsoft.com/en-us/copilot/security/authentication#assign-roles"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 E5 subscription that contains a database server named DB1. DB1 is onboarded to Microsoft Defender XDR.\n\nYou need to ensure that DB1 appears on the attack surface map.\n\nWhat should you configure?",
      "options": [
        "A. an asset rule",
        "B. a critical asset rule",
        "C. a sensitive entity tag",
        "D. a honeytoken entity tag"
      ],
      "answer": [
        "B"
      ],
      "explanation": "To ensure that an entity such as DB1 appears on the **attack surface map** in Microsoft Defender XDR, you must configure it as a **critical asset**.\n\nEntities tagged as critical assets are prioritized in investigations and surfaced in visualizations such as the attack surface map, helping security teams quickly focus on high-value targets.\n\nReference: https://learn.microsoft.com/en-us/defender-for-identity/entity-tags#defender-for-identity-entity-tags-in-microsoft-defender-xdr"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 E5 subscription.\n\nYou need to configure Microsoft Defender XDR automatic attack disruption to use signals generated by Microsoft Defender for Cloud Apps.\n\nWhich two actions should you perform for Defender for Cloud Apps in the Microsoft Defender portal? Each correct answer presents part of the solution.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "A. Enable the Microsoft 365 connector.",
        "B. Add a log collector for automatic log upload.",
        "C. Turn on app governance.",
        "D. Deploy Cloud Discovery user enrichment.",
        "E. From Information protection, enable file monitoring."
      ],
      "answer": [
        "A",
        "C"
      ],
      "explanation": "To enable Microsoft Defender XDR automatic attack disruption with signals from Microsoft Defender for Cloud Apps, the following steps are required:\n\n- **A. Enable the Microsoft 365 connector**: This allows Defender for Cloud Apps to integrate with Microsoft 365 services and forward signals to Microsoft Defender XDR.\n- **C. Turn on app governance**: App governance provides enhanced visibility and control over OAuth-enabled apps and is a required component for attack disruption signal enrichment.\n\nReference: https://learn.microsoft.com/en-us/defender-xdr/configure-attack-disruption#microsoft-defender-for-cloud-apps-prerequisites"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 E5 subscription that contains the users shown in the following table.\n\n| Name  | Role                                |\n|-------|-------------------------------------|\n| User1 | Global Administrator                |\n| User2 | Global Secure Access Administrator  |\n| User3 | Privileged Role Administrator       |\n\nYou configure Microsoft Entra Internet Access.\n\nWhich users can manage Microsoft Entra Internet Access?",
      "options": [
        "A. User1 only",
        "B. User2 only",
        "C. User3 only",
        "D. User1 and User2 only",
        "E. User1, User2 and User3"
      ],
      "answer": [
        "D"
      ],
      "explanation": "Microsoft Entra Internet Access can be managed by users who hold either the **Global Administrator** or the **Global Secure Access Administrator** roles. These roles provide access to Microsoft Entra Internet Access configuration and monitoring features. The **Privileged Role Administrator** role does not grant access to manage Entra Internet Access settings.\n\nReference: https://learn.microsoft.com/en-us/entra/id/global-secure-access/internet-access/how-to-configure"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 E5 subscription.\n\nYou need to search the Microsoft Purview audit log by using PowerShell on a Windows device.\n\nWhat should you do first?",
      "options": [
        "A. Install the Microsoft Graph PowerShell module.",
        "B. Enable PowerShell remoting.",
        "C. Install the Microsoft Exchange Online PowerShell module.",
        "D. Modify the TrustedHosts list."
      ],
      "answer": [
        "C"
      ],
      "explanation": "To search the Microsoft Purview audit log using PowerShell, you must first install and connect using the **Microsoft Exchange Online PowerShell module**. This module provides access to audit log search cmdlets such as `Search-UnifiedAuditLog`, which are required for interacting with the audit log.\n\nReference: https://learn.microsoft.com/en-us/purview/audit-log-search-script"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 subscription that contains the following resources:\n\n• 100 users that are assigned a Microsoft 365 E5 license\n• 100 Windows 11 devices that are joined to the Microsoft Entra tenant\n\nThe users access their Microsoft Exchange Online mailbox by using Outlook on the web.\n\nYou need to ensure that if a user account is compromised, the Outlook on the web session token can be revoked. What should you configure?",
      "options": [
        "A. security defaults in Microsoft Entra",
        "B. Microsoft Entra Verified ID",
        "C. a Conditional Access policy in Microsoft Entra",
        "D. Microsoft Entra ID Protection"
      ],
      "answer": [
        "C"
      ],
      "explanation": "To revoke session tokens (such as for Outlook on the web) when a user account is compromised, you can configure a **Conditional Access policy in Microsoft Entra** based on user risk. This ensures that when risky user behavior is detected, access is blocked or sessions are revoked.\n\nReference: https://learn.microsoft.com/en-us/entra/id-protection/concept-identity-protection-policies#user-risk-based-conditional-access-policy"
    },
    {
      "type": "multiple_choice",
      "question": "You have an Azure subscription that uses Microsoft Defender for Cloud.\n\nYou need to configure Defender for Cloud to mitigate the following risks:\n\n• Vulnerabilities within the application source code\n• Exploitation toolkits in declarative templates\n• Operations from malicious IP addresses\n• Exposed secrets\n\nWhich two Defender for Cloud services should you use? Each correct answer presents part of the solution.\n\nNOTE: Each correct answer is worth one point.",
      "options": [
        "A. Microsoft Defender for Resource Manager",
        "B. Microsoft Defender for DNS",
        "C. Microsoft Defender for App Service",
        "D. Microsoft Defender for Servers",
        "E. Microsoft Defender for DevOps"
      ],
      "answer": [
        "A",
        "E"
      ],
      "explanation": "**Microsoft Defender for Resource Manager (A)** helps protect against threats such as exploitation toolkits in templates, operations from malicious IPs, and exposed secrets. It monitors management plane operations in real time.\n\n**Microsoft Defender for DevOps (E)** helps secure your development pipeline by identifying vulnerabilities within the application source code.\n\nReferences:\n- https://learn.microsoft.com/en-us/azure/defender-for-cloud/defender-for-resource-manager-introduction\n- https://learn.microsoft.com/en-us/azure/defender-for-cloud/defender-for-devops-introduction"
    },
    {
      "type": "multiple_choice",
      "question": "You have 500 on-premises devices.\n\nYou have a Microsoft 365 E5 subscription that uses Microsoft Defender 365.\n\nYou onboard 100 devices to Microsoft Defender 365.\n\nYou need to identify any unmanaged on-premises devices. The solution must ensure that only specific onboarded devices perform the discovery.\n\nWhat should you do first?",
      "options": [
        "A. Create a device group.",
        "B. Create an exclusion.",
        "C. Set Discovery mode to Basic.",
        "D. Create a tag."
      ],
      "answer": [
        "D"
      ],
      "explanation": "To ensure that **only specific onboarded devices perform discovery** of unmanaged devices, you must first **create a tag**. Tags allow you to define which onboarded devices are used for network discovery. Once devices are tagged, you can configure the discovery settings to apply only to those tagged devices.\n\nReference: https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/device-discovery-faq"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 E5 subscription that contains a device named Device1. Device1 is enrolled in Microsoft Defender for Endpoint.\n\nDevice1 reports an incident that includes a file named File1.exe as evidence.\n\nYou initiate the Collect Investigation Package action and download the ZIP file.\n\nYou need to identify the first and last time File1.exe was executed.\n\nWhat should you review in the investigation package?",
      "options": [
        "A. Processes",
        "B. Autoruns",
        "C. Security event log",
        "D. Scheduled tasks",
        "E. Prefetch files"
      ],
      "answer": [
        "E"
      ],
      "explanation": "The **Prefetch files** included in the investigation package can be used to determine when a specific executable, such as File1.exe, was first and last run on the system. Windows uses prefetching to speed up application launches, and the corresponding `.pf` files include timestamps related to execution.\n\n**Reference:** https://learn.microsoft.com/en-us/defender-endpoint/respond-machine-alerts#collect-investigation-package-from-devices"
    },
    {
      "type": "multiple_choice",
      "question": "You have an Azure subscription that has Microsoft Defender for Cloud enabled.\n\nYou have a virtual machine named Server1 that runs Windows Server 2022 and is hosted in Amazon Web Services (AWS).\n\nYou need to collect logs and resolve vulnerabilities for Server1 by using Defender for Cloud.\n\nWhat should you install first on Server1?",
      "options": [
        "A. the Microsoft Monitoring Agent",
        "B. the Azure Monitor agent",
        "C. the Azure Connected Machine agent",
        "D. the Azure Pipelines agent"
      ],
      "answer": [
        "C"
      ],
      "explanation": "To onboard non-Azure machines, such as AWS-hosted virtual machines, to Microsoft Defender for Cloud, you must first install the **Azure Connected Machine agent**. This agent enables Azure Arc for the server, allowing it to be managed and monitored in Azure, and integrated with Defender for Cloud services such as vulnerability assessment and log collection.\n\n**Reference:** https://learn.microsoft.com/en-us/azure/azure-arc/servers/onboard-service-principal"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 subscription that uses Microsoft Defender XDR.\n\nYou are investigating an attacker that is known to use the Microsoft Graph API as an attack vector. The attacker performs the tactics shown in the following table.\n\n| Name    | Tactic                                          |\n|---------|--------------------------------------------------|\n| Tactic1 | Conditional Access policy reconnaissance         |\n| Tactic2 | Mailbox reconnaissance                           |\n| Tactic3 | Invites guest users to the tenant                |\n\nYou need to search for malicious activities in your organization.\n\nWhich tactics can you analyze by using the MicrosoftGraphActivityLogs table?",
      "options": [
        "A. Tactic2 only",
        "B. Tactic1 and Tactic2 only",
        "C. Tactic2 and Tactic3 only",
        "D. Tactic1, Tactic2, and Tactic3"
      ],
      "answer": [
        "D"
      ],
      "explanation": "The **MicrosoftGraphActivityLogs** table provides visibility into Microsoft Graph API calls made to your Microsoft 365 environment. This includes a wide range of activities such as conditional access policy enumeration (Tactic1), mailbox content access (Tactic2), and user management activities like guest invitations (Tactic3). All these actions are logged when executed via Graph API, allowing for comprehensive threat detection and investigation.\n\n**Reference**: https://learn.microsoft.com/en-us/graph/microsoft-graph-activity-logs-overview"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 subscription that uses Microsoft Defender for Endpoint Plan 2 and contains 500 Windows devices.\n\nYou plan to create a Microsoft Defender XDR custom deception rule.\n\nYou need to ensure that the rule will be applied to only 10 specific devices.\n\nWhat should you do first?",
      "options": [
        "A. Add custom lures to the rule.",
        "B. Add the IP address of each device to the list of decoy accounts and hosts of the rule.",
        "C. Add the devices to a group.",
        "D. Assign a tag to the devices."
      ],
      "answer": [
        "D"
      ],
      "explanation": "To apply a Microsoft Defender XDR deception rule to a subset of devices, such as 10 specific Windows devices, the recommended approach is to **assign a tag** to those devices. Tags allow you to scope custom deception rules to only apply to devices with matching tags, ensuring targeted and precise deployment of deception lures.\n\nReference: https://learn.microsoft.com/en-us/defender-xdr/configure-deception"
    },
    {
      "type": "multiple_choice",
      "question": "You have an Azure subscription named Sub1 that uses Microsoft Defender for Cloud.\nYou need to assign the PCI DSS 4.0 initiative to Sub1 and have the initiative displayed in the Defender for Cloud Regulatory compliance dashboard.\n\nFrom Security policies in the Environment settings, you discover that the option to add more industry and regulatory standards is unavailable.\n\nWhat should you do first?",
      "options": [
        "A. Configure the Continuous export settings for Log Analytics.",
        "B. Enable the Cloud Security Posture Management (CSPM) plan for the subscription.",
        "C. Configure the Continuous export settings for Azure Event Hubs.",
        "D. Disable the Microsoft Cloud Security Benchmark (MCSB) assignment."
      ],
      "answer": "B. Enable the Cloud Security Posture Management (CSPM) plan for the subscription.",
      "explanation": "To enable the ability to assign and display additional regulatory compliance standards, such as PCI DSS 4.0, in the Defender for Cloud dashboard, you must first enable the **Cloud Security Posture Management (CSPM)** plan. This plan allows Defender for Cloud to assess your environment against multiple standards and display them in the Regulatory compliance dashboard.\n\nReference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/concept-cloud-security-posture-management"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft Sentinel workspace named SW1.\n\nYou need to identify which anomaly rules are enabled in SW1.\n\nWhat should you review in Microsoft Sentinel?",
      "options": [
        "A. Content hub",
        "B. Entity behavior",
        "C. Analytics",
        "D. Settings"
      ],
      "answer": [
        "C"
      ],
      "explanation": "To determine which anomaly rules are enabled in a Microsoft Sentinel workspace, you should go to the **Analytics** section. From there, you can view and manage analytic rules, including anomaly-based rules used for detecting unusual activity.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/work-with-anomaly-rules"
    },
    {
      "type": "multiple_choice",
      "question": "You have an Azure subscription that contains a Microsoft Sentinel workspace named WS1.\n\nYou create a hunting query that detects a new attack vector. The attack vector maps to a tactic listed in the MITRE ATT&CK database.\n\nYou need to ensure that an incident is created in WS1 when the new attack vector is detected.\n\nWhat should you configure?",
      "options": [
        "A. a hunting livestream session",
        "B. a query bookmark",
        "C. a scheduled query rule",
        "D. a Fusion rule"
      ],
      "answer": [
        "C"
      ],
      "explanation": "To automatically generate incidents in Microsoft Sentinel when a specific condition—such as a new attack vector—is detected, you must create a **scheduled query rule**. Scheduled analytics rules continuously run your query on a defined schedule and generate alerts when conditions are met, which can then be escalated to incidents.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/tutorial-detect-threats-custom"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 E5 subscription that uses Microsoft Defender XDR.\n\nThe security team at your company detects command and control (C2) agent traffic on the network. Agents communicate once every 50 hours.\n\nYou need to create a Microsoft Defender XDR custom detection rule that will identify compromised devices and establish a pattern of communication. The solution must meet the following requirements:\n\n• Identify all the devices that have communicated during the past 14 days.\n• Minimize how long it takes to identify the devices.\n\nTo what should you set the detection frequency for the rule?",
      "options": [
        "A. Every 12 hours",
        "B. Every 24 hours",
        "C. Every three hours",
        "D. Every hour"
      ],
      "answer": [
        "A"
      ],
      "explanation": "To effectively identify devices that participate in periodic command and control (C2) traffic, such as once every 50 hours, you should schedule the custom detection rule to run every 12 hours. This frequency ensures timely detection while reducing overhead and aligning with the communication behavior.\n\nSetting the frequency too infrequently (e.g., every 24 hours) might delay detection, whereas running it too frequently (e.g., every hour) may consume unnecessary resources.\n\nReference: https://learn.microsoft.com/en-us/defender-xdr/custom-detection-rules"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 subscription that uses Microsoft Defender XDR.\n\nYou have a query that contains the following statements:\n\n```kusto\nunion DeviceEvents, DeviceProcessEvents\n| where ingestion_time() > ago(1d)\n... \n```\n\nYou need to configure a custom detection rule that will use the query. The solution must minimize how long it takes to be notified about events that match the query.\n\nWhich frequency should you select for the rule?",
      "options": [
        "A. Every hour",
        "B. Continuous (NRT)",
        "C. Every 12 hours",
        "D. Every 3 hours"
      ],
      "answer": [
        "A"
      ],
      "explanation": "Queries that use the `union` operator or certain functions such as `ingestion_time()` are **not supported for continuous (NRT)** custom detection rules in Microsoft Defender XDR.\n\nTo minimize the notification delay while ensuring compatibility, you should select a frequency of **Every hour**, which is the most frequent option supported for this type of query.\n\nReference: https://learn.microsoft.com/en-us/defender-xdr/custom-detection-rules#queries-you-can-run-continuously"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 E5 subscription.\n\nYou have the following KQL query:\n\nDeviceProcessEvents\n| where ProcessCommandLine has \"attrib +h +s +r \" and ProcessCommandLine contains \".class\"\n| project ReportId, ActionType, DeviceName, InitiatingProcessAccountName\n\nYou need to use the query to create a Microsoft Defender XDR custom detection rule that can isolate an onboarded device.\n\nHow should you modify the query?",
      "options": [
        "A. Add the AccountUpn and Timestamp columns to the project operator.",
        "B. Add a distinct operator.",
        "C. Add a summarize operator.",
        "D. Add the DeviceId and Timestamp columns to the project operator."
      ],
      "answer": [
        "D"
      ],
      "explanation": "To enable **device isolation** as an action in a Microsoft Defender XDR custom detection rule, the query must return both the **DeviceId** and **Timestamp** fields.\n\nThese fields allow the detection rule engine to identify the exact device and time of the suspicious event, which is necessary for applying response actions like isolation.\n\nReference: https://learn.microsoft.com/en-us/defender-xdr/custom-detection-rules#actions-on-devices"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 E5 subscription.\n\nYou need to ensure that an alert is generated in Microsoft Defender XDR when attackers attempt to connect to a specific device. The solution must minimize administrative effort.\n\nWhat should you do in the Microsoft Defender portal?",
      "options": [
        "A. Create a deception rule that includes a decoy.",
        "B. Tag an existing device as a honeytoken entity.",
        "C. Create a deception rule that includes a lure.",
        "D. Tag an existing device as a sensitive entity."
      ],
      "answer": [
        "B"
      ],
      "explanation": "To generate alerts when attackers attempt to interact with specific high-value or decoy assets, you can tag those assets as **honeytoken entities**. This configuration requires minimal administrative effort and triggers alerts in Microsoft Defender XDR when those devices are accessed or scanned.\n\nReference: https://learn.microsoft.com/en-us/defender-for-identity/entity-tags#defender-for-identity-entity-tags-in-microsoft-defender-xdr"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 E5 subscription that contains a Microsoft SharePoint Online site named Site1.\n\nYou need to enable Microsoft Defender for Cloud Apps session control for Site1.\n\nWhich type of policy should you create first?",
      "options": [
        "A. access",
        "B. session",
        "C. app governance",
        "D. Conditional Access"
      ],
      "answer": [
        "D"
      ],
      "explanation": "To enable Microsoft Defender for Cloud Apps session control for a specific application like SharePoint Online, you must first configure a **Conditional Access** policy. This policy routes user sessions through Microsoft Defender for Cloud Apps, allowing you to apply real-time monitoring and controls.\n\nReference: https://learn.microsoft.com/en-us/defender-cloud-apps/session-policy-aad#create-a-conditional-access-policy"
    },
    {
      "type": "multiple_choice",
      "question": "You have an Azure subscription that uses Microsoft Sentinel.\n\nYou need to minimize the administrative effort required to respond to the incidents and remediate the security threats detected by Microsoft Sentinel.\n\nWhich two features should you use? Each correct answer presents part of the solution.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "A. Microsoft Sentinel workbooks",
        "B. Azure Automation runbooks",
        "C. Microsoft Sentinel automation rules",
        "D. Microsoft Sentinel playbooks",
        "E. Azure Functions apps"
      ],
      "answer": [
        "C",
        "D"
      ],
      "explanation": "**Microsoft Sentinel automation rules** (C) help reduce manual work by automatically managing incident creation, classification, assignment, and closing based on customizable rules.\n\n**Microsoft Sentinel playbooks** (D) are built on Azure Logic Apps and enable you to automate responses to incidents, such as blocking users or disabling accounts, with little to no human intervention.\n\nTogether, automation rules and playbooks significantly reduce the time and effort needed for incident response and threat remediation.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/automate-incident-handling-with-automation-rules"
    },
    {
      "type": "multiple_choice",
      "question": "You have an Azure subscription that contains a user named User1 and a Microsoft Sentinel workspace named WS1. WS1 uses Microsoft Defender for Cloud.\n\nYou have the Microsoft security analytics rules shown in the following table.\n\n| Name  | Service             | Severity | Action          |\n|-------|---------------------|----------|------------------|\n| Rule1 | Defender for Cloud  | High     | Create incident  |\n| Rule2 | Defender for Cloud  | High     | Create incident  |\n| Rule3 | Defender for Cloud  | High     | Create incident  |\n| Rule4 | Defender for Cloud  | High     | Create incident  |\n\nUser1 performs an action that matches Rule1, Rule2, Rule3, and Rule4.\n\nHow many incidents will be created in WS1?",
      "options": [
        "A. 1",
        "B. 2",
        "C. 3",
        "D. 4"
      ],
      "answer": [
        "D"
      ],
      "explanation": "In Microsoft Sentinel, each analytic rule that is configured to create incidents will trigger its own incident when matched. Since all four rules (Rule1 through Rule4) are configured to create incidents independently and User1 triggers all four, **four separate incidents** will be created.\n\nUnlike Microsoft Defender XDR, Sentinel does not automatically correlate alerts from different analytics rules into a single incident unless custom logic is implemented.\n\nReference: https://learn.microsoft.com/en-us/defender-xdr/alerts-incidents-correlation"
    },
    {
      "type": "multiple_choice",
      "question": "You have an on-premises network.\n\nYou have a Microsoft 365 E5 subscription that uses Microsoft Defender for Identity.\n\nFrom the Microsoft Defender portal, you investigate an incident on a device named Device1 of a user named User1. The incident contains the following Defender for Identity alert:\n\n**Suspected identity theft (pass-the-ticket) (external ID 2018)**\n\nYou need to contain the incident without affecting users and devices. The solution must minimize administrative effort.\n\nWhat should you do?",
      "options": [
        "A. Disable User1 only.",
        "B. Quarantine Device1 only.",
        "C. Reset the password for all the accounts that previously signed in to Device1.",
        "D. Disable User1 and quarantine Device1.",
        "E. Disable User1, quarantine Device1, and reset the password for all the accounts that previously signed in to Device1."
      ],
      "answer": [
        "E"
      ],
      "explanation": "When investigating a suspected identity theft incident such as **pass-the-ticket**, a comprehensive response is required to mitigate lateral movement and prevent further credential misuse:\n\n- **Disable User1** to stop further misuse of stolen credentials.\n- **Quarantine Device1** to isolate the source of compromise and prevent additional compromise.\n- **Reset the passwords for all accounts that previously signed in to Device1**, as their session tickets or credentials may have been compromised.\n\nThis multi-step response ensures containment and reduces the likelihood of further compromise, aligning with guidance for identity threat containment.\n\nReference: https://learn.microsoft.com/en-us/microsoft-365-app-certification/docs/seg2_ops"
    },
    {
      "type": "multiple_choice",
      "question": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.\n\nAfter you answer a question in this section, you will NOT be able to return to it. As a result, these questions will not appear in the review screen.\n\nYou have an Azure subscription that uses Microsoft Defender XDR.\n\nFrom the Microsoft Defender portal, you perform an audit search and export the results as a file named File1.csv that contains 10,000 rows.\n\nYou use Microsoft Excel to perform Get & Transform Data operations to parse the AuditData column from File1.csv. The operations fail to generate columns for specific JSON properties.\n\nYou need to ensure that Excel generates columns for the specific JSON properties in the audit search results.\n\nSolution: From Defender, you modify the search criteria of the audit search to increase the number of returned records, and then you export the results. From Excel, you perform the Get & Transform Data operations by using the new export.\n\nDoes this meet the requirement?",
      "options": [
        "A. Yes",
        "B. No"
      ],
      "answer": [
        "B"
      ],
      "explanation": "Increasing the number of returned records in the audit search does not address the root cause of the issue. The issue lies in Excel’s ability to parse JSON within the `AuditData` column using Power Query.\n\nTo resolve this, you should load a smaller dataset (e.g., 500–1000 rows) to ensure Power Query can properly parse nested JSON structures. Once verified, you can scale up with additional filtering techniques.\n\n**Reference**: https://learn.microsoft.com/en-us/purview/audit-log-export-records"
    },
    {
      "type": "multiple_choice",
      "question": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.\n\nAfter you answer a question in this section, you will NOT be able to return to it. As a result, these questions will not appear in the review screen.\n\nYou have an Azure subscription that uses Microsoft Defender XDR.\n\nFrom the Microsoft Defender portal, you perform an audit search and export the results as a file named File1.csv that contains 10,000 rows.\n\nYou use Microsoft Excel to perform Get & Transform Data operations to parse the AuditData column from File1.csv. The operations fail to generate columns for specific JSON properties.\n\nYou need to ensure that Excel generates columns for the specific JSON properties in the audit search results.\n\nSolution: From Excel, you apply filters to the existing columns in File1.csv to reduce the number of rows, and then you perform the Get & Transform Data operations to parse the AuditData column.\n\nDoes this meet the requirement?",
      "options": [
        "A. Yes",
        "B. No"
      ],
      "answer": [
        "A"
      ],
      "explanation": "Filtering rows in Excel before parsing the `AuditData` column does not change the structure or content of the JSON data that Power Query is trying to interpret. The issue typically stems from Excel's inability to handle deeply nested or complex JSON structures, not the number of rows. To ensure Excel can parse the JSON properties, you must pre-process or simplify the JSON data structure using smaller exports or additional transformations.\n\n**Reference**: https://learn.microsoft.com/en-us/purview/audit-log-export-records"
    },
    {
      "type": "multiple_choice",
      "question": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.\n\nAfter you answer a question in this section, you will NOT be able to return to it. As a result, these questions will not appear in the review screen.\n\nYou have an Azure subscription that uses Microsoft Defender XDR.\n\nFrom the Microsoft Defender portal, you perform an audit search and export the results as a file named File1.csv that contains 10,000 rows.\n\nYou use Microsoft Excel to perform Get & Transform Data operations to parse the AuditData column from File1.csv. The operations fail to generate columns for specific JSON properties.\n\nYou need to ensure that Excel generates columns for the specific JSON properties in the audit search results.\n\nSolution: From Defender, you modify the search criteria of the audit search to reduce the number of returned records, and then you export the results. From Excel, you perform the Get & Transform Data operations by using the new export.\n\nDoes this meet the requirement?",
      "options": [
        "A. Yes",
        "B. No"
      ],
      "answer": [
        "A"
      ],
      "explanation": "Reducing the number of returned records in the audit search can help improve the performance and parsing accuracy of Microsoft Excel's Get & Transform Data feature (Power Query), especially when working with large and complex JSON structures in the AuditData column. Exporting a smaller dataset increases the chances that Excel can successfully parse and convert the JSON into columns.\n\nReference: https://learn.microsoft.com/en-us/purview/audit-log-export-records"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 E5 subscription.\n\nAutomated investigation and response (AIR) is enabled in Microsoft Defender for Office 365 and devices use full automation in Microsoft Defender for Endpoint.\n\nYou have an incident involving a user that received malware-infected email messages on a managed device.\n\nWhich action requires manual remediation of the incident?",
      "options": [
        "A. soft deleting the email message",
        "B. hard deleting the email message",
        "C. isolating the device",
        "D. containing the device"
      ],
      "answer": [
        "C"
      ],
      "explanation": "In Microsoft Defender for Endpoint with full automation enabled, several actions can be performed automatically to remediate threats, including file quarantines and blocking malicious entities. However, **device isolation** must be initiated manually, even in a fully automated environment.\n\nIn contrast, email actions like soft and hard deleting messages can be automated through Defender for Office 365's AIR capabilities.\n\nReferences:\n- https://learn.microsoft.com/en-us/defender-office-365/remediate-malicious-email-delivered-office-365\n- https://learn.microsoft.com/en-us/defender-endpoint/manage-auto-investigation#remediation-actions\n- https://learn.microsoft.com/en-us/defender-endpoint/respond-machine-alerts"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 subscription that uses Microsoft Defender XDR and contains a Windows device named Device1.\n\nThe timeline of Device1 includes three files named File1.ps1, File2.exe, and File3.dll.\n\nYou need to submit files for deep analysis in Microsoft Defender XDR.\n\nWhich files can you submit?",
      "options": [
        "A. File1.ps1 only",
        "B. File2.exe only",
        "C. File3.dll only",
        "D. File2.exe and File3.dll only",
        "E. File1.ps1 and File2.exe only",
        "F. File1.ps1, File2.exe, and File3.dll"
      ],
      "answer": [
        "D"
      ],
      "explanation": "Microsoft Defender XDR allows deep analysis submissions for **.exe**, **.dll**, and **.msi** files. Script files such as **.ps1** (PowerShell scripts) are not eligible for deep analysis submission.\n\nTherefore, of the three files listed (File1.ps1, File2.exe, and File3.dll), only **File2.exe** and **File3.dll** are eligible for submission for deep analysis.\n\nReference: https://learn.microsoft.com/en-us/defender-endpoint/respond-file-alerts#deep-analysis"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 subscription that uses Microsoft Defender XDR.\n\nYou need to identify all the entities affected by an incident.\n\nWhich tab should you use in the Microsoft Defender portal?",
      "options": [
        "A. Investigations",
        "B. Assets",
        "C. Evidence and Response",
        "D. Alerts"
      ],
      "answer": [
        "C"
      ],
      "explanation": "To identify all the entities (such as devices, users, files, and emails) affected by an incident in Microsoft Defender XDR, you should use the **Evidence and Response** tab in the Microsoft Defender portal. This tab consolidates all associated artifacts related to the incident and allows security teams to review and respond accordingly.\n\nReference: https://learn.microsoft.com/en-us/microsoft-365/security/defender/incidents-overview#evidence-and-response-tab"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 subscription that uses Microsoft Defender XDR.\n\nYou are investigating an attacker that is known to use the Microsoft Graph API as an attack vector. The attacker performs the tactics shown in the following table:\n\n| Name    | Tactic                                                                 |\n|---------|------------------------------------------------------------------------|\n| Tactic1 | Discovers misconfigured mailboxes                                      |\n| Tactic2 | Searches Microsoft Teams chats and exports full conversations          |\n| Tactic3 | Deletes Azure virtual machines                                         |\n\nYou need to search for malicious activities in your organization.\n\nWhich tactics can you analyze by using the MicrosoftGraphActivityLogs table?",
      "options": [
        "A. Tactic1 only",
        "B. Tactic2 only",
        "C. Tactic1 and Tactic3 only",
        "D. Tactic2 and Tactic3 only",
        "E. Tactic1, Tactic2, and Tactic3"
      ],
      "answer": [
        "E"
      ],
      "explanation": "The **MicrosoftGraphActivityLogs** table captures detailed activity data related to Graph API usage, making it valuable for identifying a wide range of attack tactics. \n\n- **Tactic1** (Mailbox discovery): Graph API calls to mailbox settings or permissions can be tracked.\n- **Tactic2** (Teams chats): Graph API access to Teams messages and export operations are recorded.\n- **Tactic3** (VM deletions): Azure resource manipulations via Graph API are also logged.\n\nThis comprehensive coverage allows analysts to trace and investigate all of the mentioned tactics using the MicrosoftGraphActivityLogs table.\n\nReference: https://learn.microsoft.com/en-us/azure/azure-monitor/reference/tables/microsoftgraphactivitylogs"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft Sentinel workspace named SW1.\n\nIn SW1, you investigate an incident that is associated with the following entities:\n\n• Host\n• IP address\n• User account\n• Malware name\n\nWhich entity can be labeled as an indicator of compromise (IoC) directly from the incident's page?",
      "options": [
        "A. malware name",
        "B. host",
        "C. user account",
        "D. IP address"
      ],
      "answer": [
        "D"
      ],
      "explanation": "In Microsoft Sentinel, you can label certain entities as Indicators of Compromise (IoCs) directly from the incident page. Of the listed options, only **IP addresses** can be added as threat intelligence indicators (IoCs) from the incident view. Other entities like user accounts or malware names are not supported for this direct labeling method.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/add-entity-to-threat-intelligence?tabs=incidents#add-an-entity-to-your-threat-intelligence"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 subscription that uses Microsoft Defender for Endpoint and contains the devices shown in the following table.\n\n| Name    | Operating system |\n|---------|------------------|\n| Device1 | Windows          |\n| Device2 | Windows          |\n| Device3 | Linux            |\n| Device4 | macOS            |\n\nYou initiate a live response session on each device.\n\nYou need to collect a Defender for Endpoint investigation package from each device.\n\nOn which devices can you collect the package by running advanced live response commands from the command-line interface (CLI)?",
      "options": [
        "A. Device1 and Device2 only",
        "B. Device1, Device2, and Device3 only",
        "C. Device3 and Device4 only",
        "D. Device1, Device2, Device3, and Device4"
      ],
      "answer": [
        "C"
      ],
      "explanation": "Advanced live response commands from the CLI for collecting investigation packages are supported on non-Windows platforms such as Linux and macOS. On Windows, live response capabilities are typically accessed through the Defender for Endpoint portal rather than CLI. \n\n**Device3 (Linux)** and **Device4 (macOS)** support live response commands via CLI.\n\nReference: https://learn.microsoft.com/en-us/defender-endpoint/live-response"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft Sentinel workspace.\n\nYou are investigating an incident that involves multiple alerts, events, and entities.\n\nYou need to create a bookmark for the investigation. The solution must minimize administrative effort.\n\nWhich settings should you use?",
      "options": [
        "A. Incidents",
        "B. Hunting",
        "C. Content hub",
        "D. Logs"
      ],
      "answer": [
        "B"
      ],
      "explanation": "To create a bookmark related to an investigation in Microsoft Sentinel, the **Hunting** section is the recommended setting. This allows analysts to bookmark interesting findings during threat hunting activities, and optionally link the bookmark to an existing incident to facilitate further investigation and tracking.\n\nThis approach is efficient and minimizes administrative effort because it integrates directly into the investigation flow.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/bookmarks#add-bookmarks-to-a-new-or-existing-incident"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 E5 subscription that contains a device named Device1.\n\nFrom the Microsoft Defender portal, you discover that an alert was triggered for Device1.\n\nFrom the Device inventory page, you isolate Device1.\n\nYou need to collect a list of installed programs on Device1.\n\nWhat should you do?",
      "options": [
        "A. Run an advanced hunting query against the DeviceProcessEvents table.",
        "B. Run an advanced hunting query against the DeviceTvmSoftwareInventory table.",
        "C. Initiate an automated investigation and view the results in the Action center.",
        "D. Initiate a live response session and run the processes command."
      ],
      "answer": [
        "B"
      ],
      "explanation": "To collect a list of installed programs on a device in Microsoft Defender XDR, you should query the **DeviceTvmSoftwareInventory** table using advanced hunting. This table provides visibility into installed software, including software name, version, vendor, and installation date.\n\nOption A relates to running process activity, not installed software.\nOption C helps in incident resolution but doesn’t directly return a software inventory.\nOption D (live response) can help investigate interactively, but the structured inventory data is best accessed through the TVM software inventory table.\n\nReference: https://learn.microsoft.com/en-us/defender-xdr/advanced-hunting-devicetvmsoftwareinventory-table"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 E5 subscription that contains a user named User1. The subscription uses Microsoft 365 Copilot for Security. Copilot for Security uses the Sentinel plugin.\n\nUser1 is assigned the Copilot Contributor role.\n\nDuring an investigation, User1 submits a prompt and receives a notification that Copilot for Security cannot respond to requests because the security compute unit (SCU) usage is nearing the provisioned capacity limit.\n\nYou need to ensure that User1 can use Copilot for Security to generate a successful response.\n\nWhat should User1 do?",
      "options": [
        "A. Wait one hour and resubmit the prompt.",
        "B. Update the provisioned SCUs.",
        "C. Run the Microsoft Sentinel Optimization Workbook.",
        "D. Open a second Copilot for Security session and submit the prompt."
      ],
      "answer": [
        "A"
      ],
      "explanation": "When Microsoft Copilot for Security reaches or nears its provisioned Security Compute Unit (SCU) capacity, users may experience delayed or rejected responses to prompts. The system automatically resets the quota hourly, so the best immediate action is to **wait one hour and resubmit the prompt**.\n\nUpgrading SCUs (option B) is an administrative task and not something a Copilot Contributor can perform.\nOption C is related to Microsoft Sentinel performance and isn't relevant here.\nOption D would still result in the same capacity error.\n\nReference: https://learn.microsoft.com/en-us/copilot/security/manage-usage"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft Sentinel workspace.\n\nYou are investigating an incident that involves the following entities:\n\n• A host named Host1\n• A user account named User1\n• An IP address of 175.45.176.99\n\nYou need to update the threat intelligence list to include the entities.\n\nWhich entities can you add on the Incident page?",
      "options": [
        "A. 175.45.176.99 only",
        "B. Host1 only",
        "C. User1 only",
        "D. 175.45.176.99 and Host1 only",
        "E. Host1 and User1 only",
        "F. 175.45.176.99, Host1, and User1"
      ],
      "answer": [
        "A"
      ],
      "explanation": "In Microsoft Sentinel, only specific entity types such as **IP addresses**, **file hashes**, **URLs**, and **domain names** can be added directly to the threat intelligence list from the Incident page. Entities like **hosts** and **user accounts** are not supported for direct inclusion in threat indicators.\n\nTherefore, among the listed entities, only the IP address `175.45.176.99` is valid for inclusion.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/understand-threat-intelligence"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 subscription that uses Microsoft Copilot for Security.\n\nYou create a promptbook named Book1.\n\nFor Book1, you need to create a prompt that contains an input named IncidentID.\n\nHow should you format IncidentID?",
      "options": [
        "A. <IncidentID>",
        "B. ##IncidentID##",
        "C. [IncidentID]",
        "D. $IncidentID$"
      ],
      "answer": [
        "A"
      ],
      "explanation": "In Microsoft Copilot for Security, when creating prompts in a promptbook, required inputs must be enclosed in angle brackets (`<>`). This allows the Copilot to identify the input as a variable to be filled during prompt execution.\n\nTherefore, to define an input named `IncidentID`, the correct format is `<IncidentID>`.\n\nReference: https://learn.microsoft.com/en-us/copilot/security/build-promptbooks#specify-any-required-input"
    },
    {
      "type": "multiple_choice",
      "question": "Your on-premises network contains an Active Directory Domain Services (AD DS) forest.\n\nYou have a Microsoft Entra tenant that uses Microsoft Defender for Identity. The AD DS forest syncs with the tenant.\n\nYou need to create a hunting query that will identify LDAP simple binds to the AD DS domain controllers.\n\nWhich table should you query?",
      "options": [
        "A. AADServicePrincipalRiskEvents",
        "B. AADDomainServicesAccountLogon",
        "C. SigninLogs",
        "D. IdentityLogonEvents"
      ],
      "answer": [
        "D"
      ],
      "explanation": "`IdentityLogonEvents` is the correct table used to query logon-related activities collected by Microsoft Defender for Identity, including LDAP simple binds on on-prem AD DS domain controllers. This table provides visibility into authentication methods and logon protocols within hybrid identity environments.\n\nOther tables listed relate to Azure AD sign-ins or risk detections but do not track LDAP binds on-prem.\n\nReference: https://learn.microsoft.com/en-us/azure/azure-monitor/reference/queries/identitylogonevents"
    },
    {
      "type": "multiple_choice",
      "question": "You have 500 on-premises Windows 11 devices that use Microsoft Defender for Endpoint.\nYou enable Network device discovery.\n\nYou need to create a hunting query that will identify discovered network devices and return the identity of the onboarded device that discovered each network device.\n\nWhich built-in function should you use?",
      "options": [
        "A. SeenBy()",
        "B. DeviceFromIP()",
        "C. next()",
        "D. current_cluster_endpoint()"
      ],
      "answer": [
        "A"
      ],
      "explanation": "`SeenBy()` is a built-in Kusto function in Microsoft Defender for Endpoint that returns the list of devices (sensors) that have observed a particular entity, such as a network device.\n\nIt is especially useful in scenarios where network discovery is enabled and you want to trace which onboarded device identified a network asset.\n\n`DeviceFromIP()` and `next()` serve unrelated purposes, and `current_cluster_endpoint()` is not applicable in this context.\n\nReference: https://learn.microsoft.com/en-us/defender-xdr/advanced-hunting-seenby-function"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 subscription that contains a user named User1 and two Windows devices named Device1 and Device2. Device1 and Device2 are onboarded to Microsoft Defender for Endpoint.\n\nThe following events occur:\n\n• User1 signs in to Device1.\n• Automatic attack disruption in Microsoft Defender XDR responds to an attack on Device1 and contains User1.\n• User1 attempts to connect to Device2.\n\nWhich protocols will Device2 block when User1 attempts to connect to Device2?",
      "options": [
        "A. RDP only",
        "B. RPC only",
        "C. SMB only",
        "D. RDP and RPC only",
        "E. SMB and RPC only",
        "F. RDP, RPC, and SMB"
      ],
      "answer": [
        "F"
      ],
      "explanation": "When a user is contained from the network using Microsoft Defender XDR's automatic attack disruption, the containment blocks the user from accessing other onboarded devices using **RDP, SMB, and RPC** protocols.\n\nThis ensures that lateral movement via commonly exploited administrative protocols is prevented.\n\nReference: https://learn.microsoft.com/en-us/defender-endpoint/respond-machine-alerts#contain-user-from-the-network"
    },
    {
      "type": "multiple_choice",
      "question": "You have an Azure subscription that contains a Microsoft Sentinel workspace named WS1. WS1 has the Azure Activity connector and the Microsoft Entra ID connector configured.\n\nYou need to investigate which accounts have the most alerts and any corresponding incident information for each alert. The solution must minimize administrative effort.\n\nWhat should you do first in WS1?",
      "options": [
        "A. Use User and Entity Behavior Analytics (UEBA) to detect anomalies.",
        "B. Enable User and Entity Behavior Analytics (UEBA).",
        "C. From Content hub, install the Microsoft Purview insider risk management solution.",
        "D. From Content hub, install Cloud Identity Threat Protection Essentials."
      ],
      "answer": [
        "B"
      ],
      "explanation": "Before using UEBA to detect anomalies and investigate alert patterns by account, you must **first enable UEBA** in the Microsoft Sentinel workspace. UEBA enriches account-related data and connects it to alerts and incidents, helping reduce manual correlation work.\n\nInstalling content hub solutions or using detection features before enabling UEBA won't provide enriched behavioral data.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/enable-entity-behavior-analytics"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 E5 subscription that uses Microsoft Copilot for Security.\n\nYou plan to run the following code to create a custom Copilot for Security plugin:\n\n<code segment>\nSkillGroups:\n- Format: <target>\n  Skills:\n\nYou need to specify a format and complete the code segment.\n\nWhich format should you use for the variable?",
      "options": [
        "A. API",
        "B. GPT",
        "C. KQL",
        "D. SQL"
      ],
      "answer": [
        "C"
      ],
      "explanation": "**KQL** (Kusto Query Language) is the correct format to specify when building a custom Copilot for Security plugin that queries data sources like Microsoft Sentinel or Microsoft Defender XDR.\n\nUsing `Format: KQL` defines that the plugin's skills will execute KQL queries.\n\nReference: https://learn.microsoft.com/en-us/copilot/security/plugin-kql"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 E5 subscription that uses Microsoft Defender XDR.\n\nYou are investigating an incident.\n\nYou need to review the incident tasks that were performed.\n\nWhat can you use on the Incident page?",
      "options": [
        "A. Tasks only",
        "B. Tasks and Activity log only",
        "C. Tasks and Alert timeline only",
        "D. Tasks, Activity log, and Alert timeline"
      ],
      "answer": [
        "D"
      ],
      "explanation": "The **Incident page** in Microsoft Defender XDR provides access to multiple components for thorough investigation, including:\n\n- **Tasks**: Shows remediation steps and investigation assignments.\n- **Activity log**: Displays detailed history of user and system actions taken on the incident.\n- **Alert timeline**: Helps visualize the sequence of alerts and related events.\n\nAll three are available to support a complete incident investigation.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/investigate-incidents"
    },
    {
      "type": "multiple_choice",
      "question": "You have an Azure subscription that contains a resource group named RG1. RG1 contains a Microsoft Sentinel workspace. The subscription is linked to a Microsoft Entra tenant that contains a user named User1.\n\nYou need to ensure that User1 can deploy and customize Microsoft Sentinel workbook templates. The solution must follow the principle of least privilege.\n\nWhich role should you assign to User1 for RG1?",
      "options": [
        "A. Microsoft Sentinel Contributor",
        "B. Workbook Contributor",
        "C. Microsoft Sentinel Automation Contributor",
        "D. Contributor"
      ],
      "answer": [
        "B"
      ],
      "explanation": "The **Workbook Contributor** role grants permissions to create, edit, and publish Azure Monitor and Microsoft Sentinel workbooks while following the principle of least privilege.\n\n- **Microsoft Sentinel Contributor** and **Contributor** roles would grant broader permissions than required.\n- **Microsoft Sentinel Automation Contributor** is specific to automation rules and playbooks.\n\nReference: https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles/monitor#workbook-contributor"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 E5 subscription that uses Microsoft Copilot for Security.\n\nYou have a Copilot for Security workspace that uses the following plugins:\n\n• Microsoft Entra\n• Microsoft Defender XDR\n\nFrom the Microsoft Defender portal, you use Copilot for Security to investigate a reported incident.\n\nYou need to run a promptbook that will include information from Microsoft Entra ID Protection in the investigation.\n\nWhat should you do first?",
      "options": [
        "A. From the Microsoft Defender portal, create an incident report.",
        "B. Open the investigation in the Copilot for Security standalone experience.",
        "C. Open the investigation in Microsoft Sentinel.",
        "D. From the Microsoft Defender portal, create an advanced hunting query."
      ],
      "answer": [
        "B"
      ],
      "explanation": "To run a **promptbook** that uses multiple plugins — such as Microsoft Entra ID Protection and Microsoft Defender XDR — you must use the **Copilot for Security standalone experience**.\n\nThe Microsoft Defender portal supports basic Copilot functionality, but promptbooks and advanced plugin integration are only available in the standalone Copilot interface.\n\nReference: https://learn.microsoft.com/en-us/purview/ediscovery-keyword-queries-and-search-condition"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 E5 subscription that uses Microsoft Copilot for Security.\n\nYou start a Copilot for Security session and enter five prompts that each provide responses.\n\nYou need to create a promptbook that will use the prompts but will NOT contain the responses. The solution must minimize administrative effort.\n\nWhat should you do?",
      "options": [
        "A. Select each prompt, and then select Create promptbook.",
        "B. Create a new promptbook and include each prompt.",
        "C. Enter a new prompt that has the following input: Create a promptbook from my session prompts.",
        "D. Share the session, and then select Create promptbook."
      ],
      "answer": [
        "A"
      ],
      "explanation": "The most efficient way to create a promptbook from your session prompts — **without saving the responses** — is to select each prompt individually in the session view and then choose **Create promptbook**. This method minimizes administrative effort and provides direct reuse of session inputs.\n\nReference: https://learn.microsoft.com/en-us/copilot/security/build-promptbooks#create-a-promptbook-from-an-existing-session"
    },
    {
      "type": "multiple_choice",
      "question": "You have 1,000 on-premises Windows 11 Pro devices that are onboarded to Microsoft Defender for Endpoint.\n\nYou have a Microsoft 365 subscription that uses Microsoft Defender XDR.\n\nYou identify that an attacker performed the following actions on a device:\n\n• Modified the filesystem path of a registry-based antivirus exclusion\n• Downloaded a malicious file to the file system path\n\nYou initiate a live response session on the device.\n\nYou need to undo the registry change.\n\nWhich command should you run?",
      "options": [
        "A. remediate",
        "B. registry",
        "C. scan",
        "D. analyze"
      ],
      "answer": [
        "A"
      ],
      "explanation": "The **`remediate`** command in a live response session is used to undo malicious changes made to the system, including **registry modifications**. It is designed to reverse known indicators of compromise such as unauthorized configuration changes or malware actions.\n\n- **`registry`** is used for browsing or inspecting registry keys.\n- **`scan`** performs a threat scan.\n- **`analyze`** analyzes collected files but does not revert system changes.\n\nReference: https://learn.microsoft.com/en-us/defender-endpoint/live-response"
    },
    {
      "type": "multiple_choice",
      "question": "Your on-premises network contains two Active Directory Domain Services (AD DS) domains named contoso.com and fabrikam.com. Contoso.com contains a group named Group1. Fabrikam.com contains a group named Group2.\n\nYou have a Microsoft Sentinel workspace named WS1 that contains a scheduled query rule named Rule1. Rule1 generates alerts in response to anomalous AD DS security events. Each alert creates an incident.\n\nYou need to implement an incident triage solution that meets the following requirements:\n\n• Security incidents from contoso.com must be assigned to Group1.\n• Security incidents from fabrikam.com must be assigned to Group2.\n• Administrative effort must be minimized.\n\nWhat should you include in the solution?",
      "options": [
        "A. a playbook that is triggered by the creation of an incident",
        "B. a playbook that is triggered by the creation of an alert",
        "C. one automation rule assigned to Rule1",
        "D. two automation rules assigned to Rule1"
      ],
      "answer": [
        "D"
      ],
      "explanation": "To route incidents to different response groups based on domain (contoso.com vs. fabrikam.com), you should create **two automation rules**, each scoped to a condition that checks the source domain.\n\nThis allows incidents to be automatically assigned to **Group1** or **Group2** without requiring manual review or custom playbooks.\n\n- A single automation rule (Option C) wouldn’t provide separate logic for each domain.\n- Playbooks (Options A and B) introduce more complexity and overhead compared to automation rules for straightforward triage and assignment.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/automate-incident-handling-with-automation-rules?tabs=onboardedhttps://learn.microsoft.com/en-us/azure/sentinel/create-manage-use-automation-rules?tabs=defender-portal%2Conboarded"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 subscription.\n\nYou have the following KQL query:\n\nDeviceEvents\n| where ActionType == \"AntivirusDetection\"\n\nYou need to ensure that you can create a Microsoft Defender XDR custom detection rule by using the query.\n\nWhat should you add to the query?",
      "options": [
        "A. | summarize (Timestamp, ReportId)=arg_max(Timestamp, ReportId), count() by DeviceId",
        "B. | summarize (ReportId)=make_set(ReportId), count() by DeviceId",
        "C. | summarize (Timestamp, DeviceName)=arg_min(Timestamp, DeviceName), count() by DeviceId",
        "D. | summarize (Timestamp)=range(Timestamp), count() by DeviceId"
      ],
      "answer": [
        "A"
      ],
      "explanation": "To make a KQL query eligible for a **Microsoft Defender XDR custom detection rule**, it must return **a single row per device or entity** and must include a valid timestamp column. Using:\n\n`| summarize arg_max(Timestamp, ReportId) by DeviceId`\n\n...ensures that the rule is scoped correctly and returns the **most recent event** per device. This structure is required by Defender XDR’s detection engine to trigger actions appropriately.\n\nReference: https://learn.microsoft.com/en-us/microsoft-365/security/defender-xdr/custom-detections-create?view=o365-worldwide#requirements-for-the-query"
    },
    {
      "type": "multiple_choice",
      "question": "Introductory Info\nCase study -\nThis is a case study. Case studies are not timed separately. You can use as much exam time as you would like to complete each case. However, there may be additional case studies and sections on this exam. You must manage your time to ensure that you are able to complete all questions included on this exam in the time provided.\nTo answer the questions included in a case study, you will need to reference information that is provided in the case study. Case studies might contain exhibits and other resources that provide more information about the scenario that is described in the case study. Each question is independent of the other questions in this case study.\nAt the end of this case study, a review screen will appear. This screen allows you to review your answers and to make changes before you move to the next section of the exam. After you begin a new section, you cannot return to this section.\n\nTo start the case study -\nTo display the first question in this case study, click the Next button. Use the buttons in the left pane to explore the content of the case study before you answer the questions. Clicking these buttons displays information such as business requirements, existing environment, and problem statements. If the case study has an All Information tab, note that the information displayed is identical to the information displayed on the subsequent tabs. When you are ready to answer a question, click the Question button to return to the question.\n\nOverview -\nA company named Contoso Ltd. has a main office and five branch offices located throughout North America. The main office is in Seattle. The branch offices are in Toronto, Miami, Houston, Los Angeles, and Vancouver.\nContoso has a subsidiary named Fabrikam, Ltd. that has offices in New York and San Francisco.\n\nExisting Environment -\n\nEnd-User Environment -\nAll users at Contoso use Windows 10 devices. Each user is licensed for Microsoft 365. In addition, iOS devices are distributed to the members of the sales team at Contoso.\n\nCloud and Hybrid Infrastructure -\nAll Contoso applications are deployed to Azure.\nYou enable Microsoft Cloud App Security.\nContoso and Fabrikam have different Azure Active Directory (Azure AD) tenants. Fabrikam recently purchased an Azure subscription and enabled Azure Defender for all supported resource types.\n\nCurrent Problems -\nThe security team at Contoso receives a large number of cybersecurity alerts. The security team spends too much time identifying which cybersecurity alerts are legitimate threats, and which are not.\nThe Contoso sales team uses only iOS devices. The sales team members exchange files with customers by using a variety of third-party tools. In the past, the sales team experienced phishing attacks on their devices.\nThe marketing team at Contoso has several Microsoft SharePoint Online sites for collaborating with external vendors. The marketing team has had several incidents in which vendors uploaded files that contain malware.\nThe executive team at Contoso suspects a security breach. The executive team requests that you identify which files had more than five activities during the past 48 hours, including data access, download, or deletion for Microsoft Cloud App Security-protected applications.\n\nRequirements -\n\nPlanned Changes -\nContoso plans to integrate the security operations of both companies and manage all security operations centrally.\n\nTechnical Requirements -\nContoso identifies the following technical requirements:\nReceive alerts if an Azure virtual machine is under brute force attack.\nUse Azure Sentinel to reduce organizational risk by rapidly remediating active attacks on the environment.\nImplement Azure Sentinel queries that correlate data across the Azure AD tenants of Contoso and Fabrikam.\nDevelop a procedure to remediate Azure Defender for Key Vault alerts for Fabrikam in case of external attackers and a potential compromise of its own Azure AD applications.\nIdentify all cases of users who failed to sign in to an Azure resource for the first time from a given country. A junior security administrator provides you with the following incomplete query:\n\n```kql\nBehaviorAnalytics\n| where ActivityType == \"FailedLogOn\"\n| where ________ == True\n```\n\nQuestion:\nThe issue for which team can be resolved by using Microsoft Defender for Endpoint?",
      "options": [
        "A. executive",
        "B. sales",
        "C. marketing"
      ],
      "answer": [
        "B"
      ],
      "explanation": "The **sales team** exclusively uses **iOS devices** and has experienced **phishing attacks**. Microsoft Defender for Endpoint supports **iOS**, and provides phishing protection, web protection, and vulnerability management — making it the right tool to mitigate issues affecting this team.\n\n- The **executive** team's concern is related to file activity tracking (Cloud App Security).\n- The **marketing** team’s challenge involves **SharePoint Online malware** issues (covered by Microsoft Defender for Office 365).\n\nReference: https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/microsoft-defender-endpoint-ios?view=o365-worldwide"
    },
    {
      "type": "multiple_choice",
      "question": "Introductory Info\nCase study -\nThis is a case study. Case studies are not timed separately. You can use as much exam time as you would like to complete each case. However, there may be additional case studies and sections on this exam. You must manage your time to ensure that you are able to complete all questions included on this exam in the time provided.\nTo answer the questions included in a case study, you will need to reference information that is provided in the case study. Case studies might contain exhibits and other resources that provide more information about the scenario that is described in the case study. Each question is independent of the other questions in this case study.\nAt the end of this case study, a review screen will appear. This screen allows you to review your answers and to make changes before you move to the next section of the exam. After you begin a new section, you cannot return to this section.\n\nTo start the case study -\nTo display the first question in this case study, click the Next button. Use the buttons in the left pane to explore the content of the case study before you answer the questions. Clicking these buttons displays information such as business requirements, existing environment, and problem statements. If the case study has an All Information tab, note that the information displayed is identical to the information displayed on the subsequent tabs. When you are ready to answer a question, click the Question button to return to the question.\n\nOverview -\nA company named Contoso Ltd. has a main office and five branch offices located throughout North America. The main office is in Seattle. The branch offices are in Toronto, Miami, Houston, Los Angeles, and Vancouver.\nContoso has a subsidiary named Fabrikam, Ltd. that has offices in New York and San Francisco.\n\nExisting Environment -\n\nEnd-User Environment -\nAll users at Contoso use Windows 10 devices. Each user is licensed for Microsoft 365. In addition, iOS devices are distributed to the members of the sales team at Contoso.\n\nCloud and Hybrid Infrastructure -\nAll Contoso applications are deployed to Azure.\nYou enable Microsoft Cloud App Security.\nContoso and Fabrikam have different Azure Active Directory (Azure AD) tenants. Fabrikam recently purchased an Azure subscription and enabled Azure Defender for all supported resource types.\n\nCurrent Problems -\nThe security team at Contoso receives a large number of cybersecurity alerts. The security team spends too much time identifying which cybersecurity alerts are legitimate threats, and which are not.\nThe Contoso sales team uses only iOS devices. The sales team members exchange files with customers by using a variety of third-party tools. In the past, the sales team experienced phishing attacks on their devices.\nThe marketing team at Contoso has several Microsoft SharePoint Online sites for collaborating with external vendors. The marketing team has had several incidents in which vendors uploaded files that contain malware.\nThe executive team at Contoso suspects a security breach. The executive team requests that you identify which files had more than five activities during the past 48 hours, including data access, download, or deletion for Microsoft Cloud App Security-protected applications.\n\nRequirements -\n\nPlanned Changes -\nContoso plans to integrate the security operations of both companies and manage all security operations centrally.\n\nTechnical Requirements -\nContoso identifies the following technical requirements:\nReceive alerts if an Azure virtual machine is under brute force attack.\nUse Azure Sentinel to reduce organizational risk by rapidly remediating active attacks on the environment.\nImplement Azure Sentinel queries that correlate data across the Azure AD tenants of Contoso and Fabrikam.\nDevelop a procedure to remediate Azure Defender for Key Vault alerts for Fabrikam in case of external attackers and a potential compromise of its own Azure AD applications.\nIdentify all cases of users who failed to sign in to an Azure resource for the first time from a given country. A junior security administrator provides you with the following incomplete query:\n\n```kql\nBehaviorAnalytics\n| where ActivityType == \"FailedLogOn\"\n| where ________ == True\n```\n\nQuestion:\nThe issue for which team can be resolved by using Microsoft Defender for Office 365?",
      "options": [
        "A. executive",
        "B. marketing",
        "C. security",
        "D. sales"
      ],
      "answer": [
        "B"
      ],
      "explanation": "The **marketing team** collaborates with **external vendors** via **SharePoint Online**. They have experienced **malware incidents** from vendor-uploaded files.\n\n**Microsoft Defender for Office 365** provides protection against threats like malware in collaboration tools such as SharePoint, OneDrive, and Teams.\n\nThis makes it the correct solution for addressing the marketing team's malware upload issue.\n\n**Reference:** https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/defender-for-office-365?view=o365-worldwide"
    },
    {
      "type": "multiple_choice",
      "question": "Introductory Info\nCase study -\nThis is a case study. Case studies are not timed separately. You can use as much exam time as you would like to complete each case. However, there may be additional case studies and sections on this exam. You must manage your time to ensure that you are able to complete all questions included on this exam in the time provided.\nTo answer the questions included in a case study, you will need to reference information that is provided in the case study. Case studies might contain exhibits and other resources that provide more information about the scenario that is described in the case study. Each question is independent of the other questions in this case study.\nAt the end of this case study, a review screen will appear. This screen allows you to review your answers and to make changes before you move to the next section of the exam. After you begin a new section, you cannot return to this section.\n\nTo start the case study -\nTo display the first question in this case study, click the Next button. Use the buttons in the left pane to explore the content of the case study before you answer the questions. Clicking these buttons displays information such as business requirements, existing environment, and problem statements. If the case study has an All Information tab, note that the information displayed is identical to the information displayed on the subsequent tabs. When you are ready to answer a question, click the Question button to return to the question.\n\nOverview -\nLitware Inc. is a renewable energy company with offices in Boston and Seattle. Remote users across the U.S. access resources using VPNs.\n\nExisting Environment -\nThe network contains an Active Directory forest that syncs to an Azure AD tenant. The Microsoft 365 E5 subscription has Microsoft Defender for Endpoint deployed to all Windows 10 devices. All Cloud App Security built-in anomaly detection policies are enabled.\nThe Azure subscription has resources in the East US region, including a Log Analytics workspace (LA1), a Windows Server VM (VM1), and a Linux VM (VM2).\nCloud App Security frequently generates false positives when users connect to both offices at the same time.\n\nRequirements -\n- Use least privilege and minimize cost\n- Protect all domain controllers with Microsoft Defender for Identity\n- All Cloud App Security unsanctioned apps must be blocked on Windows 10\n- Cloud App Security must identify anomalous behavior using tenant-level data\n- Integrate Sentinel with Cloud App Security\n\nQuestion:\nYou need to modify the anomaly detection policy settings to meet the Cloud App Security requirements and resolve the reported problem.\nWhich policy should you modify?",
      "options": [
        "A. Activity from suspicious IP addresses",
        "B. Activity from anonymous IP addresses",
        "C. Impossible travel",
        "D. Risky sign-in"
      ],
      "answer": [
        "C"
      ],
      "explanation": "**C. Impossible travel** is the built-in anomaly detection policy that generates alerts when a user logs in from geographically distant locations within a time frame that makes travel impossible.\n\nSince users connect to both offices (e.g., Boston and Seattle) over VPN simultaneously, this triggers the 'impossible travel' detection and causes false positives. Adjusting this policy can help reduce those false positives.\n\n**Reference:** https://learn.microsoft.com/en-us/cloud-app-security/anomaly-detection-policy"
    },
    {
      "type": "multiple_choice",
      "question": "Introductory Info\nCase study -\nThis is a case study. Case studies are not timed separately. You can use as much exam time as you would like to complete each case. However, there may be additional case studies and sections on this exam. You must manage your time to ensure that you are able to complete all questions included on this exam in the time provided.\nTo answer the questions included in a case study, you will need to reference information that is provided in the case study. Case studies might contain exhibits and other resources that provide more information about the scenario that is described in the case study. Each question is independent of the other questions in this case study.\nAt the end of this case study, a review screen will appear. This screen allows you to review your answers and to make changes before you move to the next section of the exam. After you begin a new section, you cannot return to this section.\n\nTo start the case study -\nTo display the first question in this case study, click the Next button. Use the buttons in the left pane to explore the content of the case study before you answer the questions. Clicking these buttons displays information such as business requirements, existing environment, and problem statements. If the case study has an All Information tab, note that the information displayed is identical to the information displayed on the subsequent tabs. When you are ready to answer a question, click the Question button to return to the question.\n\nOverview -\nA company named Contoso Ltd. has a main office and five branch offices located throughout North America. The main office is in Seattle. The branch offices are in Toronto, Miami, Houston, Los Angeles, and Vancouver.\nContoso has a subsidiary named Fabrikam, Ltd. that has offices in New York and San Francisco.\n\nExisting Environment -\n\nEnd-User Environment -\nAll users at Contoso use Windows 10 devices. Each user is licensed for Microsoft 365. In addition, iOS devices are distributed to the members of the sales team at Contoso.\n\nCloud and Hybrid Infrastructure -\nAll Contoso applications are deployed to Azure.\nYou enable Microsoft Cloud App Security.\nContoso and Fabrikam have different Azure Active Directory (Azure AD) tenants. Fabrikam recently purchased an Azure subscription and enabled Azure Defender for all supported resource types.\n\nCurrent Problems -\nThe security team at Contoso receives a large number of cybersecurity alerts. The security team spends too much time identifying which cybersecurity alerts are legitimate threats, and which are not.\nThe Contoso sales team uses only iOS devices. The sales team members exchange files with customers by using a variety of third-party tools. In the past, the sales team experienced phishing attacks on their devices.\nThe marketing team at Contoso has several Microsoft SharePoint Online sites for collaborating with external vendors. The marketing team has had several incidents in which vendors uploaded files that contain malware.\nThe executive team at Contoso suspects a security breach. The executive team requests that you identify which files had more than five activities during the past 48 hours, including data access, download, or deletion for Microsoft Cloud App Security-protected applications.\n\nRequirements -\n\nPlanned Changes -\nContoso plans to integrate the security operations of both companies and manage all security operations centrally.\n\nTechnical Requirements -\nContoso identifies the following technical requirements:\n• Receive alerts if an Azure virtual machine is under brute force attack.\n• Use Azure Sentinel to reduce organizational risk by rapidly remediating active attacks on the environment.\n• Implement Azure Sentinel queries that correlate data across the Azure AD tenants of Contoso and Fabrikam.\n• Develop a procedure to remediate Azure Defender for Key Vault alerts for Contoso in case of external and internal threats. The solution must minimize the impact on legitimate attempts to access the key vault content.\n• Identify all cases of users who failed to sign in to an Azure resource for the first time from a given country. A junior security administrator provides you with the following incomplete query:\n\nBehaviorAnalytics\n| where ActivityType == \"FailedLogOn\"\n| where ________ == True\n\nQuestion\nYou need to recommend a solution to meet the technical requirements for the Azure virtual machines.\nWhat should you include in the recommendation?",
      "options": [
        "A. just-in-time (JIT) access",
        "B. Azure Defender",
        "C. Azure Firewall",
        "D. Azure Application Gateway"
      ],
      "answer": "B. Azure Defender",
      "explanation": "- **Azure Defender** (now known as Microsoft Defender for Cloud) is designed to provide threat detection and alerting for Azure resources, including virtual machines. It meets the requirement to receive alerts for brute force attacks and other threats.\n\n- **Just-in-time (JIT) access** helps reduce the attack surface by limiting access to VMs but does not provide threat detection or alerting.\n- **Azure Firewall** provides network layer protection, but not direct brute force attack alerts on VMs.\n- **Azure Application Gateway** is a layer 7 load balancer with WAF capabilities but irrelevant for brute force alerting on VMs.\n\nReference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/defender-for-servers-introduction"
    },
    {
      "type": "multiple_choice",
      "question": "Introductory Info\nCase study -\nThis is a case study. Case studies are not timed separately. You can use as much exam time as you would like to complete each case. However, there may be additional case studies and sections on this exam. You must manage your time to ensure that you are able to complete all questions included on this exam in the time provided.\nTo answer the questions included in a case study, you will need to reference information that is provided in the case study. Case studies might contain exhibits and other resources that provide more information about the scenario that is described in the case study. Each question is independent of the other questions in this case study.\nAt the end of this case study, a review screen will appear. This screen allows you to review your answers and to make changes before you move to the next section of the exam. After you begin a new section, you cannot return to this section.\n\nTo start the case study -\nTo display the first question in this case study, click the Next button. Use the buttons in the left pane to explore the content of the case study before you answer the questions. Clicking these buttons displays information such as business requirements, existing environment, and problem statements. If the case study has an All Information tab, note that the information displayed is identical to the information displayed on the subsequent tabs. When you are ready to answer a question, click the Question button to return to the question.\n\nOverview -\nA company named Contoso Ltd. has a main office and five branch offices located throughout North America. The main office is in Seattle. The branch offices are in Toronto, Miami, Houston, Los Angeles, and Vancouver.\nContoso has a subsidiary named Fabrikam, Ltd. that has offices in New York and San Francisco.\n\nExisting Environment -\n\nEnd-User Environment -\nAll users at Contoso use Windows 10 devices. Each user is licensed for Microsoft 365. In addition, iOS devices are distributed to the members of the sales team at Contoso.\n\nCloud and Hybrid Infrastructure -\nAll Contoso applications are deployed to Azure.\nYou enable Microsoft Cloud App Security.\nContoso and Fabrikam have different Azure Active Directory (Azure AD) tenants. Fabrikam recently purchased an Azure subscription and enabled Azure Defender for all supported resource types.\n\nCurrent Problems -\nThe security team at Contoso receives a large number of cybersecurity alerts. The security team spends too much time identifying which cybersecurity alerts are legitimate threats, and which are not.\nThe Contoso sales team uses only iOS devices. The sales team members exchange files with customers by using a variety of third-party tools. In the past, the sales team experienced phishing attacks on their devices.\nThe marketing team at Contoso has several Microsoft SharePoint Online sites for collaborating with external vendors. The marketing team has had several incidents in which vendors uploaded files that contain malware.\nThe executive team at Contoso suspects a security breach. The executive team requests that you identify which files had more than five activities during the past 48 hours, including data access, download, or deletion for Microsoft Cloud App Security-protected applications.\n\nRequirements -\n\nPlanned Changes -\nContoso plans to integrate the security operations of both companies and manage all security operations centrally.\n\nTechnical Requirements -\nContoso identifies the following technical requirements:\n• Receive alerts if an Azure virtual machine is under brute force attack.\n• Use Azure Sentinel to reduce organizational risk by rapidly remediating active attacks on the environment.\n• Implement Azure Sentinel queries that correlate data across the Azure AD tenants of Contoso and Fabrikam.\n• Develop a procedure to remediate Azure Defender for Key Vault alerts for Contoso in case of external and internal threats. The solution must minimize the impact on legitimate attempts to access the key vault content.\n• Identify all cases of users who failed to sign in to an Azure resource for the first time from a given country. A junior security administrator provides you with the following incomplete query:\n\nBehaviorAnalytics\n| where ActivityType == \"FailedLogOn\"\n| where ________ == True\n\nQuestion\nYou need to complete the query for failed sign-ins to meet the technical requirements.\nWhere can you find the column name to complete the where clause?",
      "options": [
        "A. Security alerts in Azure Security Center",
        "B. Activity log in Azure",
        "C. Azure Advisor",
        "D. UEBA schema documentation"
      ],
      "answer": "D. UEBA schema documentation",
      "explanation": "- The correct answer is **D. UEBA schema documentation**.\n- The incomplete KQL query targets `BehaviorAnalytics`, which is part of Microsoft Sentinel's UEBA (User and Entity Behavior Analytics). To find the column name needed (e.g., `IsNewCountryLogin`), you must consult the **Microsoft Sentinel UEBA schema** documentation.\n- The other options (Security alerts, Activity log, Azure Advisor) do not provide schema details for custom KQL queries in Sentinel.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/ueba-reference#country-connected-from"
    },
    {
      "type": "multiple_choice",
      "question": "Introductory Info\nCase study -\nThis is a case study. Case studies are not timed separately. You can use as much exam time as you would like to complete each case. However, there may be additional case studies and sections on this exam. You must manage your time to ensure that you are able to complete all questions included on this exam in the time provided.\nTo answer the questions included in a case study, you will need to reference information that is provided in the case study. Case studies might contain exhibits and other resources that provide more information about the scenario that is described in the case study. Each question is independent of the other questions in this case study.\nAt the end of this case study, a review screen will appear. This screen allows you to review your answers and to make changes before you move to the next section of the exam. After you begin a new section, you cannot return to this section.\n\nTo start the case study -\nTo display the first question in this case study, click the Next button. Use the buttons in the left pane to explore the content of the case study before you answer the questions. Clicking these buttons displays information such as business requirements, existing environment, and problem statements. If the case study has an All Information tab, note that the information displayed is identical to the information displayed on the subsequent tabs. When you are ready to answer a question, click the Question button to return to the question.\n\nOverview -\nA company named Contoso Ltd. has a main office and five branch offices located throughout North America. The main office is in Seattle. The branch offices are in Toronto, Miami, Houston, Los Angeles, and Vancouver.\nContoso has a subsidiary named Fabrikam, Ltd. that has offices in New York and San Francisco.\n\nExisting Environment -\n\nEnd-User Environment -\nAll users at Contoso use Windows 10 devices. Each user is licensed for Microsoft 365. In addition, iOS devices are distributed to the members of the sales team at Contoso.\n\nCloud and Hybrid Infrastructure -\nAll Contoso applications are deployed to Azure.\nYou enable Microsoft Cloud App Security.\nContoso and Fabrikam have different Azure Active Directory (Azure AD) tenants. Fabrikam recently purchased an Azure subscription and enabled Azure Defender for all supported resource types.\n\nCurrent Problems -\nThe security team at Contoso receives a large number of cybersecurity alerts. The security team spends too much time identifying which cybersecurity alerts are legitimate threats, and which are not.\nThe Contoso sales team uses only iOS devices. The sales team members exchange files with customers by using a variety of third-party tools. In the past, the sales team experienced phishing attacks on their devices.\nThe marketing team at Contoso has several Microsoft SharePoint Online sites for collaborating with external vendors. The marketing team has had several incidents in which vendors uploaded files that contain malware.\nThe executive team at Contoso suspects a security breach. The executive team requests that you identify which files had more than five activities during the past 48 hours, including data access, download, or deletion for Microsoft Cloud App Security-protected applications.\n\nRequirements -\n\nPlanned Changes -\nContoso plans to integrate the security operations of both companies and manage all security operations centrally.\n\nTechnical Requirements -\nContoso identifies the following technical requirements:\n• Receive alerts if an Azure virtual machine is under brute force attack.\n• Use Azure Sentinel to reduce organizational risk by rapidly remediating active attacks on the environment.\n• Implement Azure Sentinel queries that correlate data across the Azure AD tenants of Contoso and Fabrikam.\n• Develop a procedure to remediate Azure Defender for Key Vault alerts for Contoso in case of external and internal threats. The solution must minimize the impact on legitimate attempts to access the key vault content.\n• Identify all cases of users who failed to sign in to an Azure resource for the first time from a given country. A junior security administrator provides you with the following incomplete query:\n\nBehaviorAnalytics\n| where ActivityType == \"FailedLogOn\"\n| where ________ == True\n\nQuestion\nYou need to complete the query for failed sign-ins to meet the technical requirements.\nWhere can you find the column name to complete the where clause?",
      "options": [
        "A. Azure Automation runbooks",
        "B. Azure Logic Apps",
        "C. Azure Functions",
        "D. Azure Sentinel livestreams"
      ],
      "answer": "D. Azure Sentinel livestreams",
      "explanation": "- **Azure Sentinel livestreams** provide real-time query monitoring and can help security analysts investigate logs as they're ingested.\n- When constructing KQL queries, livestream can be used to interactively explore logs and view column names in the dataset such as `BehaviorAnalytics`, making it the appropriate tool to help identify fields like `IsNewCountryLogin`.\n- The other tools (Runbooks, Logic Apps, Functions) are automation or orchestration components, not intended for interactive query building or schema exploration.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/tutorial-livestream"
    },
    {
      "type": "multiple_choice",
      "question": "Introductory Info\nCase study -\nThis is a case study. Case studies are not timed separately. You can use as much exam time as you would like to complete each case. However, there may be additional case studies and sections on this exam. You must manage your time to ensure that you are able to complete all questions included on this exam in the time provided.\nTo answer the questions included in a case study, you will need to reference information that is provided in the case study. Case studies might contain exhibits and other resources that provide more information about the scenario that is described in the case study. Each question is independent of the other questions in this case study.\nAt the end of this case study, a review screen will appear. This screen allows you to review your answers and to make changes before you move to the next section of the exam. After you begin a new section, you cannot return to this section.\n\nTo start the case study -\nTo display the first question in this case study, click the Next button. Use the buttons in the left pane to explore the content of the case study before you answer the questions. Clicking these buttons displays information such as business requirements, existing environment, and problem statements. If the case study has an All Information tab, note that the information displayed is identical to the information displayed on the subsequent tabs. When you are ready to answer a question, click the Question button to return to the question.\n\nOverview -\nA company named Contoso Ltd. has a main office and five branch offices located throughout North America. The main office is in Seattle. The branch offices are in Toronto, Miami, Houston, Los Angeles, and Vancouver.\nContoso has a subsidiary named Fabrikam, Ltd. that has offices in New York and San Francisco.\n\nExisting Environment -\n\nEnd-User Environment -\nAll users at Contoso use Windows 10 devices. Each user is licensed for Microsoft 365. In addition, iOS devices are distributed to the members of the sales team at Contoso.\n\nCloud and Hybrid Infrastructure -\nAll Contoso applications are deployed to Azure.\nYou enable Microsoft Cloud App Security.\nContoso and Fabrikam have different Azure Active Directory (Azure AD) tenants. Fabrikam recently purchased an Azure subscription and enabled Azure Defender for all supported resource types.\n\nCurrent Problems -\nThe security team at Contoso receives a large number of cybersecurity alerts. The security team spends too much time identifying which cybersecurity alerts are legitimate threats, and which are not.\nThe Contoso sales team uses only iOS devices. The sales team members exchange files with customers by using a variety of third-party tools. In the past, the sales team experienced phishing attacks on their devices.\nThe marketing team at Contoso has several Microsoft SharePoint Online sites for collaborating with external vendors. The marketing team has had several incidents in which vendors uploaded files that contain malware.\nThe executive team at Contoso suspects a security breach. The executive team requests that you identify which files had more than five activities during the past 48 hours, including data access, download, or deletion for Microsoft Cloud App Security-protected applications.\n\nRequirements -\n\nPlanned Changes -\nContoso plans to integrate the security operations of both companies and manage all security operations centrally.\n\nTechnical Requirements -\nContoso identifies the following technical requirements:\n• Receive alerts if an Azure virtual machine is under brute force attack.\n• Use Azure Sentinel to reduce organizational risk by rapidly remediating active attacks on the environment.\n• Implement Azure Sentinel queries that correlate data across the Azure AD tenants of Contoso and Fabrikam.\n• Develop a procedure to remediate Azure Defender for Key Vault alerts for Contoso in case of external and internal threats. The solution must minimize the impact on legitimate attempts to access the key vault content.\n• Identify all cases of users who failed to sign in to an Azure resource for the first time from a given country. A junior security administrator provides you with the following incomplete query:\n\nBehaviorAnalytics\n| where ActivityType == \"FailedLogOn\"\n| where ________ == True\n\nQuestion\nYou need to remediate active attacks to meet the technical requirements.\nWhat should you include in the solution?",
      "options": [
        "A. Azure Automation runbooks",
        "B. Azure Logic Apps",
        "C. Azure Functions",
        "D. Azure Sentinel livestreams"
      ],
      "answer": "B. Azure Logic Apps",
      "explanation": "- **Azure Logic Apps** are used in Azure Sentinel playbooks to automate responses to security threats and active attacks. Playbooks are workflows built using Logic Apps that can trigger actions like blocking IPs, sending alerts, or disabling accounts based on detected incidents.\n- This aligns with the technical requirement to *rapidly remediate active attacks* using Sentinel.\n- While Automation runbooks and Functions are useful for automation, Logic Apps are directly integrated into Sentinel's incident response workflow.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/tutorial-respond-threats-playbook"
    },
    {
      "type": "multiple_choice",
      "question": "Introductory Info\nCase study -\nThis is a case study. Case studies are not timed separately. You can use as much exam time as you would like to complete each case. However, there may be additional case studies and sections on this exam. You must manage your time to ensure that you are able to complete all questions included on this exam in the time provided.\nTo answer the questions included in a case study, you will need to reference information that is provided in the case study. Case studies might contain exhibits and other resources that provide more information about the scenario that is described in the case study. Each question is independent of the other questions in this case study.\nAt the end of this case study, a review screen will appear. This screen allows you to review your answers and to make changes before you move to the next section of the exam. After you begin a new section, you cannot return to this section.\n\nTo start the case study -\nTo display the first question in this case study, click the Next button. Use the buttons in the left pane to explore the content of the case study before you answer the questions. Clicking these buttons displays information such as business requirements, existing environment, and problem statements. If the case study has an All Information tab, note that the information displayed is identical to the information displayed on the subsequent tabs. When you are ready to answer a question, click the Question button to return to the question.\n\nOverview -\nLitware Inc. is a renewable energy company.\nLitware has offices in Boston and Seattle. Litware also has remote users located across the United States. To access Litware resources, including cloud resources, the remote users establish a VPN connection to either office.\n\nExisting Environment -\nIdentity Environment -\nThe network contains an Active Directory forest named litware.com that syncs to an Azure Active Directory (Azure AD) tenant named litware.com.\n\nMicrosoft 365 Environment -\nLitware has a Microsoft 365 E5 subscription linked to the litware.com Azure AD tenant. Microsoft Defender for Endpoint is deployed to all computers that run Windows 10. All Microsoft Cloud App Security built-in anomaly detection policies are enabled.\n\nAzure Environment -\nLitware has an Azure subscription linked to the litware.com Azure AD tenant. The subscription contains resources in the East US Azure region as shown in the following table:\n\n+------+------------------------+-------------------------------------------------------------------------+\n| Name | Type                   | Description                                                             |\n+------+------------------------+-------------------------------------------------------------------------+\n| LA1  | Log Analytics workspace| Contains logs and metrics collected from all Azure resources and        |\n|      |                        | on-premises servers                                                     |\n| VM1  | Virtual machine        | Server that runs Windows Server 2019                                   |\n| VM2  | Virtual machine        | Server that runs Ubuntu 18.04 LTS                                      |\n+------+------------------------+-------------------------------------------------------------------------+\n\nNetwork Environment -\nEach Litware office connects directly to the internet and has a site-to-site VPN connection to the virtual networks in the Azure subscription.\n\nOn-premises Environment -\nThe on-premises network contains the computers shown in the following table:\n\n+------+------------------------+-------------------------------------------------------------------------+\n| Name | Type                   | Description                                                             |\n+------+------------------------+-------------------------------------------------------------------------+\n| LA1  | Log Analytics workspace| Contains logs and metrics collected from all Azure resources and        |\n|      |                        | on-premises servers                                                     |\n| VM1  | Virtual machine        | Server that runs Windows Server 2019                                   |\n| VM2  | Virtual machine        | Server that runs Ubuntu 18.04 LTS                                      |\n+------+------------------------+-------------------------------------------------------------------------+\n\nCurrent Problems -\nCloud App Security frequently generates false positive alerts when users connect to both offices simultaneously.\n\nPlanned Changes and Requirements -\nPlanned Changes:\n• Create and configure Azure Sentinel in the Azure subscription.\n• Validate Azure Sentinel functionality by using Azure AD test user accounts.\n\nBusiness Requirements:\n• The principle of least privilege must be used whenever possible.\n• Costs must be minimized, as long as all other requirements are met.\n• Logs collected by Log Analytics must provide a full audit trail of user activities.\n• All domain controllers must be protected by using Microsoft Defender for Identity.\n\nAzure Information Protection Requirements:\n• All files that have security labels and are stored on the Windows 10 computers must be available from the Azure Information Protection Data discovery dashboard.\n\nMicrosoft Defender for Endpoint requirements:\n• All Cloud App Security unsanctioned apps must be blocked on the Windows 10 computers by using Microsoft Defender for Endpoint.\n\nMicrosoft Cloud App Security requirements:\n• Cloud App Security must identify whether a user connection is anomalous based on tenant-level data.\n\nAzure Defender Requirements:\n• All servers must send logs to the same Log Analytics workspace.\n\nAzure Sentinel Requirements:\nLitware must meet the following Azure Sentinel requirements:\n• Integrate Azure Sentinel and Cloud App Security.\n• Ensure that a user named admin1 can configure Azure Sentinel playbooks.\n• Create an Azure Sentinel analytics rule based on a custom query. The rule must automatically initiate the execution of a playbook.\n• Add notes to events that represent data access from a specific IP address to provide the ability to reference the IP address when navigating through an investigation graph while hunting.\n• Create a test rule that generates alerts when inbound access to Microsoft Office 365 by the Azure AD test user accounts is detected. Alerts generated by the rule must be grouped into individual incidents, with one incident per test user account.\n\nQuestion:\nYou need to restrict cloud apps running on CLIENT1 to meet the Microsoft Defender for Endpoint requirements.\nWhich two configurations should you modify? Each correct answer presents part of the solution.\nNOTE: Each correct selection is worth one point.",
      "options": [
        "A. the Onboarding settings from Device management in Microsoft Defender Security Center",
        "B. Cloud App Security anomaly detection policies",
        "C. Advanced features from Settings in Microsoft Defender Security Center",
        "D. the Cloud Discovery settings in Cloud App Security"
      ],
      "answer": [
        "C. Advanced features from Settings in Microsoft Defender Security Center",
        "D. the Cloud Discovery settings in Cloud App Security"
      ],
      "explanation": "- **Option C**: Advanced features in Microsoft Defender for Endpoint include integration settings that allow Cloud App Security (MCAS) to leverage Defender for Endpoint data for app control and discovery.\n- **Option D**: To block unsanctioned apps based on MCAS data, you must enable and configure Cloud Discovery in Cloud App Security and integrate it with Defender for Endpoint.\n\nReference:\n- https://learn.microsoft.com/en-us/cloud-app-security/mde-integration\n- https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/microsoft-defender-endpoint-configure?view=o365-worldwide"
    },
    {
      "type": "multiple_choice",
      "question": "Introductory Info\nCase study -\nThis is a case study. Case studies are not timed separately. You can use as much exam time as you would like to complete each case. However, there may be additional case studies and sections on this exam. You must manage your time to ensure that you are able to complete all questions included on this exam in the time provided.\nTo answer the questions included in a case study, you will need to reference information that is provided in the case study. Case studies might contain exhibits and other resources that provide more information about the scenario that is described in the case study. Each question is independent of the other questions in this case study.\nAt the end of this case study, a review screen will appear. This screen allows you to review your answers and to make changes before you move to the next section of the exam. After you begin a new section, you cannot return to this section.\n\nTo start the case study -\nTo display the first question in this case study, click the Next button. Use the buttons in the left pane to explore the content of the case study before you answer the questions. Clicking these buttons displays information such as business requirements, existing environment, and problem statements. If the case study has an All Information tab, note that the information displayed is identical to the information displayed on the subsequent tabs. When you are ready to answer a question, click the Question button to return to the question.\n\nOverview -\nLitware Inc. is a renewable energy company.\nLitware has offices in Boston and Seattle. Litware also has remote users located across the United States. To access Litware resources, including cloud resources, the remote users establish a VPN connection to either office.\n\nExisting Environment -\nIdentity Environment -\nThe network contains an Active Directory forest named litware.com that syncs to an Azure Active Directory (Azure AD) tenant named litware.com.\n\nMicrosoft 365 Environment -\nLitware has a Microsoft 365 E5 subscription linked to the litware.com Azure AD tenant. Microsoft Defender for Endpoint is deployed to all computers that run Windows 10. All Microsoft Cloud App Security built-in anomaly detection policies are enabled.\n\nAzure Environment -\nLitware has an Azure subscription linked to the litware.com Azure AD tenant. The subscription contains resources in the East US Azure region as shown in the following table:\n\n+------+------------------------+-------------------------------------------------------------------------+\n| Name | Type                   | Description                                                             |\n+------+------------------------+-------------------------------------------------------------------------+\n| LA1  | Log Analytics workspace| Contains logs and metrics collected from all Azure resources and        |\n|      |                        | on-premises servers                                                     |\n| VM1  | Virtual machine        | Server that runs Windows Server 2019                                   |\n| VM2  | Virtual machine        | Server that runs Ubuntu 18.04 LTS                                      |\n+------+------------------------+-------------------------------------------------------------------------+\n\nNetwork Environment -\nEach Litware office connects directly to the internet and has a site-to-site VPN connection to the virtual networks in the Azure subscription.\n\nOn-premises Environment -\nThe on-premises network contains the computers shown in the following table:\n\n+------+------------------------+-------------------------------------------------------------------------+\n| Name | Type                   | Description                                                             |\n+------+------------------------+-------------------------------------------------------------------------+\n| LA1  | Log Analytics workspace| Contains logs and metrics collected from all Azure resources and        |\n|      |                        | on-premises servers                                                     |\n| VM1  | Virtual machine        | Server that runs Windows Server 2019                                   |\n| VM2  | Virtual machine        | Server that runs Ubuntu 18.04 LTS                                      |\n+------+------------------------+-------------------------------------------------------------------------+\n\nCurrent Problems -\nCloud App Security frequently generates false positive alerts when users connect to both offices simultaneously.\n\nPlanned Changes and Requirements -\nPlanned Changes:\n• Create and configure Azure Sentinel in the Azure subscription.\n• Validate Azure Sentinel functionality by using Azure AD test user accounts.\n\nBusiness Requirements:\n• The principle of least privilege must be used whenever possible.\n• Costs must be minimized, as long as all other requirements are met.\n• Logs collected by Log Analytics must provide a full audit trail of user activities.\n• All domain controllers must be protected by using Microsoft Defender for Identity.\n\nAzure Information Protection Requirements:\n• All files that have security labels and are stored on the Windows 10 computers must be available from the Azure Information Protection Data discovery dashboard.\n\nMicrosoft Defender for Endpoint requirements:\n• All Cloud App Security unsanctioned apps must be blocked on the Windows 10 computers by using Microsoft Defender for Endpoint.\n\nMicrosoft Cloud App Security requirements:\n• Cloud App Security must identify whether a user connection is anomalous based on tenant-level data.\n\nAzure Defender Requirements:\n• All servers must send logs to the same Log Analytics workspace.\n\nAzure Sentinel Requirements:\nLitware must meet the following Azure Sentinel requirements:\n• Integrate Azure Sentinel and Cloud App Security.\n• Ensure that a user named admin1 can configure Azure Sentinel playbooks.\n• Create an Azure Sentinel analytics rule based on a custom query. The rule must automatically initiate the execution of a playbook.\n• Add notes to events that represent data access from a specific IP address to provide the ability to reference the IP address when navigating through an investigation graph while hunting.\n• Create a test rule that generates alerts when inbound access to Microsoft Office 365 by the Azure AD test user accounts is detected. Alerts generated by the rule must be grouped into individual incidents, with one incident per test user account.\n\nQuestion:\nYou need to assign a role-based access control (RBAC) role to admin1 to meet the Azure Sentinel requirements and the business requirements.\nWhich role should you assign?",
      "options": [
        "A. Automation Operator",
        "B. Automation Runbook Operator",
        "C. Azure Sentinel Contributor",
        "D. Azure Sentinel Responder"
      ],
      "answer": "C. Azure Sentinel Contributor",
      "explanation": "- **Azure Sentinel Contributor** allows full access to Azure Sentinel capabilities including creating and editing analytics rules, playbooks, and managing data connectors.\n- This meets the requirement that *admin1 can configure Azure Sentinel playbooks*.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/roles#microsoft-sentinel-roles-permissions-and-allowed-actions"
    },
    {
      "type": "multiple_choice",
      "question": "Introductory Info\nCase study -\nThis is a case study. Case studies are not timed separately. You can use as much exam time as you would like to complete each case. However, there may be additional case studies and sections on this exam. You must manage your time to ensure that you are able to complete all questions included on this exam in the time provided.\nTo answer the questions included in a case study, you will need to reference information that is provided in the case study. Case studies might contain exhibits and other resources that provide more information about the scenario that is described in the case study. Each question is independent of the other questions in this case study.\nAt the end of this case study, a review screen will appear. This screen allows you to review your answers and to make changes before you move to the next section of the exam. After you begin a new section, you cannot return to this section.\n\nTo start the case study -\nTo display the first question in this case study, click the Next button. Use the buttons in the left pane to explore the content of the case study before you answer the questions. Clicking these buttons displays information such as business requirements, existing environment, and problem statements. If the case study has an All Information tab, note that the information displayed is identical to the information displayed on the subsequent tabs. When you are ready to answer a question, click the Question button to return to the question.\n\nOverview -\nLitware Inc. is a renewable energy company.\nLitware has offices in Boston and Seattle. Litware also has remote users located across the United States. To access Litware resources, including cloud resources, the remote users establish a VPN connection to either office.\n\nExisting Environment -\nIdentity Environment -\nThe network contains an Active Directory forest named litware.com that syncs to an Azure Active Directory (Azure AD) tenant named litware.com.\n\nMicrosoft 365 Environment -\nLitware has a Microsoft 365 E5 subscription linked to the litware.com Azure AD tenant. Microsoft Defender for Endpoint is deployed to all computers that run Windows 10. All Microsoft Cloud App Security built-in anomaly detection policies are enabled.\n\nAzure Environment -\nLitware has an Azure subscription linked to the litware.com Azure AD tenant. The subscription contains resources in the East US Azure region as shown in the following table:\n\n+------+------------------------+-------------------------------------------------------------------------+\n| Name | Type                   | Description                                                             |\n+------+------------------------+-------------------------------------------------------------------------+\n| LA1  | Log Analytics workspace| Contains logs and metrics collected from all Azure resources and        |\n|      |                        | on-premises servers                                                     |\n| VM1  | Virtual machine        | Server that runs Windows Server 2019                                   |\n| VM2  | Virtual machine        | Server that runs Ubuntu 18.04 LTS                                      |\n+------+------------------------+-------------------------------------------------------------------------+\n\nNetwork Environment -\nEach Litware office connects directly to the internet and has a site-to-site VPN connection to the virtual networks in the Azure subscription.\n\nOn-premises Environment -\nThe on-premises network contains the computers shown in the following table:\n\n+------+------------------------+-------------------------------------------------------------------------+\n| Name | Type                   | Description                                                             |\n+------+------------------------+-------------------------------------------------------------------------+\n| LA1  | Log Analytics workspace| Contains logs and metrics collected from all Azure resources and        |\n|      |                        | on-premises servers                                                     |\n| VM1  | Virtual machine        | Server that runs Windows Server 2019                                   |\n| VM2  | Virtual machine        | Server that runs Ubuntu 18.04 LTS                                      |\n+------+------------------------+-------------------------------------------------------------------------+\n\nCurrent Problems -\nCloud App Security frequently generates false positive alerts when users connect to both offices simultaneously.\n\nPlanned Changes and Requirements -\nPlanned Changes:\n• Create and configure Azure Sentinel in the Azure subscription.\n• Validate Azure Sentinel functionality by using Azure AD test user accounts.\n\nBusiness Requirements:\n• The principle of least privilege must be used whenever possible.\n• Costs must be minimized, as long as all other requirements are met.\n• Logs collected by Log Analytics must provide a full audit trail of user activities.\n• All domain controllers must be protected by using Microsoft Defender for Identity.\n\nAzure Information Protection Requirements:\n• All files that have security labels and are stored on the Windows 10 computers must be available from the Azure Information Protection Data discovery dashboard.\n\nMicrosoft Defender for Endpoint requirements:\n• All Cloud App Security unsanctioned apps must be blocked on the Windows 10 computers by using Microsoft Defender for Endpoint.\n\nMicrosoft Cloud App Security requirements:\n• Cloud App Security must identify whether a user connection is anomalous based on tenant-level data.\n\nAzure Defender Requirements:\n• All servers must send logs to the same Log Analytics workspace.\n\nAzure Sentinel Requirements:\nLitware must meet the following Azure Sentinel requirements:\n• Integrate Azure Sentinel and Cloud App Security.\n• Ensure that a user named admin1 can configure Azure Sentinel playbooks.\n• Create an Azure Sentinel analytics rule based on a custom query. The rule must automatically initiate the execution of a playbook.\n• Add notes to events that represent data access from a specific IP address to provide the ability to reference the IP address when navigating through an investigation graph while hunting.\n• Create a test rule that generates alerts when inbound access to Microsoft Office 365 by the Azure AD test user accounts is detected. Alerts generated by the rule must be grouped into individual incidents, with one incident per test user account.\n\nQuestion:\nWhich rule setting should you configure to meet the Azure Sentinel requirements?",
      "options": [
        "A. From Set rule logic, turn off suppression.",
        "B. From Analytics rule details, configure the tactics.",
        "C. From Set rule logic, map the entities.",
        "D. From Analytics rule details, configure the severity."
      ],
      "answer": "C. From Set rule logic, map the entities.",
      "explanation": "- Mapping entities (such as IP addresses, accounts, or resources) in the analytics rule logic is essential to allow event correlation in the investigation graph.\n- This is required to meet the Azure Sentinel requirement to *add notes to events that represent data access from a specific IP address and enable hunting in the investigation graph*.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/tutorial-detect-threats-custom"
    },
    {
      "type": "drag_and_drop",
      "question": "Introductory Info\nCase study -\nThis is a case study. Case studies are not timed separately. You can use as much exam time as you would like to complete each case. However, there may be additional case studies and sections on this exam. You must manage your time to ensure that you are able to complete all questions included on this exam in the time provided.\nTo answer the questions included in a case study, you will need to reference information that is provided in the case study. Case studies might contain exhibits and other resources that provide more information about the scenario that is described in the case study. Each question is independent of the other questions in this case study.\nAt the end of this case study, a review screen will appear. This screen allows you to review your answers and to make changes before you move to the next section of the exam. After you begin a new section, you cannot return to this section.\n\nTo start the case study -\nTo display the first question in this case study, click the Next button. Use the buttons in the left pane to explore the content of the case study before you answer the questions. Clicking these buttons displays information such as business requirements, existing environment, and problem statements. If the case study has an All Information tab, note that the information displayed is identical to the information displayed on the subsequent tabs. When you are ready to answer a question, click the Question button to return to the question.\n\nOverview -\nLitware Inc. is a renewable energy company.\nLitware has offices in Boston and Seattle. Litware also has remote users located across the United States. To access Litware resources, including cloud resources, the remote users establish a VPN connection to either office.\n\nExisting Environment -\nIdentity Environment -\nThe network contains an Active Directory forest named litware.com that syncs to an Azure Active Directory (Azure AD) tenant named litware.com.\n\nMicrosoft 365 Environment -\nLitware has a Microsoft 365 E5 subscription linked to the litware.com Azure AD tenant. Microsoft Defender for Endpoint is deployed to all computers that run Windows 10. All Microsoft Cloud App Security built-in anomaly detection policies are enabled.\n\nAzure Environment -\nLitware has an Azure subscription linked to the litware.com Azure AD tenant. The subscription contains resources in the East US Azure region as shown in the following table:\n\n+------+------------------------+-------------------------------------------------------------------------+\n| Name | Type                   | Description                                                             |\n+------+------------------------+-------------------------------------------------------------------------+\n| LA1  | Log Analytics workspace| Contains logs and metrics collected from all Azure resources and        |\n|      |                        | on-premises servers                                                     |\n| VM1  | Virtual machine        | Server that runs Windows Server 2019                                   |\n| VM2  | Virtual machine        | Server that runs Ubuntu 18.04 LTS                                      |\n+------+------------------------+-------------------------------------------------------------------------+\n\nNetwork Environment -\nEach Litware office connects directly to the internet and has a site-to-site VPN connection to the virtual networks in the Azure subscription.\n\nOn-premises Environment -\nThe on-premises network contains the computers shown in the following table:\n\n+------+------------------------+-------------------------------------------------------------------------+\n| Name | Type                   | Description                                                             |\n+------+------------------------+-------------------------------------------------------------------------+\n| LA1  | Log Analytics workspace| Contains logs and metrics collected from all Azure resources and        |\n|      |                        | on-premises servers                                                     |\n| VM1  | Virtual machine        | Server that runs Windows Server 2019                                   |\n| VM2  | Virtual machine        | Server that runs Ubuntu 18.04 LTS                                      |\n+------+------------------------+-------------------------------------------------------------------------+\n\nCurrent Problems -\nCloud App Security frequently generates false positive alerts when users connect to both offices simultaneously.\n\nPlanned Changes and Requirements -\nPlanned Changes:\n• Create and configure Azure Sentinel in the Azure subscription.\n• Validate Azure Sentinel functionality by using Azure AD test user accounts.\n\nBusiness Requirements:\n• The principle of least privilege must be used whenever possible.\n• Costs must be minimized, as long as all other requirements are met.\n• Logs collected by Log Analytics must provide a full audit trail of user activities.\n• All domain controllers must be protected by using Microsoft Defender for Identity.\n\nAzure Information Protection Requirements:\n• All files that have security labels and are stored on the Windows 10 computers must be available from the Azure Information Protection Data discovery dashboard.\n\nMicrosoft Defender for Endpoint requirements:\n• All Cloud App Security unsanctioned apps must be blocked on the Windows 10 computers by using Microsoft Defender for Endpoint.\n\nMicrosoft Cloud App Security requirements:\n• Cloud App Security must identify whether a user connection is anomalous based on tenant-level data.\n\nAzure Defender Requirements:\n• All servers must send logs to the same Log Analytics workspace.\n\nAzure Sentinel Requirements:\nLitware must meet the following Azure Sentinel requirements:\n• Integrate Azure Sentinel and Cloud App Security.\n• Ensure that a user named admin1 can configure Azure Sentinel playbooks.\n• Create an Azure Sentinel analytics rule based on a custom query. The rule must automatically initiate the execution of a playbook.\n• Add notes to events that represent data access from a specific IP address to provide the ability to reference the IP address when navigating through an investigation graph while hunting.\n• Create a test rule that generates alerts when inbound access to Microsoft Office 365 by the Azure AD test user accounts is detected. Alerts generated by the rule must be grouped into individual incidents, with one incident per test user account.\n\nQuestion:\nYou need to create the analytics rule to meet the Azure Sentinel requirements.\nWhat should you do? To answer, select the appropriate options in the answer area.\nNOTE: Each correct selection is worth one point.",
      "options": [
        "Fusion",
        "Microsoft incident creation",
        "Scheduled",
        "Diagnostics settings",
        "A service principal",
        "A trigger"
      ],
      "answer": [
        "Scheduled",
        "A trigger"
      ],
      "explanation": "To meet the Azure Sentinel requirements, you should use a **Scheduled** analytics rule, which allows you to define custom queries and create rules that run on a defined interval. To automatically initiate a playbook, you must define **a trigger**, which integrates the rule with an automation workflow (Logic App).\n\nReferences:\n- https://docs.microsoft.com/en-us/azure/sentinel/tutorial-detect-threats-custom#set-automated-responses-and-create-the-rule\n- https://docs.microsoft.com/en-us/azure/sentinel/tutorial-respond-threats-playbook",
      "image": "Images/hotspot148.png"
    },
    {
      "type": "drag_and_drop",
      "question": "Introductory Info\nCase study -\nThis is a case study. Case studies are not timed separately. You can use as much exam time as you would like to complete each case. However, there may be additional case studies and sections on this exam. You must manage your time to ensure that you are able to complete all questions included on this exam in the time provided.\nTo answer the questions included in a case study, you will need to reference information that is provided in the case study. Case studies might contain exhibits and other resources that provide more information about the scenario that is described in the case study. Each question is independent of the other questions in this case study.\nAt the end of this case study, a review screen will appear. This screen allows you to review your answers and to make changes before you move to the next section of the exam. After you begin a new section, you cannot return to this section.\n\nTo start the case study -\nTo display the first question in this case study, click the Next button. Use the buttons in the left pane to explore the content of the case study before you answer the questions. Clicking these buttons displays information such as business requirements, existing environment, and problem statements. If the case study has an All Information tab, note that the information displayed is identical to the information displayed on the subsequent tabs. When you are ready to answer a question, click the Question button to return to the question.\n\nOverview -\nLitware Inc. is a renewable energy company.\nLitware has offices in Boston and Seattle. Litware also has remote users located across the United States. To access Litware resources, including cloud resources, the remote users establish a VPN connection to either office.\n\nExisting Environment -\nIdentity Environment -\nThe network contains an Active Directory forest named litware.com that syncs to an Azure Active Directory (Azure AD) tenant named litware.com.\n\nMicrosoft 365 Environment -\nLitware has a Microsoft 365 E5 subscription linked to the litware.com Azure AD tenant. Microsoft Defender for Endpoint is deployed to all computers that run Windows 10. All Microsoft Cloud App Security built-in anomaly detection policies are enabled.\n\nAzure Environment -\nLitware has an Azure subscription linked to the litware.com Azure AD tenant. The subscription contains resources in the East US Azure region as shown in the following table:\n\n+------+------------------------+-------------------------------------------------------------------------+\n| Name | Type                   | Description                                                             |\n+------+------------------------+-------------------------------------------------------------------------+\n| LA1  | Log Analytics workspace| Contains logs and metrics collected from all Azure resources and        |\n|      |                        | on-premises servers                                                     |\n| VM1  | Virtual machine        | Server that runs Windows Server 2019                                   |\n| VM2  | Virtual machine        | Server that runs Ubuntu 18.04 LTS                                      |\n+------+------------------------+-------------------------------------------------------------------------+\n\nNetwork Environment -\nEach Litware office connects directly to the internet and has a site-to-site VPN connection to the virtual networks in the Azure subscription.\n\nOn-premises Environment -\nThe on-premises network contains the computers shown in the following table:\n\n+------+------------------------+-------------------------------------------------------------------------+\n| Name | Type                   | Description                                                             |\n+------+------------------------+-------------------------------------------------------------------------+\n| LA1  | Log Analytics workspace| Contains logs and metrics collected from all Azure resources and        |\n|      |                        | on-premises servers                                                     |\n| VM1  | Virtual machine        | Server that runs Windows Server 2019                                   |\n| VM2  | Virtual machine        | Server that runs Ubuntu 18.04 LTS                                      |\n+------+------------------------+-------------------------------------------------------------------------+\n\nCurrent Problems -\nCloud App Security frequently generates false positive alerts when users connect to both offices simultaneously.\n\nPlanned Changes and Requirements -\nPlanned Changes:\n• Create and configure Azure Sentinel in the Azure subscription.\n• Validate Azure Sentinel functionality by using Azure AD test user accounts.\n\nBusiness Requirements:\n• The principle of least privilege must be used whenever possible.\n• Costs must be minimized, as long as all other requirements are met.\n• Logs collected by Log Analytics must provide a full audit trail of user activities.\n• All domain controllers must be protected by using Microsoft Defender for Identity.\n\nAzure Information Protection Requirements:\n• All files that have security labels and are stored on the Windows 10 computers must be available from the Azure Information Protection Data discovery dashboard.\n\nMicrosoft Defender for Endpoint requirements:\n• All Cloud App Security unsanctioned apps must be blocked on the Windows 10 computers by using Microsoft Defender for Endpoint.\n\nMicrosoft Cloud App Security requirements:\n• Cloud App Security must identify whether a user connection is anomalous based on tenant-level data.\n\nAzure Defender Requirements:\n• All servers must send logs to the same Log Analytics workspace.\n\nAzure Sentinel Requirements:\nLitware must meet the following Azure Sentinel requirements:\n• Integrate Azure Sentinel and Cloud App Security.\n• Ensure that a user named admin1 can configure Azure Sentinel playbooks.\n• Create an Azure Sentinel analytics rule based on a custom query. The rule must automatically initiate the execution of a playbook.\n• Add notes to events that represent data access from a specific IP address to provide the ability to reference the IP address when navigating through an investigation graph while hunting.\n• Create a test rule that generates alerts when inbound access to Microsoft Office 365 by the Azure AD test user accounts is detected. Alerts generated by the rule must be grouped into individual incidents, with one incident per test user account.\n\nQuestion:\nYou need to configure the Azure Sentinel integration to meet the Azure Sentinel requirements.\nWhat should you do? To answer, select the appropriate options in the answer area.",
      "options": [
        "Add a security extension",
        "Configure app connectors",
        "Configure log collectors",
        "Add a data connector",
        "Add a workbook",
        "Configure the Logs settings"
      ],
      "answer": [
        "Add a security extension",
        "Add a data connector"
      ],
      "explanation": "- **Add a security extension**: This enables Microsoft Defender for Cloud Apps (MCAS) to integrate with Azure Sentinel via API/SIEM agent.\n- **Add a data connector**: This step is essential to ingest data from MCAS into Azure Sentinel. The MCAS activity logs are routed via the data connector.\n\nReferences:\n- https://docs.microsoft.com/en-us/defender-cloud-apps/siem-sentinel\n- https://docs.microsoft.com/en-us/cloud-app-security/siem-sentinel\n- https://learn.microsoft.com/en-us/azure/sentinel/data-connectors-reference#microsoft-defender-for-cloud-apps\n- https://techcommunity.microsoft.com/t5/microsoft-sentinel-blog/microsoft-cloud-app-security-mcas-activity-log-in-azure-sentinel/ba-p/1849806",
      "image": "Images/hotspot147.png"
    },
    {
      "type": "drag_and_drop",
      "question": "Introductory Info\nCase study -\nThis is a case study. Case studies are not timed separately. You can use as much exam time as you would like to complete each case. However, there may be additional case studies and sections on this exam. You must manage your time to ensure that you are able to complete all questions included on this exam in the time provided.\nTo answer the questions included in a case study, you will need to reference information that is provided in the case study. Case studies might contain exhibits and other resources that provide more information about the scenario that is described in the case study. Each question is independent of the other questions in this case study.\nAt the end of this case study, a review screen will appear. This screen allows you to review your answers and to make changes before you move to the next section of the exam. After you begin a new section, you cannot return to this section.\n\nTo start the case study -\nTo display the first question in this case study, click the Next button. Use the buttons in the left pane to explore the content of the case study before you answer the questions. Clicking these buttons displays information such as business requirements, existing environment, and problem statements. If the case study has an All Information tab, note that the information displayed is identical to the information displayed on the subsequent tabs. When you are ready to answer a question, click the Question button to return to the question.\n\nOverview -\nLitware Inc. is a renewable energy company.\nLitware has offices in Boston and Seattle. Litware also has remote users located across the United States. To access Litware resources, including cloud resources, the remote users establish a VPN connection to either office.\n\nExisting Environment -\nIdentity Environment -\nThe network contains an Active Directory forest named litware.com that syncs to an Azure Active Directory (Azure AD) tenant named litware.com.\n\nMicrosoft 365 Environment -\nLitware has a Microsoft 365 E5 subscription linked to the litware.com Azure AD tenant. Microsoft Defender for Endpoint is deployed to all computers that run Windows 10. All Microsoft Cloud App Security built-in anomaly detection policies are enabled.\n\nAzure Environment -\nLitware has an Azure subscription linked to the litware.com Azure AD tenant. The subscription contains resources in the East US Azure region as shown in the following table:\n\n+------+------------------------+-------------------------------------------------------------------------+\n| Name | Type                   | Description                                                             |\n+------+------------------------+-------------------------------------------------------------------------+\n| LA1  | Log Analytics workspace| Contains logs and metrics collected from all Azure resources and        |\n|      |                        | on-premises servers                                                     |\n| VM1  | Virtual machine        | Server that runs Windows Server 2019                                   |\n| VM2  | Virtual machine        | Server that runs Ubuntu 18.04 LTS                                      |\n+------+------------------------+-------------------------------------------------------------------------+\n\nNetwork Environment -\nEach Litware office connects directly to the internet and has a site-to-site VPN connection to the virtual networks in the Azure subscription.\n\nOn-premises Environment -\nThe on-premises network contains the computers shown in the following table:\n\n+------+------------------------+-------------------------------------------------------------------------+\n| Name | Type                   | Description                                                             |\n+------+------------------------+-------------------------------------------------------------------------+\n| LA1  | Log Analytics workspace| Contains logs and metrics collected from all Azure resources and        |\n|      |                        | on-premises servers                                                     |\n| VM1  | Virtual machine        | Server that runs Windows Server 2019                                   |\n| VM2  | Virtual machine        | Server that runs Ubuntu 18.04 LTS                                      |\n+------+------------------------+-------------------------------------------------------------------------+\n\nCurrent Problems -\nCloud App Security frequently generates false positive alerts when users connect to both offices simultaneously.\n\nPlanned Changes and Requirements -\nPlanned Changes:\n• Create and configure Azure Sentinel in the Azure subscription.\n• Validate Azure Sentinel functionality by using Azure AD test user accounts.\n\nBusiness Requirements:\n• The principle of least privilege must be used whenever possible.\n• Costs must be minimized, as long as all other requirements are met.\n• Logs collected by Log Analytics must provide a full audit trail of user activities.\n• All domain controllers must be protected by using Microsoft Defender for Identity.\n\nAzure Information Protection Requirements:\n• All files that have security labels and are stored on the Windows 10 computers must be available from the Azure Information Protection Data discovery dashboard.\n\nMicrosoft Defender for Endpoint requirements:\n• All Cloud App Security unsanctioned apps must be blocked on the Windows 10 computers by using Microsoft Defender for Endpoint.\n\nMicrosoft Cloud App Security requirements:\n• Cloud App Security must identify whether a user connection is anomalous based on tenant-level data.\n\nAzure Defender Requirements:\n• All servers must send logs to the same Log Analytics workspace.\n\nAzure Sentinel Requirements:\nLitware must meet the following Azure Sentinel requirements:\n• Integrate Azure Sentinel and Cloud App Security.\n• Ensure that a user named admin1 can configure Azure Sentinel playbooks.\n• Create an Azure Sentinel analytics rule based on a custom query. The rule must automatically initiate the execution of a playbook.\n• Add notes to events that represent data access from a specific IP address to provide the ability to reference the IP address when navigating through an investigation graph while hunting.\n• Create a test rule that generates alerts when inbound access to Microsoft Office 365 by the Azure AD test user accounts is detected. Alerts generated by the rule must be grouped into individual incidents, with one incident per test user account.\n\nQuestion:\nYou need to add notes to the events to meet the Azure Sentinel requirements.\nWhich three actions should you perform in sequence? To answer, move the appropriate actions from the list of actions to the answer area and arrange them in the correct order.",
      "options": [
        "Add a bookmark and map an entity.",
        "From Azure Monitor, run a Log Analytics query.",
        "Add the query to favorites.",
        "Select a query result.",
        "From the Azure Sentinel workspace, run a Log Analytics query."
      ],
      "answer": [
        "From the Azure Sentinel workspace, run a Log Analytics query.",
        "Select a query result.",
        "Add a bookmark and map an entity."
      ],
      "explanation": "- To meet the requirement of **adding notes to events** for investigation and entity mapping in Azure Sentinel:\n  1. **Run a Log Analytics query from within the Azure Sentinel workspace** to narrow down on events of interest.\n  2. **Select a query result** that represents the specific activity or access event.\n  3. **Add a bookmark and map an entity** to associate notes and context with that event for hunting and investigation.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/bookmarks",
      "image": "Images/hotspot146.png"
    },
    {
      "type": "drag_and_drop",
      "question": "Introductory Info\nCase study -\nThis is a case study. Case studies are not timed separately. You can use as much exam time as you would like to complete each case. However, there may be additional case studies and sections on this exam. You must manage your time to ensure that you are able to complete all questions included on this exam in the time provided.\nTo answer the questions included in a case study, you will need to reference information that is provided in the case study. Case studies might contain exhibits and other resources that provide more information about the scenario that is described in the case study. Each question is independent of the other questions in this case study.\nAt the end of this case study, a review screen will appear. This screen allows you to review your answers and to make changes before you move to the next section of the exam. After you begin a new section, you cannot return to this section.\n\nTo start the case study -\nTo display the first question in this case study, click the Next button. Use the buttons in the left pane to explore the content of the case study before you answer the questions. Clicking these buttons displays information such as business requirements, existing environment, and problem statements. If the case study has an All Information tab, note that the information displayed is identical to the information displayed on the subsequent tabs. When you are ready to answer a question, click the Question button to return to the question.\n\nOverview -\nA company named Contoso Ltd. has a main office and five branch offices located throughout North America. The main office is in Seattle. The branch offices are in Toronto, Miami, Houston, Los Angeles, and Vancouver.\nContoso has a subsidiary named Fabrikam, Ltd. that has offices in New York and San Francisco.\n\nExisting Environment -\n\nEnd-User Environment -\nAll users at Contoso use Windows 10 devices. Each user is licensed for Microsoft 365. In addition, iOS devices are distributed to the members of the sales team at Contoso.\n\nCloud and Hybrid Infrastructure -\nAll Contoso applications are deployed to Azure.\nYou enable Microsoft Cloud App Security.\nContoso and Fabrikam have different Azure Active Directory (Azure AD) tenants. Fabrikam recently purchased an Azure subscription and enabled Azure Defender for all supported resource types.\n\nCurrent Problems -\nThe security team at Contoso receives a large number of cybersecurity alerts. The security team spends too much time identifying which cybersecurity alerts are legitimate threats, and which are not.\nThe Contoso sales team uses only iOS devices. The sales team members exchange files with customers by using a variety of third-party tools. In the past, the sales team experienced phishing attacks on their devices.\nThe marketing team at Contoso has several Microsoft SharePoint Online sites for collaborating with external vendors. The marketing team has had several incidents in which vendors uploaded files that contain malware.\nThe executive team at Contoso suspects a security breach. The executive team requests that you identify which files had more than five activities during the past 48 hours, including data access, download, or deletion for Microsoft Cloud App Security-protected applications.\n\nRequirements -\n\nPlanned Changes -\nContoso plans to integrate the security operations of both companies and manage all security operations centrally.\n\nTechnical Requirements -\nContoso identifies the following technical requirements:\n• Receive alerts if an Azure virtual machine is under brute force attack.\n• Use Azure Sentinel to reduce organizational risk by rapidly remediating active attacks on the environment.\n• Implement Azure Sentinel queries that correlate data across the Azure AD tenants of Contoso and Fabrikam.\n• Develop a procedure to remediate Azure Defender for Key Vault alerts for Contoso in case of external and internal threats. The solution must minimize the impact on legitimate attempts to access the key vault content.\n• Identify all cases of users who failed to sign in to an Azure resource for the first time from a given country. A junior security administrator provides you with the following incomplete query:\n\nBehaviorAnalytics\n| where ActivityType == \"FailedLogOn\"\n| where ________ == True\n\nYou need to implement Azure Sentinel queries for Contoso and Fabrikam to meet the technical requirements.\nWhat should you include in the solution? To answer, select the appropriate options in the answer area.\nNOTE: Each correct selection is worth one point.",
      "options": [
        "0",
        "1",
        "2",
        "3",
        "extend",
        "project",
        "workspace"
      ],
      "answer": [
        "1",
        "workspace"
      ],
      "explanation": "- To query across **multiple Azure Sentinel workspaces or tenants**, you use the `workspace()` function in KQL.\n- The number `1` indicates querying **1 external workspace** in addition to the default.\n- This setup helps meet the requirement of correlating data between Contoso and Fabrikam tenants.\n\nReference: https://docs.microsoft.com/en-us/azure/sentinel/extend-sentinel-across-workspaces-tenants#cross-workspace-workbooks",
      "image": "Images/hotspot145.png"
    },
    {
      "type": "drag_and_drop",
      "question": "Introductory Info\nCase study -\nThis is a case study. Case studies are not timed separately. You can use as much exam time as you would like to complete each case. However, there may be additional case studies and sections on this exam. You must manage your time to ensure that you are able to complete all questions included on this exam in the time provided.\nTo answer the questions included in a case study, you will need to reference information that is provided in the case study. Case studies might contain exhibits and other resources that provide more information about the scenario that is described in the case study. Each question is independent of the other questions in this case study.\nAt the end of this case study, a review screen will appear. This screen allows you to review your answers and to make changes before you move to the next section of the exam. After you begin a new section, you cannot return to this section.\n\nTo start the case study -\nTo display the first question in this case study, click the Next button. Use the buttons in the left pane to explore the content of the case study before you answer the questions. Clicking these buttons displays information such as business requirements, existing environment, and problem statements. If the case study has an All Information tab, note that the information displayed is identical to the information displayed on the subsequent tabs. When you are ready to answer a question, click the Question button to return to the question.\n\nOverview -\nA company named Contoso Ltd. has a main office and five branch offices located throughout North America. The main office is in Seattle. The branch offices are in Toronto, Miami, Houston, Los Angeles, and Vancouver.\nContoso has a subsidiary named Fabrikam, Ltd. that has offices in New York and San Francisco.\n\nExisting Environment -\n\nEnd-User Environment -\nAll users at Contoso use Windows 10 devices. Each user is licensed for Microsoft 365. In addition, iOS devices are distributed to the members of the sales team at Contoso.\n\nCloud and Hybrid Infrastructure -\nAll Contoso applications are deployed to Azure.\nYou enable Microsoft Cloud App Security.\nContoso and Fabrikam have different Azure Active Directory (Azure AD) tenants. Fabrikam recently purchased an Azure subscription and enabled Azure Defender for all supported resource types.\n\nCurrent Problems -\nThe security team at Contoso receives a large number of cybersecurity alerts. The security team spends too much time identifying which cybersecurity alerts are legitimate threats, and which are not.\nThe Contoso sales team uses only iOS devices. The sales team members exchange files with customers by using a variety of third-party tools. In the past, the sales team experienced phishing attacks on their devices.\nThe marketing team at Contoso has several Microsoft SharePoint Online sites for collaborating with external vendors. The marketing team has had several incidents in which vendors uploaded files that contain malware.\nThe executive team at Contoso suspects a security breach. The executive team requests that you identify which files had more than five activities during the past 48 hours, including data access, download, or deletion for Microsoft Cloud App Security-protected applications.\n\nRequirements -\n\nPlanned Changes -\nContoso plans to integrate the security operations of both companies and manage all security operations centrally.\n\nTechnical Requirements -\nContoso identifies the following technical requirements:\n• Receive alerts if an Azure virtual machine is under brute force attack.\n• Use Azure Sentinel to reduce organizational risk by rapidly remediating active attacks on the environment.\n• Implement Azure Sentinel queries that correlate data across the Azure AD tenants of Contoso and Fabrikam.\n• Develop a procedure to remediate Azure Defender for Key Vault alerts for Contoso in case of external and internal threats. The solution must minimize the impact on legitimate attempts to access the key vault content.\n• Identify all cases of users who failed to sign in to an Azure resource for the first time from a given country. A junior security administrator provides you with the following incomplete query:\n\nBehaviorAnalytics\n| where ActivityType == \"FailedLogOn\"\n| where ________ == True\n\nQuestion:\nYou need to create an advanced hunting query to investigate the executive team issue.\nHow should you complete the query? To answer, select the appropriate options in the answer area.\nNOTE: Each correct selection is worth one point.",
      "options": [
        "avg()",
        "count()",
        "sum()",
        "CloudAppEvents",
        "DeviceFileEvents",
        "DeviceProcessEvents"
      ],
      "answer": [
        "DeviceFileEvents",
        "count()"
      ],
      "explanation": "- **DeviceFileEvents** is the appropriate table to use in Microsoft Defender for Endpoint's Advanced Hunting when investigating file-related activity such as access, download, or deletion.\n- **count()** is used to calculate how many times the specified activity occurred. This satisfies the requirement to find files with more than five activities.\n\nReference: https://docs.microsoft.com/en-us/microsoft-365/security/defender/advanced-hunting-devicefileevents-table?view=o365-worldwide",
      "image": "hotspot144.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You need to implement Azure Defender to meet the Azure Defender requirements and the business requirements.\nWhat should you include in the solution? To answer, select the appropriate options in the answer area.\nNOTE: Each correct selection is worth one point.\n\nCase Study Context:\nLitware Inc. has domain controllers and servers in an Azure subscription. All servers must send logs to the same Log Analytics workspace.\nAzure Defender (Defender for Cloud) must be used, while minimizing cost and ensuring centralized auditing of user activities.\nThere is an existing Log Analytics workspace named LA1 in the East US region.\n\nQuestion:\nSelect the appropriate Log Analytics workspace and the event collection tier to meet both security and cost-efficiency requirements.",
      "options": [
        "A new Log Analytics workspace in the East US Azure region",
        "Default workspace created by Azure Security Center",
        "LA1",
        "All Events",
        "Common",
        "Minimal"
      ],
      "answer": [
        "LA1",
        "Common"
      ],
      "explanation": "- **LA1** is the existing Log Analytics workspace already configured to receive logs from Azure and on-premises resources. Reusing it aligns with the requirement to centralize logging and minimize cost.\n- **Common** is the appropriate event collection tier for Azure Defender when the goal is to balance audit detail and storage cost. It collects critical security logs without the cost of ingesting all events.\n\nReference: https://docs.microsoft.com/en-us/azure/sentinel/windows-security-event-id-reference",
      "image": "Images/hotspot143.jpg"
    },
    {
      "type": "drag_and_drop",
      "question": "Introductory Info\nCase study -\nThis is a case study. Case studies are not timed separately. You can use as much exam time as you would like to complete each case. However, there may be additional case studies and sections on this exam. You must manage your time to ensure that you are able to complete all questions included on this exam in the time provided.\nTo answer the questions included in a case study, you will need to reference information that is provided in the case study. Case studies might contain exhibits and other resources that provide more information about the scenario that is described in the case study. Each question is independent of the other questions in this case study.\nAt the end of this case study, a review screen will appear. This screen allows you to review your answers and to make changes before you move to the next section of the exam. After you begin a new section, you cannot return to this section.\n\nTo start the case study -\nTo display the first question in this case study, click the Next button. Use the buttons in the left pane to explore the content of the case study before you answer the questions. Clicking these buttons displays information such as business requirements, existing environment, and problem statements. If the case study has an All Information tab, note that the information displayed is identical to the information displayed on the subsequent tabs. When you are ready to answer a question, click the Question button to return to the question.\n\nOverview -\nLitware Inc. is a renewable energy company.\nLitware has offices in Boston and Seattle. Remote users across the United States access Litware resources, including cloud resources, by establishing VPN connections to either office.\n\nExisting Environment -\nLitware uses an on-premises Active Directory domain (litware.com) synchronized with Azure AD. All Windows 10 computers are protected by Microsoft Defender for Endpoint.\nAll built-in anomaly detection policies in Microsoft Cloud App Security are enabled.\n\nThe Azure subscription contains:\n- Log Analytics workspace (LA1)\n- Windows Server VM (VM1)\n- Ubuntu VM (VM2)\n\nThe domain controller (DC1) is in the Boston office and connects directly to the internet.\n\nRequirements:\n- All domain controllers must be protected using Microsoft Defender for Identity (MDI).\n- Logs must go to a centralized Log Analytics workspace.\n\nQuestion:\nYou need to configure DC1 to meet the business requirements.\nWhich four actions should you perform in sequence? To answer, move the appropriate actions from the list of actions to the answer area and arrange them in the correct order.",
      "options": [
        "Provide domain administrator credentials to the litware.com Active Directory domain.",
        "Create an instance of Microsoft Defender for Identity.",
        "Provide global administrator credentials to the litware.com Azure AD tenant.",
        "Install the sensor on DC1.",
        "Install the standalone sensor on DC1."
      ],
      "answer": [
        "Create an instance of Microsoft Defender for Identity.",
        "Provide global administrator credentials to the litware.com Azure AD tenant.",
        "Provide domain administrator credentials to the litware.com Active Directory domain.",
        "Install the sensor on DC1."
      ],
      "explanation": "- **Step 1**: Creating an instance of Microsoft Defender for Identity is required to initialize the integration.\n- **Step 2**: Providing global admin credentials links Azure AD and allows synchronization.\n- **Step 3**: Domain admin credentials are required to authorize sensor deployment.\n- **Step 4**: The sensor is installed on the domain controller (DC1), not the standalone sensor, since this is a domain-joined machine.\n\n**Reference**: https://learn.microsoft.com/en-us/defender-for-identity/install-step1",
      "image": "Images/hotspot142.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft Sentinel workbook that contains the following KQL query:\n\n```kql\nlet nonInteractive = AADNonInteractiveUserSignInLogs\n| extend Status = parse_json(Status);\nunion SigninLogs, nonInteractive\n| extend ErrorCode = tostring(Status.errorCode)\n| extend FailureReason = tostring(Status.failureReason)\n| summarize errCount = count() by ErrorCode, FailureReason, Category\n```\n\nYou need to create a visual that will change the color of the `errCount` column based on the value returned.\n\nHow should you configure the visual? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "Graph",
        "Grid",
        "Text",
        "Big number",
        "Heatmap",
        "Text",
        "Thresholds"
      ],
      "answer": [
        "Grid",
        "Heatmap"
      ],
      "explanation": "- **Grid** visualization is ideal for displaying tabular data returned from a query. It allows each column (like `errCount`) to be styled based on rules.\n\n- **Heatmap** styling (applied within the Grid visual settings) allows you to **dynamically color the column cells** based on their numeric value (e.g., higher `errCount` gets more intense coloring).\n\nThis combination allows fast visual triage of high-error categories directly in the workbook.\n\nReferences:\nhttps://learn.microsoft.com/en-us/azure/azure-monitor/visualize/workbooks-grid-visualizations\nhttps://learn.microsoft.com/en-us/azure/azure-monitor/visualize/workbooks-grid-visualizations#style-a-grid-column",
      "image": "Images/hotspot141.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have an Azure subscription that contains a Microsoft Sentinel workspace.\n\nYou need to create and customize a workbook for the Microsoft Entra ID Audit Logs.\n\nWhich three actions should you perform in sequence? To answer, move the appropriate actions from the list of actions to the answer area and arrange them in the correct order.",
      "options": [
        "From Workbooks, select Microsoft Entra ID Audit logs and then select Save.",
        "From Content hub, install the Microsoft Entra ID solution.",
        "From Workbooks, select Microsoft Entra ID Audit logs and then select View saved workbook.",
        "Enable Workspace manager.",
        "From Workbooks, select Microsoft Entra ID Audit logs and then select View Template.",
        "Configure a Data connector."
      ],
      "answer": [
        "From Content hub, install the Microsoft Entra ID solution.",
        "Configure a Data connector.",
        "From Workbooks, select Microsoft Entra ID Audit logs and then select View saved workbook."
      ],
      "explanation": "- **Step 1: From Content hub, install the Microsoft Entra ID solution.** This adds prebuilt content such as connectors, workbooks, and analytic rules to your Sentinel workspace.\n\n- **Step 2: Configure a Data connector.** This enables data ingestion from Microsoft Entra ID Audit Logs into Sentinel so the workbook has data to visualize.\n\n- **Step 3: From Workbooks, select Microsoft Entra ID Audit logs and then select View saved workbook.** This lets you view and customize the deployed workbook using actual ingested data.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/connect-azure-active-directory",
      "image": "Images/hotspot140.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft 365 E5 subscription that uses Microsoft Defender XDR.\n\nYou discover a malicious process that was initiated by a file named File1.exe on a device named Device1.\n\nYou need to create a KQL query that will identify when File1.exe was created. The solution must meet the following requirements:\n\n• Return the FileName, InitiatingProcessFileName, and InitiatingProcessCommandLine columns.\n• Minimize the volume of data returned.\n\nHow should you complete the query? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "| extend",
        "| project-keep",
        "| project-away",
        "| render",
        "DeviceEvents",
        "DeviceFileEvents",
        "DeviceInfo",
        "DeviceProcessEvents",
        "DeviceRegistryEvents"
      ],
      "answer": [
        "DeviceFileEvents",
        "| project-keep"
      ],
      "explanation": "- **DeviceFileEvents** is the correct table to query when investigating file creation activities. It includes data on file writes, creation, and modifications tracked by Defender XDR sensors.\n\n- **`| project-keep`** returns only the specified columns (`FileName`, `InitiatingProcessFileName`, and `InitiatingProcessCommandLine`) while preserving the rest of the record structure — useful when you want to minimize data size but retain critical identifiers.\n\nOther tables like `DeviceProcessEvents` or `DeviceEvents` are useful for process execution, but not specific to file creation. `| render` is for visualizations and not relevant here.\n\nReference: https://learn.microsoft.com/en-us/defender-xdr/advanced-hunting-devicefileevents-table",
      "image": "Images/hotspot139.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft 365 E5 subscription that uses Microsoft Defender for Office 365.\n\nYou need to build a hunting query that will list events involving potentially malicious emails that were detected but NOT removed successfully from mailboxes after delivery. The solution must ensure that the events are correlated with the sign-in events of the email recipients.\n\nHow should you complete the query? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "AccountObjectId",
        "AccountSid",
        "AccountUpn",
        "\"AIR\"",
        "\"XDR\"",
        "\"ZAP\""
      ],
      "answer": [
        "\"ZAP\"",
        "AccountUpn"
      ],
      "explanation": "- **\"ZAP\"** (Zero-hour Auto Purge) is the filtering action used by Microsoft Defender for Office 365 to retroactively remove malicious emails. Selecting `\"ZAP\"` in the query context ensures you are identifying messages that were detected *but not successfully purged*.\n\n- **AccountUpn** is the correct field to correlate email event data with sign-in logs because it represents the user principal name (email address) of the recipient.\n\n- `AccountObjectId` and `AccountSid` are more commonly used with identity providers or legacy systems, not for direct correlation with mailbox delivery and Defender alerts.\n\nReference: https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/zero-hour-auto-purge?view=o365-worldwide",
      "image": "Images/hotspot138.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft 365 E5 subscription that uses Microsoft Exchange Online.\n\nYou identify the suspicious emails shown in the following table.\n\nIn Microsoft Purview, you create the content searches shown in the following table.\n\nFor each of the following statements, select Yes if the statement is true. Otherwise, select No.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "Yes",
        "No"
      ],
      "answer": [
        "Yes",
        "Yes",
        "Yes"
      ],
      "explanation": "Each of the content searches is configured using valid KQL syntax and filters that can match the respective suspicious emails. Microsoft Purview Content Search allows filtering based on fields such as `Subject`, `Sender`, `Recipients`, `MessageKind`, and `attachment` criteria. These can be combined effectively to identify messages matching phishing or suspicious patterns.\n\nThe results indicate all three searches were configured correctly to detect the listed suspicious items.\n\nReference: https://learn.microsoft.com/en-us/purview/ediscovery-keyword-queries-and-search-conditions",
      "image": "Images/hotspot137.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft 365 subscription that contains a Windows device named Device1. Device1 is onboarded to Microsoft Defender for Endpoint.\n\nYou initiate a live response session on Device1.\n\nYou need to execute a long running script. The solution must ensure that you can run additional commands during the session while the script is running.\n\nHow should you complete the live response command? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "fg",
        "isolate",
        "library",
        "run",
        "&",
        "$",
        "|",
        "!"
      ],
      "answer": [
        "library",
        "&"
      ],
      "explanation": "- **`library`**: Specifies the script source to run from your library in Microsoft Defender for Endpoint Live Response.\n\n- **`&`**: When appended to the command (e.g., `run script.ps1 &`), it executes the script **asynchronously**, allowing you to continue running other commands in the session.\n\nThis is the correct way to handle long-running scripts during Live Response.\n\nReference: https://learn.microsoft.com/en-us/defender-endpoint/live-response",
      "image": "Images/hotspot136.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have an Azure subscription.\n\nYou have a Microsoft Sentinel workbook that contains the following text parameters:\n\n• text1\n• grouptime1\n\nYou need to display the count of security alerts. The count must be filtered based on the text1 parameter and grouped by the grouptime1 parameter.\n\nHow should you complete the KQL query? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "{{grouptime1}})",
        "<grouptime1>)",
        "“{{grouptime1}}”)",
        "“<grouptime1>”)",
        "{{text1}}",
        "<text1>",
        "“{{text1}}”",
        "“<text1>”"
      ],
      "answer": [
        "{{text1}}",
        "{{grouptime1}})"
      ],
      "explanation": "- **`{{text1}}`** and **`{{grouptime1}}`** are escaped placeholders used in Python strings to prevent `str.format()` from interpreting them as variables.\n\n- Microsoft Sentinel workbooks use `{parameterName}` to dynamically inject parameter values, but in Python, this must be escaped as `{{parameterName}}` to remain literal.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/visualize-data#use-parameters-in-kql-queries",
      "image": "Images/hotspot135.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You need to build a KQL query in a Microsoft Sentinel workspace. The query must return the SecurityEvent record for accounts that have the last record with an EventID value of 4624.\n\nHow should you complete the query? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "| summarize arg_max(TimeGenerated, *) by Account",
        "| summarize make_list(Account) by EventID",
        "| summarize make_set(Account) by EventID",
        "| where EventID == 4624"
      ],
      "answer": [
        "| where EventID == 4624",
        "| summarize arg_max(TimeGenerated, *) by Account"
      ],
      "explanation": "- **`| where EventID == 4624`** filters the SecurityEvent table for successful logon events.\n\n- **`| summarize arg_max(TimeGenerated, *) by Account`** returns the most recent logon event per account, based on the `TimeGenerated` field. `arg_max()` is ideal when you want the full record of the latest event.\n\nThis combination fulfills the requirement to retrieve the most recent successful logon per user.\n\nReference: https://learn.microsoft.com/en-us/azure/data-explorer/kusto/query/arg-max-aggfunction",
      "image": "Images/hotspot134.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft Sentinel workspace that contains a custom workbook named Workbook1.\n\nYou need to create a visual in Workbook1 that will display the logon count for accounts that have logon event IDs of 4624 and 4634.\n\nHow should you complete the query? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "join",
        "project",
        "summarize",
        "union",
        "full",
        "inner",
        "left",
        "right"
      ],
      "answer": [
        "join",
        "inner"
      ],
      "explanation": "- **`join`** is the correct KQL operator when you want to correlate data between two sets — in this case, logon (`4624`) and logoff (`4634`) events.\n\n- **`inner`** is the most common join kind when you're only interested in rows that exist in both datasets — meaning accounts that had both a logon and a logoff.\n\nThis combination enables visualization of correlated logon activity by account in a concise way.\n\nReference: https://learn.microsoft.com/en-us/azure/data-explorer/kusto/query/joinoperator",
      "image": "Images/hotspot133.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft Sentinel workspace that contains a custom workbook.\n\nYou need to query for a summary of security events. The solution must meet the following requirements:\n\n• Identify the number of security events ingested during the past week.\n• Display the count of events by day in a chart.\n\nHow should you complete the query? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "bin",
        "coalesce",
        "extract",
        "max_of",
        "Account",
        "EventID",
        "ProcessId",
        "TimeGenerated"
      ],
      "answer": [
        "bin",
        "TimeGenerated"
      ],
      "explanation": "- **`bin`** is used in KQL to group data into buckets, especially when visualizing time series data. It’s the best choice for summarizing counts by time intervals (like per day).\n\n- **`TimeGenerated`** is the standard timestamp field in Microsoft Sentinel and Log Analytics tables, used to track when the data/event was ingested or occurred. It's necessary for time-based grouping and filtering.\n\nReference: https://learn.microsoft.com/en-us/azure/data-explorer/kusto/query/binfunction",
      "image": "Images/hotspot132.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft Sentinel workspace.\n\nYou plan to visualize data from Microsoft SharePoint Online and OneDrive sites.\n\nYou need to create a KQL query for the visual. The solution must meet the following requirements:\n\n• Select all workloads as a single operation.\n• Include two parameters named Operations and Users.\n• In the results, exclude empty values for the site URLs.\n\nHow should you complete the query? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "| where Operation in (({{Operations}}))",
        "| where Operation in ({{Operations}})",
        "| where (\"{{Operations}}\"==\"AH\" or {{Operations}})",
        "| where \"{{Operations:lable}}\" == \"AH\" or Operation in (({{Operations}}))",
        "| project Site_Url",
        "| where Operation != \"",
        "| where SiteUrl != \"",
        "| where SiteUrl =~ \""
      ],
      "answer": [
        "| where Operation in ({{Operations}})",
        "| project Site_Url"
      ],
      "explanation": "- **`| where Operation in ({{Operations}})`**: This safely uses a dynamic parameter in a way that avoids Python or templating conflicts. It allows KQL to match a list of values provided at runtime.\n\n- **`| project Site_Url`**: Filters the output to only include site URLs, inherently excluding null or empty values.\n\nEscaping the curly braces ensures compatibility with template engines and editors without altering the query logic.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/visualize-data#use-parameters-in-kql-queries",
      "image": "Images/hotspot131.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft 365 subscription.\n\nYou need to identify all the security principals that submitted requests to change or delete groups.\n\nHow should you complete the KQL query? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "RequestUri",
        "Scopes",
        "Type",
        "\"GET\"",
        "\"POST\"",
        "\"PUT\""
      ],
      "answer": [
        "RequestUri",
        "\"GET\""
      ],
      "explanation": "- To filter Microsoft 365 audit logs or diagnostic logs related to group operations, the `RequestUri` field is used to identify the REST API path accessed. For example, changes to groups typically involve URIs like `/groups`.\n\n- GET is used to **retrieve** group data, while `POST`, `PUT`, or `DELETE` are used for **creating, updating, or deleting** groups. However, in this context (auditing **requests** that may imply **change/delete** operations), a review of the `GET` requests and subsequent correlated actions may be required depending on the audit system and granularity of logs.\n\nReference: https://learn.microsoft.com/en-us/graph/api/resources/auditlogsignins?view=graph-rest-1.0",
      "image": "Images/hotspot130.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft Sentinel workspace named SW1.\n\nIn SW1, you enable User and Entity Behavior Analytics (UEBA).\n\nYou need to use KQL to perform the following tasks:\n\n• View the entity data that has fields for each type of entity.\n• Assess the quality of rules by analyzing how well a rule performs.\n\nWhich table should you use in KQL for each task? To answer, drag the appropriate tables to the correct tasks. Each table may be used once, more than once, or not at all. You may need to drag the split bar between panes or scroll to view content.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "Anomalies",
        "AuditLogs",
        "AzureDiagnostics",
        "BehaviorAnalytics",
        "CommonSecurityLog"
      ],
      "answer": [
        "BehaviorAnalytics",
        "Anomalies"
      ],
      "explanation": "- **BehaviorAnalytics**: This table contains normalized data for each type of entity (such as users, hosts, IPs) used by UEBA. It helps in viewing detailed entity information across telemetry sources.\n\n- **Anomalies**: This table captures anomalous behavior detected by UEBA rules. It is the appropriate table to assess rule quality, such as frequency, scope, and detection performance.\n\nOther tables like `AuditLogs`, `AzureDiagnostics`, and `CommonSecurityLog` are important for general security and audit logging but not specific to UEBA analytics tasks.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/ueba-reference#tables",
      "image": "Images/hotspot129.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have an Azure subscription that contains a user named User1 and a Microsoft Sentinel workspace named WS1.\n\nYou need to ensure that User1 can enable User and Entity Behavior Analytics (UEBA) for WS1. The solution must follow the principle of least privilege.\n\nWhich roles should you assign to User1? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "Global Administrator",
        "Security Administrator",
        "Security Operator",
        "Contributor",
        "Microsoft Sentinel Contributor",
        "Microsoft Sentinel Automation Contributor"
      ],
      "answer": [
        "Security Administrator",
        "Microsoft Sentinel Contributor"
      ],
      "explanation": "To enable UEBA in Microsoft Sentinel, the user must have:\n\n- **Microsoft Sentinel Contributor**: Provides access to Microsoft Sentinel features like enabling UEBA.\n- **Security Administrator**: Required to enable UEBA because it grants permission to configure security-related features.\n\nOther roles such as Security Operator or Automation Contributor do not provide sufficient permissions, and Global Administrator exceeds the least privilege principle.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/enable-entity-behavior-analytics#prerequisites",
      "image": "Images/hotspot128.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have an Azure subscription that contains a user named User1 and a Microsoft Sentinel workspace named WS1.\n\nYou deploy Advanced Security Information Model (ASIM) authentication parsers to WS1.\n\nYou need to use the parsers to query the authentication events generated by User1 during the last 24 hours. The solution must maximize the performance of the query.\n\nHow should you complete the query? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "ASimAuthentication (",
        "identityInfo (",
        "imAuthentication (",
        "contains",
        "has",
        "targetusername_has"
      ],
      "answer": [
        "imAuthentication (",
        "targetusername_has"
      ],
      "explanation": "`imAuthentication` is the ASIM normalized function used to query authentication events across multiple data sources efficiently in Microsoft Sentinel.\n\nTo optimize performance and align with Kusto query best practices for text fields, `targetusername_has` is preferred over `has` or `contains` for partial matching against the `TargetUsername` field.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/normalization-schema-authentication",
      "image": "Images/hotspot127.png"
    },
    {
      "type": "drag_and_drop",
      "question": "HOTSPOT\n\nYou have a Microsoft 365 E5 subscription that contains a Microsoft SharePoint Online site named Site1.\n\nIn Site1, you identify the suspicious files shown in the following table:\n\n| Name       | Author               |\n|------------|----------------------|\n| File1.docx | user1@contoso.com    |\n| File2.docx | user2@contoso.com    |\n| File3.docx | user3@contoso.com    |\n\nIn Microsoft Purview, you create the content searches shown in the following table:\n\n| Name    | Location          | Query                                                                 |\n|---------|-------------------|------------------------------------------------------------------------|\n| Search1 | SharePoint sites  | (c:c)(-ItemClass=IPM.Document)(FileName=File1.docx)                   |\n| Search2 | SharePoint sites  | (c:c)(filetype=doc)(author=User2@contoso.com)                         |\n| Search3 | SharePoint sites  | (c:c)(contenttype:item document)(author=User3@contoso.com)            |\n\nFor each of the following statements, select Yes if the statement is true. Otherwise, select No.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "Yes",
        "No"
      ],
      "answer": [
        "No",
        "Yes",
        "Yes"
      ],
      "explanation": "- **Search1** uses `-ItemClass=IPM.Document` which *excludes* standard Office documents like `File1.docx`. Therefore, **File1 will not be matched**.\n\n- **Search2** targets `.doc` files by file type and matches **user2@contoso.com** via the `author` field — **correctly finds File2.docx**.\n\n- **Search3** uses `contenttype:item document` and an author match — it is a valid and correct query syntax, and it will match **File3.docx**.\n\nReference: https://learn.microsoft.com/en-us/purview/ediscovery-keyword-queries-and-search-conditions",
      "image": "Images/hotspot126.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have an Azure subscription named Sub1 that is linked to a Microsoft Entra tenant named contoso.com. Sub1 contains a Log Analytics workspace named Workspace1. All the logs from contoso.com are streamed to Workspace1.\n\nYou have a Microsoft 365 E5 subscription.\n\nYou need to query Workspace1 for the following:\n\n• HTTP requests to the Microsoft Graph service of contoso.com\n• Third-party app sign-in activities that use certificates or secrets\n\nHow should you complete the KQL query? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "AADNonInteractiveUserSignInLogs",
        "AADServicePrincipalSignInLogs",
        "SigninLogs",
        "CorrelationId",
        "ServicePrincipalId",
        "UniqueTokenIdentifier"
      ],
      "answer": [
        "AADServicePrincipalSignInLogs",
        "UniqueTokenIdentifier"
      ],
      "explanation": "To detect third-party app sign-ins using client credentials (secrets or certificates), logs are captured in the `AADServicePrincipalSignInLogs` table, not in `SigninLogs` or `AADNonInteractiveUserSignInLogs`, which are used for user accounts.\n\n`UniqueTokenIdentifier` helps trace requests tied to tokens, especially relevant in service principal sign-ins for Microsoft Graph access.\n\nReference: https://learn.microsoft.com/en-us/graph/microsoft-graph-activity-logs-overview",
      "image": "Images/hotspot125.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have an Azure subscription named Sub1 that is linked to a Microsoft Entra tenant named contoso.com. Sub1 contains a Log Analytics workspace named Workspace1. All the logs from contoso.com are streamed to Workspace1.\n\nYou have a Microsoft 365 E5 subscription.\n\nYou need to query Workspace1 for the following:\n\n• HTTP requests to the Microsoft Graph service of contoso.com\n• Third-party app sign-in activities that use certificates or secrets\n\nHow should you complete the KQL query? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "AADNonInteractiveUserSignInLogs",
        "AADServicePrincipalSignInLogs",
        "SigninLogs",
        "CorrelationId",
        "ServicePrincipalId",
        "UniqueTokenIdentifier"
      ],
      "answer": [
        "AADServicePrincipalSignInLogs",
        "UniqueTokenIdentifier"
      ],
      "explanation": "To track service principal sign-ins (e.g., third-party apps using client credentials), the correct table is `AADServicePrincipalSignInLogs`.\n\nTo uniquely correlate requests or sessions, `UniqueTokenIdentifier` is used as a traceable field in Microsoft Graph activity logs.\n\nReference: https://learn.microsoft.com/en-us/graph/microsoft-graph-activity-logs-overview",
      "image": "Images/hotspot125.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have the Azure subscriptions shown in the following table.\n\n| Name  | Role                 |\n|-------|----------------------|\n| User1 | Security Operator    |\n| User2 | Security Administrator |\n| User3 | Global Administrator |\n\nYou have a Microsoft Entra tenant that contains the users shown in the following table.\n\n| User  | Role   | Scope |\n|-------|--------|-------|\n| User1 | Owner  | Sub1  |\n| User2 | Reader | Sub2  |\n| User3 | Owner  | RG2   |\n\nThe users have the Azure roles shown in the following table.\n\n| Name | Resource group |\n|------|----------------|\n| Sub1 | RG1            |\n| Sub2 | RG2, RG3       |\n\nYou configure Microsoft Copilot for Security capacities as shown in the following table.\n\nFor each of the following statements, select Yes if the statement is true. Otherwise, select No.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "Yes",
        "No"
      ],
      "answer": [
        "Yes",
        "Yes",
        "No"
      ],
      "explanation": "In Microsoft Copilot for Security, access to data and Copilot capabilities depends on a combination of Azure RBAC roles, Entra ID roles, and Copilot for Security roles.\n\n- **User1** is an Owner on Sub1 (which contains RG1), and is a Security Operator. This allows sufficient access for data ingestion and plugin interaction via Copilot.\n- **User2** is a Reader on Sub2 (containing RG2 and RG3), and is a Security Administrator. This combination enables adequate visibility and permission for plugin functionality in Copilot.\n- **User3** is only scoped to RG2 and has Owner role but may lack sufficient access if RG2 does not have plugin-relevant resources or if Copilot capacities are not properly assigned.\n\nReference: https://learn.microsoft.com/en-us/copilot/security/use-plugins",
      "image": "Images/hotspot124.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have an on-premises Windows 11 Pro device named Device1 that is onboarded to Microsoft Defender for Endpoint.\n\nYou have a Microsoft 365 subscription.\n\nYou need to identify the processes running on Device1 and which network connections the processes have open. The solution must minimize administrative effort.\n\nWhich four actions should you perform in the Microsoft Defender portal in sequence? To answer, move the appropriate actions from the list of actions to the answer area and arrange them in the correct order.",
      "options": [
        "Select View Map.",
        "Collect an investigation package.",
        "Navigate to the device page for Device1.",
        "Extract the contents of the ZIP file.",
        "From the Action center, invoke an action.",
        "Run the netstat utility.",
        "Initiate a live response session."
      ],
      "answer": [
        "Navigate to the device page for Device1.",
        "Initiate a live response session.",
        "Collect an investigation package.",
        "Extract the contents of the ZIP file."
      ],
      "explanation": "To investigate processes and network connections on Device1 with minimal admin effort:\n\n1. Navigate to the device page in the Microsoft Defender portal.\n2. Initiate a live response session for remote inspection.\n3. Collect an investigation package using the available tools.\n4. Extract the ZIP file to analyze the included data, such as active processes and network connections.\n\nReference: https://learn.microsoft.com/en-us/defender-endpoint/respond-machine-alerts",
      "image": "Images/hotspot123.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have an Azure subscription named Sub1 that contains the resources shown in the following table.\n\n| Name  | Type                          | Resource group | Description                                     |\n|-------|-------------------------------|----------------|-------------------------------------------------|\n| WS1   | Microsoft Sentinel workspace | RG1            | Contains a scheduled query rule named Rule1    |\n| LApp1 | Azure logic app              | RG2            | Contains a Microsoft Sentinel incident trigger |\n\nYou plan to configure Rule1 to trigger Lapp1 when an incident is generated.\n\nYou need to recommend the role-based access control (RBAC) role that you should assign to WS1, and the scope at which should you assign the role. The solution must follow the principle of least privilege.\n\nWhat should you recommend? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "Logic App Operator",
        "Microsoft Sentinel Automation Contributor",
        "Microsoft Sentinel Playbook Operator",
        "LApp1",
        "RG1",
        "RG2",
        "Sub1"
      ],
      "answer": [
        "Microsoft Sentinel Automation Contributor",
        "LApp1"
      ],
      "explanation": "To allow Microsoft Sentinel to trigger a Logic App from a scheduled analytics rule, the correct role is **Microsoft Sentinel Automation Contributor**, which provides the minimum required permissions to run playbooks.\n\nThe role should be assigned **at the Logic App resource level (LApp1)** to follow the principle of least privilege.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/roles",
      "image": "Images/hotspot122.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have an Azure subscription that contains the users shown in the following table.\n\n| Name  | Role            | Scope          |\n|-------|-----------------|----------------|\n| User1 | Contributor     | Subscription   |\n| User2 | Contributor     | Subscription   |\n| User3 | Security Reader | Resource group |\n\nThe subscription contains instances of Azure Firewall as shown in the following table.\n\n| Name | Log configuration                                                | Destination       |\n|------|------------------------------------------------------------------|-------------------|\n| AFW1 | Unstructured logs                                                | Log Analytics     |\n| AFW2 | Structured intrusion detection and prevention system (IDPS) logs | Azure Event Hubs  |\n| AFW3 | Structured intrusion detection and prevention system (IDPS) logs | Log Analytics     |\n\nYou have a Microsoft 365 E5 subscription that uses Microsoft Copilot for Security. You have the Copilot for Security role assignments shown in the following table.\n\n| User  | Role               |\n|-------|--------------------|\n| User1 | Copilot Owner      |\n| User2 | Copilot Contributor|\n| User3 | Copilot Owner      |\n\nEach user runs a Copilot for Security session.\n\nFor each of the following statements, select Yes if the statement is true. Otherwise, select No.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "yes",
        "no"
      ],
      "answer": [
        "yes",
        "no",
        "yes"
      ],
      "explanation": "In Copilot for Security, the ability to use plugins (such as accessing logs from Azure Firewall) depends on both the user's Copilot role and their Azure RBAC role/scopes over the data source.\n\n- **User1** is a Copilot Owner and has Contributor role at subscription level, so they can access all Azure Firewall logs including structured and unstructured logs routed to Log Analytics or Event Hubs.\n- **User2** is a Copilot Contributor with subscription-level access but can only read data if explicitly permitted. Structured IDPS logs routed to Event Hubs may require specific permissions on the Event Hubs namespace, which User2 might not have by default.\n- **User3** is a Copilot Owner and has Security Reader role at the resource group level, which allows them to view security data for AFW3 if it's in the same resource group.\n\nReference: https://learn.microsoft.com/en-us/copilot/security/use-plugins",
      "image": "Images/hotspot121.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft Sentinel workspace.\n\nYou need to configure the Fusion analytics rule to temporarily suppress incidents generated by a Microsoft Defender connector. The solution must meet the following requirements:\n\n• Minimize impact on the ability to detect multistage attacks.\n• Minimize administrative effort.\n\nHow should you configure the rule? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "When alert is created",
        "When incident is created",
        "When incident is updated",
        "Add task",
        "Change status",
        "Run playbook"
      ],
      "answer": [
        "When incident is updated",
        "Run playbook"
      ],
      "explanation": "To suppress incidents generated by the Microsoft Defender connector in Microsoft Sentinel without disrupting the ability to detect multistage attacks (which Fusion is designed for), the best approach is to act at the incident level, not the alert level.\n\n- **When incident is updated**: Allows automation rules to trigger without disabling detection at alert creation time.\n- **Run playbook**: Ensures custom logic can be executed to handle suppression, logging, or escalation according to business needs with low administrative overhead.\n\nThis approach aligns with Microsoft's recommendations and best practices.\n\nReference: https://securebyteblog.wordpress.com/2024/08/27/suppressing-defender-for-xdr-incidents-using-automation-rules-in-microsoft-sentinel-a-step-by-step-guide/",
      "image": "Images/hotspot120.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft 365 E5 subscription that uses Microsoft Defender XDR and contains a Windows device named Device1.\n\nYou detect malicious activity on Device1.\n\nYou initiate a live response session on Device1.\n\nYou need to perform the following actions:\n\n• Download a file from the live response library.\n• Stop a process that is running on Device1.\n\nWhich live response command should you run for each action? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "analyze",
        "getfile",
        "library",
        "putfile",
        "remediate",
        "services"
      ],
      "answer": [
        "getfile",
        "remediate"
      ],
      "explanation": "- **getfile** is used to download a file from the live response library or the device to the analyst’s machine.\n- **remediate** is used to take remediation actions, including stopping or removing malicious processes or files.\n\nReference: https://learn.microsoft.com/en-us/defender-endpoint/live-response#live-response-commands",
      "image": "Images/hotspot119.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft 365 subscription that uses Microsoft Defender XDR and Microsoft Defender for Endpoint. The subscription contains the devices shown in the following table.\n\n| Name    | Microsoft Defender status | Operating system |\n|---------|----------------------------|------------------|\n| Device1 | Onboarded                 | Windows          |\n| Device2 | Onboarded                 | Windows          |\n| Device3 | Onboarded                 | Windows          |\n| Device4 | Network discovered        | Other            |\n\nYou discover the following forensic data:\n\n• During the startup of Device1, a connection is established to Device2 via port 5555.\n• Device2 connects to Device3 by using port 5555.\n• Device4 connects to Device1 by using port 5555.\n\nYou perform the following actions:\n\n• Initiate a live response session on Device1 and run the processes\n• From Devices in the Microsoft Defender portal, isolate Device1 and Device2.\n\nFor each of the following statements, select Yes if True. Otherwise select No.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "Yes",
        "No"
      ],
      "answer": [
        "Yes",
        "No",
        "Yes"
      ],
      "explanation": "- **Yes**: Device1 is onboarded and supports live response. Running the `processes` command is valid.\n- **No**: Device3 is not isolated and may still be communicating. The scenario doesn't state an isolation attempt for Device3.\n- **Yes**: Device4 is not onboarded (network discovered only), so it can still reach Device1 unless blocked elsewhere.\n\nReference: https://learn.microsoft.com/en-us/defender-endpoint/respond-machine-alerts#isolate-devices-from-the-network",
      "image": "Images/hotspot118.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft 365 subscription that uses Microsoft Purview and contains a Microsoft SharePoint Online site named Site1.\n\nSite1 contains the files shown in the following table.\n\n| Name       | Author |\n|------------|--------|\n| File1.docx | User1  |\n| File2.docx | User2  |\n| File3.xlsx | User3  |\n\n\nFrom Microsoft Purview, you create the content search queries shown in the following table.\n\n| Name    | Query                                           |\n|---------|-------------------------------------------------|\n| Search1 | Author:\"User1\" FileExtension:xlsx              |\n| Search2 | Author:\"User*\" and FileExtension:*             |\n| Search3 | Author:(\"User1..3\")                            |\n\n\nFor each of the following statements, select Yes if the statement is true. Otherwise, select No.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "Yes",
        "No"
      ],
      "answer": [
        "No",
        "Yes",
        "No"
      ],
      "explanation": "• **Search1** returns nothing because it queries for files authored by 'User1' with extension `.xlsx`, but User1's file is `.docx`, so this is **No**.\n• **Search2** uses a wildcard pattern `User*` and `FileExtension:*`, which matches all users starting with 'User' and all file extensions—so all files match. Therefore, this is **Yes**.\n• **Search3** uses the range `User1..3`, which is not a valid syntax in keyword queries and does not return anything, hence **No**.\n\nReference: [Keyword queries and search conditions - Microsoft Purview](https://learn.microsoft.com/en-us/microsoft-365/compliance/keyword-queries-and-search-conditions?view=o365-worldwide)",
      "image": "Images/hotspot117.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft 365 subscription that uses Microsoft Defender for Endpoint Plan 2 and contains a Windows device named Device1.\nYou initiate a live response session on Device1 and launch an executable file named File1.exe in the background.\n\nYou need to perform the following actions:\n\n• Identify the command ID of File1.exe.\n• Interact with File1.exe.\n\nWhich live response command should you run for each action? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "fileinfo",
        "jobs",
        "processes",
        "connect",
        "fg",
        "undo"
      ],
      "answer": [
        "jobs",
        "fg"
      ],
      "explanation": "To **identify the command ID** of File1.exe that was launched in the background, you should use the `jobs` command, which lists background jobs including their command IDs.\n\nTo **interact with File1.exe**, use the `fg` (foreground) command to bring the job to the foreground for interaction.\n\nReference: https://learn.microsoft.com/en-us/defender-endpoint/live-response#live-response-commandshttps://learn.microsoft.com/en-us/defender-endpoint/live-response",
      "image": "Images/hotspot116.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft 365 subscription that uses Microsoft Defender for Endpoint Plan 2 and contains a Windows device named Device1.\n\nTwenty files on Device1 are quarantined by custom indicators as part of an investigation.\n\nYou need to release the 20 files from quarantine.\n\nHow should you complete the command? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "MpCmdRun.exe",
        "MsMpEng.exe",
        "Start-MpRollback",
        "-GetFiles",
        "-RemoveDefinitions",
        "-ResetPlatform",
        "-Restore"
      ],
      "answer": [
        "MpCmdRun.exe",
        "-Restore"
      ],
      "explanation": "To restore quarantined files using Microsoft Defender Antivirus, you can use the **MpCmdRun.exe** tool with the **-Restore** switch. This utility is a command-line tool used for troubleshooting and diagnostic purposes in Microsoft Defender Antivirus.\n\nReference: https://learn.microsoft.com/en-us/defender-endpoint/respond-file-alerts#restore-file-from-quarantine",
      "image": "Images/hotspot114.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft 365 E5 subscription that uses Microsoft Defender XDR and contains a Windows device named Device1.\n\nYou investigate Device1 for malicious activity and discover a suspicious file named File1.exe. You collect an investigation package from Device1.\n\nYou need to review the following forensic data points:\n\n• Is an attacker currently accessing Device1 remotely?\n• When was File1.exe first executed?\n\nWhich folder in the investigation package should you review for each data point? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "Autoruns",
        "Installed programs",
        "Network connections",
        "Prefetch files",
        "Scheduled tasks",
        "Services",
        "Security event log"
      ],
      "answer": [
        "Network connections",
        "Prefetch files"
      ],
      "explanation": "To determine if an attacker is currently accessing the device remotely, the **Network connections** folder in the investigation package provides information about active and recent network sessions. For identifying the first execution time of a file like File1.exe, the **Prefetch files** folder contains metadata that helps determine when an executable was last and first run on the device.\n\nReference: https://learn.microsoft.com/en-us/defender-endpoint/respond-machine-alerts",
      "image": "Images/hotspot113.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft 365 subscription that uses Microsoft Defender for Endpoint Plan 2 and contains a Windows device named Device1.\n\nYou initiated a live response session on Device1.\n\nYou need to run a command that will download a 250-MB file named File1.exe from the live response library to Device1. The solution must ensure that File1.exe is downloaded as a background process.\n\nHow should you complete the live response command? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "collect",
        "getfile",
        "library",
        "putfile",
        "$",
        "&",
        ">",
        "<"
      ],
      "answer": [
        "putfile",
        "&"
      ],
      "explanation": "To download a file from the live response library to a device, you use the **putfile** command. To run the file transfer as a background process, use the ampersand (**&**) operator.\n\nThe `putfile` command is used for transferring files to the device from the live response library. Using `&` allows the command to run in the background.\n\n**Reference**: https://learn.microsoft.com/en-us/defender-endpoint/live-response#live-response-commands",
      "image": "Images/hotspot112.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft 365 E5 subscription that uses Microsoft Defender for Endpoint and contains a Windows device named Device1.\n\nYou need to investigate a suspicious executable file detected on Device1. The solution must meet the following requirements:\n\n• Identify the image file path of the file.\n• Identify when the file was first detected on Device1.\n\nWhat should you review from the timeline of the detection event? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "Action type",
        "Entities",
        "Event entities graph"
      ],
      "answer": [
        "Entities",
        "Event entities graph"
      ],
      "explanation": "To investigate a suspicious file in Microsoft Defender for Endpoint:\n\n- **Entities** provide details about the file, including its **image file path**, related user, and device information.\n- **Event entities graph** displays a visual timeline of when the file and associated events were detected, helping identify the **first detection time** on the device.\n\nThese views support a deeper understanding of the threat's context and timing.\n\nReference: https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/respond-machine-alerts#investigate-alerts-from-the-alerts-queue",
      "image": "Images/hotspot111.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft 365 subscription that uses Microsoft Defender XDR and contains a Windows device named Device1.\n\nYou investigate a suspicious process named Prod on Device1 by using a live response session.\n\nYou need to perform the following actions:\n\n• Stop Prod.\n• Send Prod for further review.\n\nWhich live response command should you run for each action? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "analyze",
        "getfile",
        "library",
        "processes",
        "putfile",
        "registry",
        "remediate"
      ],
      "answer": [
        "remediate",
        "analyze"
      ],
      "explanation": "To handle a suspicious process during a live response session in Microsoft Defender XDR:\n\n- Use the **remediate** command to stop the process. This command terminates processes and removes files associated with known malicious behaviors.\n- Use the **analyze** command to send the file for further review, such as submitting it to Microsoft for deep analysis.\n\nThese commands help investigate and act on threats during a live response session.\n\nReference: https://learn.microsoft.com/en-us/defender-endpoint/live-response#live-response-commands",
      "image": "Images/hotspot110.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have an Azure subscription that contains a Log Analytics workspace named Workspace1.\n\nYou configure Azure activity logs and Microsoft Entra ID logs to be forwarded to Workspace1.\n\nYou need to identify which Azure resources have been queried or modified by risky users.\n\nHow should you complete the KQL query? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "AzureActivity",
        "MicrosoftGraphActivityLogs",
        "UserRiskEvents",
        "(parse_path(SourceSystem))",
        "(parse_url(RequestUri).Path)",
        "(parse_xml(ATContent))"
      ],
      "answer": [
        "MicrosoftGraphActivityLogs",
        "(parse_url(RequestUri).Path)"
      ],
      "explanation": "To identify Azure resources accessed by risky users using KQL, the `MicrosoftGraphActivityLogs` table should be used, as it contains detailed information about Microsoft Graph API operations performed by users, including those marked as risky.\n\nTo extract the specific resources that were queried or modified, the `RequestUri` field can be parsed using `parse_url(RequestUri).Path`, which returns the endpoint path that was accessed, revealing the type of resource and action taken.\n\nReference: https://learn.microsoft.com/en-us/azure/azure-monitor/reference/tables/microsoftgraphactivitylogs",
      "image": "Images/hotspot109.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have an Azure subscription that contains a Microsoft Sentinel workspace named WS1.\n\nYou need to ensure that the incidents in WS1 include a list of actions that must be performed. The solution must meet the following requirements:\n\n• Ensure that you can build a tailored list of actions for each type of incident.\n• Minimize administrative effort.\n\nWhat should you do? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "Comments",
        "Tags",
        "Tasks",
        "Automated response",
        "Incident settings",
        "Set rule logic"
      ],
      "answer": [
        "Tags",
        "Automated response"
      ],
      "explanation": "To create a tailored list of actions for each incident type in Microsoft Sentinel with minimal administrative overhead:\n\n- **Tags** are used to categorize incidents, allowing you to differentiate between incident types and apply task templates based on tags.\n- **Automated response** allows Microsoft Sentinel to automatically apply incident tasks based on those tags, ensuring relevant actions are consistently suggested for each incident type.\n\nThis approach avoids manual configuration per incident and supports scalable management.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/incident-tasks#use-cases",
      "image": "Images/hotspot108.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft 365 E5 subscription that uses Microsoft Exchange Online.\n\nYou need to identify phishing email messages.\n\nWhich three cmdlets should you run in sequence? To answer, move the appropriate cmdlets from the list of cmdlets to the answer area and arrange them in the correct order.",
      "options": [
        "Connect-IPPSSession",
        "Start-ComplianceSearch",
        "Connect-ExchangeOnline",
        "Search-UnifiedAuditLog",
        "New-ComplianceSearch"
      ],
      "answer": [
        "Connect-IPPSSession",
        "New-ComplianceSearch",
        "Start-ComplianceSearch"
      ],
      "explanation": "To identify phishing email messages in Microsoft Exchange Online using compliance search, you follow these steps:\n\n1. **Connect-IPPSSession** – Establishes a connection to the Microsoft Purview compliance portal, which is required for running compliance searches.\n2. **New-ComplianceSearch** – Creates a new compliance search with the parameters that define what messages to search for (e.g., keywords or sender information associated with phishing).\n3. **Start-ComplianceSearch** – Initiates the execution of the created search to retrieve matching email messages.\n\nReference: https://learn.microsoft.com/en-us/purview/ediscovery-search-for-and-delete-email-messages",
      "image": "Images/hotspot107.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft 365 E5 subscription that uses Microsoft Defender XDR.\n\nYou are implementing a deception rule.\n\nYou need to provide a custom lure file.\n\nFor the custom lure, you set Planting path to HOME.\n\nWhich types of files can you use for the custom lure, and in which home directory should the file be located on a device? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "EXE only",
        "XLSX only",
        "PDF only",
        "EXE and XLSX only",
        "XLSX and PDF only",
        "EXE, XLSX, and PDF",
        "The Active Directory user",
        "The active user",
        "The local user",
        "The planted cached user"
      ],
      "answer": [
        "XLSX and PDF only",
        "The Active Directory user"
      ],
      "explanation": "When implementing a custom lure in Microsoft Defender XDR with the planting path set to HOME, only certain file types are supported. Specifically, **XLSX and PDF** files can be used as lure types in this scenario.\n\nThe 'HOME' planting path refers to the home directory of the **Active Directory user** that is signed in to the device, ensuring proper targeting of the lure to potential threat actors.\n\nReference: https://learn.microsoft.com/en-us/defender-xdr/configure-deception",
      "image": "Images/hotspot106.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft 365 E5 subscription that has a Conditional Access policy named Policy1.\n\nYou need to perform the following actions:\n\n• Create a Conditional Access App Control custom policy named Custom1.\n• Configure Policy1 to use Custom1.\n\nWhat should you use to create Custom1, and in which settings of Policy1 should you enable Conditional Access App Control? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "Microsoft 365 admin center",
        "Microsoft Defender portal",
        "Microsoft Entra admin center",
        "Microsoft Intune admin center",
        "Microsoft Purview compliance portal",
        "Client apps under Conditions",
        "Filter for devices under Conditions",
        "Grant",
        "Session",
        "Target resources"
      ],
      "answer": [
        "Microsoft Defender portal",
        "Session"
      ],
      "explanation": "To create a Conditional Access App Control custom policy like Custom1, you must use the **Microsoft Defender portal**, which provides the interface for configuring and managing session control policies under Microsoft Defender for Cloud Apps.\n\nIn the Conditional Access policy (Policy1), you must enable **Session** controls to route sessions through Microsoft Defender for Cloud Apps and apply the custom policy.\n\nReference: https://learn.microsoft.com/en-us/defender-cloud-apps/session-policy-aad",
      "image": "Images/hotspot105.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft 365 E5 subscription that contains Windows 11 and Linux CentOS devices.\n\nIn Microsoft Defender XDR, Deception is set to On.\n\nYou plan to create a deception rule that will use a custom lure.\n\nYou need to specify the type of file, and the planting path for the custom lure.\n\nWhat should you specify? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "BIN",
        "EXE",
        "LNK",
        "{HOME}",
        "\\\\server1\\share1",
        "/usr/tmp"
      ],
      "answer": [
        "BIN",
        "{HOME}"
      ],
      "explanation": "When configuring a **custom lure** for Linux-based devices in Microsoft Defender XDR's Deception feature:\n\n- You must specify the **file type** as **BIN**, which is supported for Linux environments.\n- The **planting path** should be a supported placeholder like **{HOME}**, representing the home directory of the user, which helps avoid hardcoding system-specific paths.\n\nThis configuration enables realistic and effective lures for Linux systems.\n\nReference: https://learn.microsoft.com/en-us/defender-xdr/configure-deception",
      "image": "Images/hotspot104.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft 365 subscription that contains three users named User1, User2, and User3 and the resources shown in the following table.\n\n| Name    | Signed in user | Microsoft Defender for Endpoint device group |\n|---------|----------------|---------------------------------------------|\n| Device1 | User1          | DevGroup1                                   |\n| Device2 | User2          | DevGroup1                                   |\n| Device3 | User3          | DevGroup2                                   |\n\nYou have a Microsoft Defender XDR detection rule named Rule1 that has the following configurations:\n\n• Scope: DevGroup1\n• File hash: File1.exe\n• Actions:\n  - Devices: Collect investigation package\n  - User: Mark as compromised\n  - Files: Block\n\nEach user attempts to run File1.exe on their device.\n\nFor each of the following statements, select Yes if the statement is true. Otherwise, select No.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "Yes",
        "No"
      ],
      "answer": [
        "No",
        "No",
        "Yes"
      ],
      "explanation": "The rule Rule1 is scoped only to **DevGroup1**, which includes **Device1** and **Device2**. Therefore:\n\n- **User1 and User2** are in DevGroup1 and will trigger the actions (including being marked as compromised and blocking File1.exe).\n- **User3**, who is on **Device3** in **DevGroup2**, is **outside the scope** of Rule1 and thus unaffected.\n\n**Important:** Even if a user is marked in the 'User' action, it applies **only when the signed-in device is within scope**.\n\nReference: https://learn.microsoft.com/en-us/defender-xdr/custom-detection-rules#actions-on-users",
      "image": "Images/hotspot103.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft 365 E5 subscription that uses Microsoft Defender XDR.\n\nYou have a Microsoft Sentinel workspace.\n\nMicrosoft Sentinel connectors are configured as shown in the following table:\n\n| Connector           | Collected log                                 |\n|---------------------|------------------------------------------------|\n| Microsoft Entra ID  | • Audit logs                                   |\n|                     | • Microsoft Graph activity logs                |\n| Microsoft 365       | • Microsoft Exchange Online                    |\n|                     | • Microsoft SharePoint Online                  |\n|                     | • Microsoft Teams                              |\n\nYou use Microsoft Sentinel to investigate suspicious Microsoft Graph API activity related to Conditional Access policies.\n\nYou need to search for the following activities:\n\n• Downloads of the Conditional Access policies by using PowerShell\n• Updates to the Conditional Access policies by using the Microsoft Entra admin center\n\nWhich tables should you query for each activity? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "AuditLogs",
        "MicrosoftGraphActivityLogs",
        "OfficeActivity",
        "AuditLogs and MicrosoftGraphActivityLogs",
        "AuditLogs and OfficeActivity",
        "OfficeActivity and MicrosoftGraphActivityLogs"
      ],
      "answer": [
        "MicrosoftGraphActivityLogs",
        "AuditLogs and MicrosoftGraphActivityLogs"
      ],
      "explanation": "To investigate suspicious Conditional Access policy activities:\n\n- **Downloads using PowerShell** are captured by **MicrosoftGraphActivityLogs**, which track Graph API operations such as `Get`, `List`, and `Read` actions.\n- **Updates via Microsoft Entra admin center** are logged in both **AuditLogs** (for UI-based activities) and **MicrosoftGraphActivityLogs** (for Graph API calls).\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/connect-microsoft-entra-id#log-tables-in-microsoft-sentinel",
      "image": "Images/hotspot102.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft 365 E5 subscription that contains the hosts shown in the following table.\n\n| Name  | Platform   | Device group |\n|-------|------------|--------------|\n| Host1 | Windows 11 | DG1          |\n| Host2 | Windows 11 | DG2          |\n| Host3 | macOS      | DG1          |\n\n\nYou have indicators in Microsoft Defender for Endpoint as shown in the following table.\n\n\n| Name | Value                                                            | Type    | Expiration date (UTC) | Action              | Organization scope |\n|------|------------------------------------------------------------------|---------|------------------------|---------------------|--------------------|\n| ID1  | b94d27b9934d3e08a52e52d7da7dabfac484efe37a5380ee9088f7ace2efcde9 | SHA-256 | Sep 15, 2026           | Block and remediate | DG2                |\n| ID2  | b94d27b9934d3e08a52e52d7da7dabfac484efe37a5380ee9088f7ace2efcde9 | SHA-256 | None                   | Allow               | DG1                |\n| ID3  | 2aae6c35c94fcfb415dbe95f408b9ce91ee846ed                          | SHA-1   | Jan 1, 2026            | Block execution     | DG1, DG2           |\n| ID4  | 88d4266fd4e6338d13b845fcf289579d209c897823b9217da3e161936f031589 | SHA-256 | None                   | Block execution     | DG1                |\n\nID1 and ID2 reference the same file as ID3.\n\nFor each of the following statements, select Yes if the statement is true. Otherwise, select No.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "Yes",
        "No"
      ],
      "answer": [
        "Yes",
        "No",
        "Yes"
      ],
      "explanation": "Microsoft Defender for Endpoint evaluates conflicting indicators based on **precedence rules**, where 'Allow' takes priority over 'Block' in scoped groups. \n\n- **ID1** applies to DG2 (Host2), blocks the hash.\n- **ID2** applies to DG1 (Host1 and Host3), allows the same hash, overriding block actions.\n- **ID3** blocks via SHA-1 for DG1 and DG2 (Host1 and Host2).\n- **ID4** targets a different file, block action for DG1 (Host1 and Host3).\nNote that Defender capabilities for macOS differ from Windows, and some indicator actions may not apply.\n\nReference: https://learn.microsoft.com/en-us/defender-endpoint/indicators-overview",
      "image": "Images/hotspot101.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have on-premises servers that run Windows Server.\n\nYou have a Microsoft Sentinel workspace named SW1. SW1 is configured to collect Windows Security log entries from the servers by using the Azure Monitor Agent data connector.\n\nYou plan to limit the scope of collected events to events 4624 and 4625 only.\n\nYou need to use a PowerShell script to validate the syntax of the filter applied to the connector.\n\nHow should you complete the script? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "@{Log=\"Security\";EventType=\"System\";EventID=\"4624\";EventID=\"4625\"",
        "<Security> <System> <EventID>4624</EventID> <EventID>4625</EventID> </System></Security>",
        "Security!*[System[(EventID=4624 or EventID=4625)]]",
        "-FilterHashtable",
        "-FilterXml",
        "-FilterXPath"
      ],
      "answer": [
        "Security!*[System[(EventID=4624 or EventID=4625)]]",
        "-FilterXPath"
      ],
      "explanation": "To filter specific events (4624 and 4625) from the Windows Security log using the Azure Monitor Agent, you use XPath filters in your data collection rule. To validate the filter using PowerShell, the correct syntax requires:\n\n- The XPath expression: **Security!*[System[(EventID=4624 or EventID=4625)]]** to capture only those specific event IDs.\n- The PowerShell parameter: **-FilterXPath** to apply the XPath filter.\n\nReference: https://learn.microsoft.com/en-us/azure/azure-monitor/agents/data-collection-rule-azure-monitor-agent?tabs=portal#filter-events-using-xpath-queries",
      "image": "Images/hotspot100.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft Sentinel workspace that contains the following Advanced Security Information Model (ASIM) parsers:\n\n• _Im_ProcessCreate\n• imProcessCreate\nYou create a new source-specific parser named vimProcessCreate.\n\nYou need to modify the parsers to meet the following requirements:\n\n• Call all the ProcessCreate parsers.\n• Standardize fields to the Process schema.\n\nWhich parser should you modify to meet each requirement? To answer, drag the appropriate parsers to the correct requirements.\n\nEach parser may be used once, more than once, or not at all.",
      "options": [
        "_Im_ProcessCreate",
        "imProcessCreate",
        "vimProcessCreate"
      ],
      "answer": [
        "vimProcessCreate",
        "imProcessCreate"
      ],
      "explanation": "To meet ASIM requirements in Microsoft Sentinel:\n\n- Modify **vimProcessCreate** to **call all ProcessCreate parsers**, as it is a source-specific parser meant to aggregate and extend capabilities.\n- Modify **imProcessCreate** to **standardize fields to the Process schema**, because it's the normalizer parser responsible for schema mapping.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/normalization-about-parsers",
      "image": "Images/hotspot99.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft 365 E5 subscription that uses Microsoft Defender for Endpoint.\n\nYou need to ensure that you can initiate remote shell connections to Windows servers by using the Microsoft 365 Defender portal.\n\nWhat should you configure? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "Device discovery",
        "Enable EDR in block mode",
        "Live Response for Servers",
        "A device tag",
        "A device value",
        "The Automation level"
      ],
      "answer": [
        "Live Response for Servers",
        "The Automation level"
      ],
      "explanation": "To initiate remote shell connections to Windows servers from the Microsoft 365 Defender portal:\n\n- **Live Response for Servers** must be enabled to allow secure remote access to the device for investigation and remediation.\n- **The Automation level** should be configured appropriately to define how Microsoft Defender for Endpoint handles alerts and incidents, enabling automated investigation and response.\n\nReference: https://learn.microsoft.com/en-us/defender-endpoint/automation-levels",
      "image": "Images/hotspot98.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have an Azure DevOps organization that contains an Azure Repos repository named Repo1 and is onboarded to Microsoft Defender for DevOps.\n\nYou create infrastructure as code (IaC) files and store them in Repo1. The IaC files are formatted as Bicep files and Helm charts.\n\nYou need to configure Defender for DevOps to identify misconfigurations in the IaC files.\n\nWhich scanning tool should you use for each type of files? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "CredScan",
        "Template Analyzer",
        "Terrascan"
      ],
      "answer": [
        "CredScan",
        "Template Analyzer",
        "Terrascan"
      ],
      "explanation": "To scan Infrastructure as Code (IaC) files in Azure DevOps using Microsoft Defender for DevOps:\n\n- **CredScan** is used to detect credentials such as passwords, secrets, and API keys in any file type.\n- **Template Analyzer** is specifically used for Bicep and ARM template analysis to detect security misconfigurations.\n- **Terrascan** is used to scan Terraform, Kubernetes (Helm), and other container-based configurations for security and compliance risks.\n\nReference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/iac-vulnerabilities#view-details-and-remediation-information-for-applied-iac-rules",
      "image": "Images/hotspot97.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have an Azure DevOps organization that uses Microsoft Defender for DevOps. The organization contains an Azure DevOps repository named Repo1 and an Azure Pipelines pipeline named Pipeline1. Pipeline1 is used to build and deploy code stored in Repo1.\n\nYou need to ensure that when Pipeline1 runs, Microsoft Defender for Cloud can perform secret scanning of the code in Repo1.\n\nWhat should you install in the organization, and what should you add to the YAML file of Pipeline1? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "Secure DevOps Kit for Azure (AzSK)",
        "The Microsoft Security Code Analysis (MSCA) extension",
        "The Microsoft Security DevOps extension",
        "Inputs",
        "Jobs",
        "Steps"
      ],
      "answer": [
        "The Microsoft Security DevOps extension",
        "Steps"
      ],
      "explanation": "To enable secret scanning in Azure DevOps using Microsoft Defender for DevOps:\n\n- You need to install the **Microsoft Security DevOps extension** in the Azure DevOps organization. This extension provides secure development tooling, including secret scanning.\n- You must add the scanning logic as a task in the **Steps** section of the pipeline YAML file to integrate it during the CI/CD process.\n\nReference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/azure-devops-extension#configure-the-microsoft-security-devops-azure-devops-extension-1",
      "image": "Images/hotspot96.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have an Azure subscription that uses Microsoft Defender for Cloud.\n\nYou need to use an Azure Resource Manager (ARM) template to create a workflow automation that will trigger a logic app when specific alerts are received by Microsoft Defender for Cloud.\n\nHow should you complete the template? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "Microsoft.AlertsManagement",
        "Microsoft.Automation",
        "Microsoft.Logic",
        "Microsoft.Security"
      ],
      "answer": [
        "Microsoft.Logic"
      ],
      "explanation": "To define and deploy a Logic App workflow using an ARM template, you must use the **Microsoft.Logic** resource provider.\nThis enables you to describe the logic app's properties and automate its deployment through infrastructure-as-code.\n\nReference: https://learn.microsoft.com/en-us/azure/templates/microsoft.logic/workflows?pivots=deployment-language-arm-template",
      "image": "Images/hotspot95.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have an Azure subscription named Sub1 that is linked to a Microsoft Entra tenant named contoso.com. Contoso.com contains a user named User1. Sub1 contains a Microsoft Sentinel workspace.\n\nYou provision a Microsoft Copilot for Security capacity.\n\nYou need to ensure that User1 can use Copilot for Security to perform the following tasks:\n\n• Update the data sharing and feedback options.\n• Investigate Microsoft Sentinel incidents.\n\nThe solution must follow the principle of least privilege.\n\nWhich role should you assign to User1 for each task? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "Global Administrator",
        "Security Administrator",
        "Security Operator",
        "Cloud App Security Administrator",
        "Microsoft Sentinel Reader",
        "Microsoft Sentinel Responder"
      ],
      "answer": [
        "Security Administrator",
        "Microsoft Sentinel Responder"
      ],
      "explanation": "To configure Microsoft Copilot for Security and ensure proper access based on least privilege:\n\n- Assign **Security Administrator** to User1 so they can update data sharing and feedback options, which requires access to configuration-level security settings.\n- Assign **Microsoft Sentinel Responder** to allow User1 to investigate Microsoft Sentinel incidents, which includes permissions for triage, assignment, and incident response without full administrative rights.\n\nReference: https://learn.microsoft.com/en-us/copilot/security/authentication",
      "image": "Images/hotspot94.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft Sentinel workspace.\n\nYou need to create playbooks that meet the following requirements:\n\n• Use an automation rule to trigger actions on an entity.\n• Call the Entities - Get Hosts action.\n\nWhich types of playbooks should you use, and which parameters should you specify? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "Only a playbook that uses an alert trigger",
        "Only a playbook that uses an entity trigger only",
        "Only a playbook that uses an incident trigger",
        "Only a playbook that uses an incident trigger and a playbook that uses an entity trigger only",
        "Only a playbook that uses an incident trigger and a playbook that uses an alert trigger only",
        "Alert only",
        "FullIncidentProperties only",
        "Alert and Incident only",
        "Alert and FullIncidentProperties only"
      ],
      "answer": [
        "Only a playbook that uses an entity trigger only",
        "FullIncidentProperties only"
      ],
      "explanation": "To use Microsoft Sentinel playbooks for entity-level automation, you must configure a playbook that is triggered by an **entity trigger only**. This is essential for executing actions that act on specific entities like hosts.\n\nThe **Entities - Get Hosts** action in the Azure Sentinel connector requires the parameter **FullIncidentProperties**, which provides contextual data needed to process and act upon the incident’s entities.\n\nReference: https://learn.microsoft.com/en-us/connectors/azuresentinel/",
      "image": "Images/hotspot93.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have an Azure subscription named Sub1 that contains a resource group named RG1. RG1 contains two Azure key vaults named KV1 and KV2 that use Azure role-based access control (Azure RBAC).\n\nThe subscription contains the users shown in the following table:\n\n| Name  | Role                      | Scope |\n|-------|---------------------------|-------|\n| User1 | Key Vault Administrator   | Sub1  |\n| User2 | Key Vault Reader          | RG1   |\n| User3 | Key Vault Secrets User    | KV1   |\n\nKV1 contains a secret named Secret1. KV2 contains a secret named Secret2.\n\nWhich users can read the values of each secret? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "User1 only",
        "User2 only",
        "User3 only",
        "User1 and User3 only",
        "User2 and User3 only",
        "User1, User2, and User3"
      ],
      "answer": [
        "User1 and User3 only",
        "User1 only"
      ],
      "explanation": "In Azure RBAC, the **Key Vault Administrator** role (assigned to User1 at the subscription level) grants full access to manage key vaults and secrets, including reading secrets.\n\n- **User1** can access both KV1 and KV2 secrets due to their role and scope.\n- **User3** has the **Key Vault Secrets User** role scoped to KV1, allowing them to read Secret1.\n- **User2**, although a **Key Vault Reader** at the RG1 level, does not have permission to read secret values, only vault metadata.\n\nReferences: https://learn.microsoft.com/en-us/azure/key-vault/general/rbac-guide?tabs=azure-cli",
      "image": "Images/hotspot92.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have an Azure subscription named Sub1 that contains an Azure key vault named Vault1 and an Azure Automation account named Automation1.\n\nYou need to ensure that Automation1 can access Vault1. The solution must meet the following requirements:\n\n• Ensure that if Automation1 is deleted, the permissions granted for Vault1 will be removed automatically.\n• Ensure that runbooks created in Automation1 can read secret values stored in Vault1.\n• Follow the principle of least privilege.\n\nWhat should you configure for Automation1, and which built-in role should Automation1 use to access Vault1? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct answer is worth one point.",
      "options": [
        "A service account",
        "A system-assigned managed identity",
        "A user-assigned managed identity",
        "An app registration",
        "An enterprise application",
        "Key Vault Crypto Officer",
        "Key Vault Crypto User",
        "Key Vault Reader",
        "Key Vault Secrets Officer",
        "Key Vault Secrets User"
      ],
      "answer": [
        "A system-assigned managed identity",
        "Key Vault Secrets User"
      ],
      "explanation": "To ensure that Automation1 can securely and efficiently access Vault1:\n\n- Use a **system-assigned managed identity** so that permissions are automatically cleaned up if Automation1 is deleted.\n- Assign the **Key Vault Secrets User** role, which grants read-only access to secret contents without broader administrative permissions, aligning with the principle of least privilege.\n\nReferences:\n- https://learn.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/overview\n- https://learn.microsoft.com/en-us/azure/key-vault/general/rbac-guide?tabs=azure-cli#key-vault-secrets-user",
      "image": "Images/hotspot91.png"
    },
    {
      "type": "drag_and_drop",
      "image": "Images/hotspot90.png",
      "question": "Your on-premises network contains a Hyper-V cluster. The cluster contains the virtual machines shown in the following table.\n\n| Name    | Operating system        | Azure Connected Machine agent | Azure Monitoring Agent |\n|---------|--------------------------|-------------------------------|------------------------|\n| Server1 | Windows Server 2019      | Not installed                 | Installed              |\n| Server2 | Windows Server 2016      | Installed                     | Not installed          |\n| Server3 | Linux Ubuntu 20.04       | Not installed                 | Installed              |\n\nYou have a Microsoft Sentinel workspace named SW1.\n\nYou have a data collection rule (DCR) that has the following configurations:\n\n• Name: DCR1\n• Destination: SW1\n• Platform type: All\n• Data collection endpoint: None\n• Data source: Windows event logs, Linux syslog\n\nFor each of the following statements, select Yes if the statement is true. Otherwise, select No.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "Statement 1",
        "Statement 2",
        "Statement 3"
      ],
      "answer": [
        "Yes",
        "No",
        "Yes"
      ],
      "explanation": "To collect data using Microsoft Sentinel with a DCR:\n\n- **Server1**: Even though the Azure Connected Machine agent is not installed, the Azure Monitoring Agent (AMA) is, which allows data collection—**Yes**.\n- **Server2**: The Connected Machine agent is installed, but without the Azure Monitoring Agent, DCRs can't collect logs—**No**.\n- **Server3**: Runs Linux and has AMA installed, allowing syslog collection—**Yes**.\n\nReference: https://learn.microsoft.com/en-us/azure/azure-arc/servers/agent-overview"
    },
    {
      "type": "drag_and_drop",
      "question": "You have an on-premises Linux server that runs a background process named App1 and has the Azure Connected Machine agent installed.\n\nYou have a Microsoft Sentinel workspace named WS1.\n\nYou need to configure a data collection rule (DCR) named DCR1 that will use the Syslog via AMA connector to collect messages related to App1. The solution must meet the following requirements:\n\n• Only collect messages that have a priority level of critical.\n• Minimize the volume of data collected.\n\nWhich facility and log level should you configure for DCR1? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "LOG_AUTH",
        "LOG_CRON",
        "LOG_DAEMON",
        "LOG_KERN",
        "LOG_SYSLOG",
        "LOG_DEBUG",
        "LOG_EMERG",
        "LOG_ERR",
        "LOG_WARN"
      ],
      "answer": [
        "LOG_DAEMON",
        "LOG_EMERG"
      ],
      "explanation": "To configure a Data Collection Rule (DCR) in Microsoft Sentinel using the Syslog via AMA connector for a Linux process like App1:\n\n- **LOG_DAEMON** is the appropriate facility for background processes and daemons.\n- **LOG_EMERG** represents the highest severity level, ensuring only the most critical events are collected. This satisfies the requirement to minimize data volume and focus on critical messages.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/connect-cef-syslog-ama?tabs=portal",
      "image": "Images/hotspot89.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft 365 E5 subscription and a Microsoft Sentinel workspace.\n\nYou need to create a KQL query that will combine data from the following sources:\n\n• Microsoft Graph\n• Risky users detected by using Microsoft Entra ID Protection\n\nThe solution must minimize the volume of data returned.\n\nHow should the query start?",
      "options": [
        "A. MicrosoftGraphActivityLogs | lookup kind=leftouter AADRiskyUsers on $left.UserId == $right.Id",
        "B. MicrosoftGraphActivityLogs | join AADRiskyUsers on $left.UserId == $right.Id",
        "C. MicrosoftGraphActivityLogs | join AADUserRiskEvents on $left.UserId == $right.Id",
        "D. find in (MicrosoftGraphActivityLogs, AADUserRiskEvents) where"
      ],
      "answer": [
        "B. MicrosoftGraphActivityLogs | join AADRiskyUsers on $left.UserId == $right.Id"
      ],
      "explanation": "To combine data from Microsoft Graph and Entra ID Protection while minimizing data volume, you use a **standard inner join**.\n\nThe inner join (`join`) returns only matching records between the two datasets, which keeps the data volume focused and efficient.\n`lookup` would include unmatched records (like a left outer join), potentially increasing data volume unnecessarily.\n\nReference: https://learn.microsoft.com/en-us/kusto/query/join-operator?view=microsoft-fabric#returns",
      "image": "Images/hotspot88.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have an Azure subscription named Sub1. Sub1 contains a Microsoft Sentinel workspace named SW1 and a virtual machine named VM1 that runs Windows Server. SW1 collects security logs from VM1 by using the Windows Security Events via AMA connector.\n\nYou need to limit the scope of events collected from VM1. The solution must ensure that only audit failure events are collected.\n\nHow should you complete the filter expression for the connector? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "EventData[",
        "Keywords[",
        "System["
      ],
      "answer": [
        "System[",
        "EventData"
      ],
      "explanation": "To properly filter audit failure events in the Windows Security Events via AMA connector, you must use XPath syntax that leverages the event schema:\n1. **System[** is the correct starting point for filtering by attributes such as Event ID or audit status.\n2. **EventData** is used to pull the relevant detailed fields from the event payload.\n\nThis allows you to refine the ingestion pipeline to just those logs relevant to audit failures.\n\nReference: https://learn.microsoft.com/en-us/azure/azure-monitor/vm/data-collection-windows-events#extract-xpath-queries-from-windows-event-viewer",
      "image": "Images/hotspot87.png"
    },
    {
      "type": "drag_and_drop",
      "image": "Images/hotspot87.png",
      "question": "You have an Azure subscription named Sub1. Sub1 contains a Microsoft Sentinel workspace named SW1 and a virtual machine named VM1 that runs Windows Server. SW1 collects security logs from VM1 by using the Windows Security Events via AMA connector.\n\nYou need to limit the scope of events collected from VM1. The solution must ensure that only audit failure events are collected.\n\nHow should you complete the filter expression for the connector? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "EventData[",
        "Keywords[",
        "System["
      ],
      "answer": [
        "System[",
        "EventData"
      ],
      "explanation": "To filter Windows event data using XPath in the Windows Security Events via AMA connector, you need to use the correct structure.\n\n- The **System[** element is used to filter on metadata like event ID, level, or keywords such as audit success or failure.\n- The **EventData** section is used to extract specific information from within the event body.\n\nTo target audit failure events specifically, you apply XPath filters inside the `System[` block, and use `EventData` to capture relevant event information.\n\nReference: https://learn.microsoft.com/en-us/azure/azure-monitor/vm/data-collection-windows-events#extract-xpath-queries-from-windows-event-viewer"
    },
    {
      "type": "drag_and_drop",
      "question": "You have an Azure subscription that uses Microsoft Defender for Cloud.\n\nYou need to use an Azure Resource Manager (ARM) template to create a workflow automation that will trigger a logic app when specific alerts are received by Microsoft Defender for Cloud.\n\nHow should you complete the template? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "Microsoft.AlertsManagement",
        "Microsoft.Automation",
        "Microsoft.Logic",
        "Microsoft.Security"
      ],
      "answer": [
        "Microsoft.Security",
        "Microsoft.Logic"
      ],
      "explanation": "To create workflow automation in Microsoft Defender for Cloud using an ARM template:\n1. Use the **Microsoft.Security** resource provider to define the automation trigger in Defender for Cloud.\n2. Use the **Microsoft.Logic** resource provider to define the Logic App workflow to execute.\n\nReferences:\n- https://learn.microsoft.com/en-us/azure/templates/microsoft.security/automations?pivots=deployment-language-arm-template\n- https://learn.microsoft.com/en-us/azure/templates/microsoft.logic/workflows?pivots=deployment-language-arm-template",
      "image": "Images/hotspot86.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft 365 E5 subscription that uses Microsoft Defender XDR and contains two users named User1 and User2.\n\nYou need to ensure that the users can perform searches by using the Microsoft Purview portal. The solution must meet the following requirements:\n\n• Ensure that User1 can search the Microsoft Purview Audit service logs and review the Microsoft Purview Audit service configuration.\n• Ensure that User2 can search Microsoft Exchange Online mailboxes.\n• Follow the principle of least privilege.\n\nTo which Microsoft Purview role group should you add each user? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "Audit Reader",
        "Global Reader",
        "Reviewer",
        "Security Reader",
        "Communication Compliance Investigators",
        "Data Investigator",
        "Insider Risk Management Investigators",
        "Privacy Management Investigators"
      ],
      "answer": [
        "Audit Reader",
        "Data Investigator"
      ],
      "explanation": "To meet the requirements with least privilege:\n- **User1** should be added to the **Audit Reader** role group to access and review Microsoft Purview Audit logs and configurations.\n- **User2** should be added to the **Data Investigator** role group to perform content searches in Microsoft Exchange Online mailboxes.\n\nReferences:\n- https://learn.microsoft.com/en-us/purview/audit-log-roles\n- https://learn.microsoft.com/en-us/microsoft-365/compliance/data-investigator-role?view=o365-worldwide",
      "image": "Images/hotspot85.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have an Azure subscription that contains 50 virtual machines.\n\nYou plan to deploy Microsoft Defender for Cloud.\n\nYou need to enable agentless scanning for 40 virtual machines. The solution must create disk snapshots of the virtual machines and perform out-of-band analysis of the snapshots.\n\nWhat should you do? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "Defender CSPM",
        "Resource Manager",
        "Storage",
        "A role-based access control (RBAC) assignment",
        "An Azure Policy assignment",
        "Tagging"
      ],
      "answer": [
        "Defender CSPM",
        "Tagging"
      ],
      "explanation": "To enable agentless scanning with Microsoft Defender for Cloud, you must enable **Defender CSPM** (Cloud Security Posture Management), which supports agentless vulnerability assessments through snapshot analysis.\n\nYou also use **Tagging** to selectively enable agentless scanning only for specific virtual machines, allowing targeted coverage based on your requirements.\n\nReferences:\n- https://learn.microsoft.com/en-us/azure/defender-for-cloud/concept-agentless-data-collection\n- https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/azure-best-practices/resource-naming-and-tagging-decision-guide",
      "image": "Images/hotspot84.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have the resources shown in the following table.\n\n| Name    | Type                              | Description                                                              |\n|---------|-----------------------------------|---------------------------------------------------------------------------|\n| Server1 | On-premises server                | On-boarded to Azure Arc  \n                                             Runs Windows Server 2022  \n                                             Has Microsoft SQL Server 2022 installed |\n| VM1     | SQL Server on Azure Virtual Machines | Runs Windows Server 2022  \n                                                  Has Microsoft SQL Server 2022 installed |\n\nYou have an Azure subscription that uses Microsoft Defender for Cloud.\n\nYou need to use Defender for Cloud to protect VM1 and Server1. The solution must meet the following requirements:\n\n• Support Advanced Threat Protection and vulnerability assessment.\n• Register each SQL Server 2022 instance as a SQL virtual machine.\n• Minimize implementation and administrative effort.\n\nWhat should you deploy to each server? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "An Azure virtual machine extension",
        "The Azure Monitor Agent and an Azure virtual machine extension",
        "The Log Analytics agent and an Azure virtual machine extension"
      ],
      "answer": [
        "The Azure Monitor Agent and an Azure virtual machine extension",
        "The Azure Monitor Agent and an Azure virtual machine extension"
      ],
      "explanation": "To enable Advanced Threat Protection and vulnerability assessments for SQL Server running on both Azure VMs and Arc-enabled servers, Defender for Cloud requires the Azure Monitor Agent and the SQL Server extension. This combination registers the SQL instance, enables monitoring, and minimizes setup effort.\n\nThis setup ensures consistent protection and simplified management across hybrid environments.\n\nReference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/defender-for-sql-introduction"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft 365 E5 subscription that uses Microsoft Defender for Endpoint.\n\nYou have the on-premises devices shown in the following table:\n\n| Name    | Management state                                                       | Operating system     |\n|---------|------------------------------------------------------------------------|----------------------|\n| Device1 | Onboarded to and managed by using Microsoft Defender for Endpoint     | Windows Server 2022 |\n| Device2 | Discovered by Microsoft Defender for Endpoint and unmanaged           | Linux               |\n\nYou are preparing an incident response plan for devices infected by malware.\n\nYou need to recommend response actions that meet the following requirements:\n• Block malware from communicating with and infecting managed devices.\n• Do NOT affect the ability to control managed devices.\n\nWhich actions should you use for each device? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "Isolate device only",
        "Initiate Automated Investigation only",
        "Contain device only",
        "Isolate device and Initiate Automated Investigation only",
        "Isolate device, Initiate Automated Investigation, and Contain device"
      ],
      "answer": [
        "Isolate device, Initiate Automated Investigation, and Contain device",
        "Isolate device only"
      ],
      "explanation": "For **Device1**, since it's fully onboarded and managed by Microsoft Defender for Endpoint, you can perform the full range of response actions: isolate the device, initiate automated investigations, and contain the device from spreading threats to others.\n\nFor **Device2**, it is only discovered (not onboarded or managed), so the only supported action is to **isolate** the device if needed—other advanced actions are not available until onboarding.\n\nSee: https://learn.microsoft.com/en-us/defender-endpoint/respond-machine-alerts#isolate-devices-from-the-network",
      "image": "Images/hotspot82.png"
    },
    {
      "type": "drag_and_drop",
      "question": "This is a case study. Case studies are not timed separately. You can use as much exam time as you would like to complete each case. However, there may be additional case studies and sections on this exam. You must manage your time to ensure that you are able to complete all questions included on this exam in the time provided.\n\nTo answer the questions included in a case study, you will need to reference information that is provided in the case study. Case studies might contain exhibits and other resources that provide more information about the scenario that is described in the case study. Each question is independent of the other questions in this case study.\n\nAt the end of this case study, a review screen will appear. This screen allows you to review your answers and to make changes before you move to the next section of the exam. After you begin a new section, you cannot return to this section.\n\nTo start the case study -\nTo display the first question in this case study, click the Next button. Use the buttons in the left pane to explore the content of the case study before you answer the questions. Clicking these buttons displays information such as business requirements, existing environment, and problem statements. If the case study has an All Information tab, note that the information displayed is identical to the information displayed on the subsequent tabs. When you are ready to answer a question, click the Question button to return to the question.\n\nYou have a Microsoft Sentinel workspace that has a default data retention period of 30 days. The workspace contains two custom tables as shown in the following table:\n\n| Name   | Table plan | Interactive retention | Total retention period |\n|--------|------------|-----------------------|------------------------|\n| Table1 | Basic      | Default               | Default                |\n| Table2 | Analytics  | Default               | 365                    |\n\nEach table ingested two records per day during the past 365 days.\n\nYou build KQL statements for use in analytic rules as shown in the following table:\n\n| Name   | KQL statement                                                     |\n|--------|------------------------------------------------------------------|\n| Query1 | Table1 \\n where TimeGenerated >= ago(15) \\n summarize count()  |\n| Query2 | Table2 \\n where TimeGenerated >= ago(120) \\n summarize count() |\n| Query3 | Table1 \\n where TimeGenerated >= ago(45)                        |\n\nFor each of the following statements, select Yes if the statement is true. Otherwise, select No.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "yes",
        "no"
      ],
      "answer": [
        "no",
        "no",
        "yes"
      ],
      "explanation": "Table1 uses the Basic plan, which only retains data for the workspaces default retention period (30 days). Therefore:\n-\n\nReference:KQL queries can only be run against interactive data. Total retention period is used to specify the period data needs to be archived for. \nArchived data cannot be accessed via KQL you have to run special Search or Restore jobs to access this data. So increasing the total retention period \nwill have no effect on the data returned by any of the queries.\n- https://learn.microsoft.com/en-us/azure/azure-monitor/logs/data-retention-archive?tabs=portal-3%2Cportal-1%2Cportal-2",
      "image": "Images/hotspot81.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have an Azure subscription that contains a Log Analytics workspace named Workspace1.\n\nYou configure Azure activity logs and Microsoft Entra ID logs to be forwarded to Workspace1.\n\nYou need to query Workspace1 to identify all the requests that failed due to insufficient authorization.\n\nHow should you complete the KQL query? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "AuditLogs",
        "AzureActivity",
        "MicrosoftGraphActivityLogs",
        "401",
        "402",
        "403"
      ],
      "answer": [
        "AzureActivity",
        "401"
      ],
      "explanation": "To identify failed requests due to insufficient authorization, use the **AzureActivity** table, which captures control plane activity. HTTP status code **401** represents 'Unauthorized', which is the standard response for failed authentication attempts due to missing or invalid credentials.\n\n- HTTP 401 reference: https://learn.microsoft.com/en-us/troubleshoot/developer/webapps/iis/www-administration-management/http-status-code\n- Microsoft Graph activity log info (not used in this case): https://learn.microsoft.com/en-us/graph/microsoft-graph-activity-logs-overview",
      "image": "Images/hotspot80.png"
    },
    {
      "type": "drag_and_drop",
      "question": "Case Study -\n\nThis is a case study. Case studies are not timed separately. You can use as much exam time as you would like to complete each case. However, there may be additional case studies and sections on this exam. You must manage your time to ensure that you are able to complete all questions included on this exam in the time provided.\n\nTo answer the questions included in a case study, you will need to reference information that is provided in the case study. Case studies might contain exhibits and other resources that provide more information about the scenario that is described in the case study. Each question is independent of the other questions in this case study.\n\nAt the end of this case study, a review screen will appear. This screen allows you to review your answers and to make changes before you move to the next section of the exam. After you begin a new section, you cannot return to this section.\n\nTo start the case study -\nTo display the first question in this case study, click the Next button. Use the buttons in the left pane to explore the content of the case study before you answer the questions. Clicking these buttons displays information such as business requirements, existing environment, and problem statements. If the case study has an All Information tab, note that the information displayed is identical to the information displayed on the subsequent tabs. When you are ready to answer a question, click the Question button to return to the question.\n\nOverview -\n\nAdatum Corporation is a United States-based financial services company that has regional offices in New York, Chicago, and San Francisco.\n\nExisting Environment -\n\nIdentity Environment -\nThe on-premises network contains an Active Directory Domain Services (AD DS) forest named corp.adatum.com that syncs with an Azure AD tenant named adatum.com. All user and group management tasks are performed in corp.adatum.com. The corp.adatum.com domain contains a group named Group1 that syncs with adatum.com.\n\nLicensing Status -\nAll the users at Adatum are assigned a Microsoft 365 E5 license and an Azure Active Directory Premium P2 license.\n\nCloud Environment -\nThe cloud environment contains a Microsoft 365 subscription, an Azure subscription linked to the adatum.com tenant, and the resources shown in the following table:\n\n| Name      | Type                          | Description                                                          |\n|-----------|-------------------------------|----------------------------------------------------------------------|\n| Sentinel1 | Microsoft Sentinel workspace  | Includes a custom hunting query named HuntingQuery1                 |\n| Server2   | Azure virtual machine         | Runs Windows Server 2022                                            |\n\nOn-premises Environment -\n\nThe on-premises network contains the resources shown in the following table:\n\n| Name      | Type                  | Description                                                                                       |\n|-----------|-----------------------|---------------------------------------------------------------------------------------------------|\n| Server1   | Server                | Runs Windows Server 2019. Has Azure Arc-enabled and the Azure Monitor agent installed             |\n| Webapp1   | Web service           | An on-premises, public-facing HTTP/HTTPS web service that generates JSON output in response to GET HTTP requests |\n| Infoblox1 | Infoblox DNS service  | A third-party DNS service appliance linked to Sentinel1 by using a data connector                 |\n\nRequirements -\n\nPlanned changes -\nAdatum plans to perform the following changes:\n• Implement a query named rulequery1 that will include the following KQL query:\n\nAzureActivity\n| where ResourceProviderValue == \"MICROSOFT.CLOUDSHELL\"\n| where ActivityStatusValue == \"Start\"\n| extend \n    Account_0_Name = tostring(split(Caller, '@', 0)[0]),\n    Account_0_UPNSuffix = tostring(split(Caller, '@', 1)[0])\n| project Account_0_Name, Account_0_UPNSuffix, CallerIpAddress, TimeGenerated\n\n• Implement a Microsoft Sentinel scheduled rule that generates incidents based on rulequery1.\n\nMicrosoft Defender for Cloud Requirements:\nAdatum identifies the following Microsoft Defender for Cloud requirements:\n• The members of Group1 must be able to enable Defender for Cloud plans and apply regulatory compliance initiatives.\n• Microsoft Defender for Servers Plan 2 must be enabled on all the Azure virtual machines.\n• Server2 must be excluded from agentless scanning.\n\nMicrosoft Sentinel Requirements:\nAdatum identifies the following Microsoft Sentinel requirements:\n• Implement an Advanced Security Information Model (ASIM) query that will return a count of DNS requests that results in an NXDOMAIN response from Infoblox1.\n• Ensure that multiple alerts generated by rulequery1 in response to a single user launching Azure Cloud Shell multiple times are consolidated as a single incident.\n• Implement the Windows Security Events via AMA connector for Microsoft Sentinel and configure it to monitor the Security event log of Server1.\n• Ensure that incidents generated by rulequery1 are closed automatically if Azure Cloud Shell is launched by the company’s SecOps team.\n• Implement a custom Microsoft Sentinel workbook named Workbook1 that will include a query to dynamically retrieve data from Webapp1.\n• Implement a Microsoft Sentinel near-real-time (NRT) analytics rule that detects sign-ins to a designated break glass account.\n• Ensure that HuntingQuery1 runs automatically when the Hunting page of Microsoft Sentinel in the Azure portal is accessed.\n• Ensure that higher than normal volumes of password resets for corp.adatum.com user accounts are detected.\n• Minimize the overhead associated with queries that use ASIM parsers.\n• Ensure that the Group1 members can create and edit playbooks.\n• Use built-in ASIM parsers whenever possible.\n\nBusiness Requirements:\nAdatum identifies the following business requirements:\n• Follow the principle of least privilege whenever possible.\n• Minimize administrative effort whenever possible.\n\nYou need to implement the query for Workbook1 and Webapp1. The solution must meet the Microsoft Sentinel requirements.\n\nHow should you configure the query? To answer, select the appropriate options in the answer area.\nNOTE: Each correct selection is worth one point.",
      "options": [
        "A custom endpoint",
        "A custom resource provider",
        "JSON",
        "Enable Cross-Origin Resource Sharing (CORS).",
        "Enable Same Origin Policy (SOP).",
        "Enforce TLS 1.2."
      ],
      "answer": [
        "A custom endpoint",
        "Enable Cross-Origin Resource Sharing (CORS)."
      ],
      "explanation": "To connect external data like the JSON output from Webapp1 to a custom workbook in Microsoft Sentinel, a **custom endpoint** is used as a data source. To ensure the workbook can access the data across domain boundaries, **Cross-Origin Resource Sharing (CORS)** must be enabled on the endpoint. This allows secure cross-origin HTTP requests.\n\n→ Reference: https://learn.microsoft.com/en-us/azure/azure-monitor/visualize/workbooks-data-sources#custom-endpoint",
      "image": "Images/hotspot79.png"
    },
    {
      "type": "drag_and_drop",
      "question": "Case Study -\n\nThis is a case study. Case studies are not timed separately. You can use as much exam time as you would like to complete each case. However, there may be additional case studies and sections on this exam. You must manage your time to ensure that you are able to complete all questions included on this exam in the time provided.\n\nTo answer the questions included in a case study, you will need to reference information that is provided in the case study. Case studies might contain exhibits and other resources that provide more information about the scenario that is described in the case study. Each question is independent of the other questions in this case study.\n\nAt the end of this case study, a review screen will appear. This screen allows you to review your answers and to make changes before you move to the next section of the exam. After you begin a new section, you cannot return to this section.\n\nTo start the case study -\nTo display the first question in this case study, click the Next button. Use the buttons in the left pane to explore the content of the case study before you answer the questions. Clicking these buttons displays information such as business requirements, existing environment, and problem statements. If the case study has an All Information tab, note that the information displayed is identical to the information displayed on the subsequent tabs. When you are ready to answer a question, click the Question button to return to the question.\n\nOverview -\n\nAdatum Corporation is a United States-based financial services company that has regional offices in New York, Chicago, and San Francisco.\n\nExisting Environment -\n\nIdentity Environment -\nThe on-premises network contains an Active Directory Domain Services (AD DS) forest named corp.adatum.com that syncs with an Azure AD tenant named adatum.com. All user and group management tasks are performed in corp.adatum.com. The corp.adatum.com domain contains a group named Group1 that syncs with adatum.com.\n\nLicensing Status -\nAll the users at Adatum are assigned a Microsoft 365 E5 license and an Azure Active Directory Premium P2 license.\n\nCloud Environment -\nThe cloud environment contains a Microsoft 365 subscription, an Azure subscription linked to the adatum.com tenant, and the resources shown in the following table:\n\n| Name      | Type                          | Description                                                          |\n|-----------|-------------------------------|----------------------------------------------------------------------|\n| Sentinel1 | Microsoft Sentinel workspace  | Includes a custom hunting query named HuntingQuery1                 |\n| Server2   | Azure virtual machine         | Runs Windows Server 2022                                            |\n\nOn-premises Environment -\n\nThe on-premises network contains the resources shown in the following table:\n\n| Name      | Type                  | Description                                                                                       |\n|-----------|-----------------------|---------------------------------------------------------------------------------------------------|\n| Server1   | Server                | Runs Windows Server 2019. Has Azure Arc-enabled and the Azure Monitor agent installed             |\n| Webapp1   | Web service           | An on-premises, public-facing HTTP/HTTPS web service that generates JSON output in response to GET HTTP requests |\n| Infoblox1 | Infoblox DNS service  | A third-party DNS service appliance linked to Sentinel1 by using a data connector                 |\n\nRequirements -\n\nPlanned changes -\nAdatum plans to perform the following changes:\n• Implement a query named rulequery1 that will include the following KQL query:\n\nAzureActivity\n| where ResourceProviderValue == \"MICROSOFT.CLOUDSHELL\"\n| where ActivityStatusValue == \"Start\"\n| extend \n    Account_0_Name = tostring(split(Caller, '@', 0)[0]),\n    Account_0_UPNSuffix = tostring(split(Caller, '@', 1)[0])\n| project Account_0_Name, Account_0_UPNSuffix, CallerIpAddress, TimeGenerated\n\n• Implement a Microsoft Sentinel scheduled rule that generates incidents based on rulequery1.\n\nMicrosoft Defender for Cloud Requirements:\nAdatum identifies the following Microsoft Defender for Cloud requirements:\n• The members of Group1 must be able to enable Defender for Cloud plans and apply regulatory compliance initiatives.\n• Microsoft Defender for Servers Plan 2 must be enabled on all the Azure virtual machines.\n• Server2 must be excluded from agentless scanning.\n\nMicrosoft Sentinel Requirements:\nAdatum identifies the following Microsoft Sentinel requirements:\n• Implement an Advanced Security Information Model (ASIM) query that will return a count of DNS requests that results in an NXDOMAIN response from Infoblox1.\n• Ensure that multiple alerts generated by rulequery1 in response to a single user launching Azure Cloud Shell multiple times are consolidated as a single incident.\n• Implement the Windows Security Events via AMA connector for Microsoft Sentinel and configure it to monitor the Security event log of Server1.\n• Ensure that incidents generated by rulequery1 are closed automatically if Azure Cloud Shell is launched by the company’s SecOps team.\n• Implement a custom Microsoft Sentinel workbook named Workbook1 that will include a query to dynamically retrieve data from Webapp1.\n• Implement a Microsoft Sentinel near-real-time (NRT) analytics rule that detects sign-ins to a designated break glass account.\n• Ensure that HuntingQuery1 runs automatically when the Hunting page of Microsoft Sentinel in the Azure portal is accessed.\n• Ensure that higher than normal volumes of password resets for corp.adatum.com user accounts are detected.\n• Minimize the overhead associated with queries that use ASIM parsers.\n• Ensure that the Group1 members can create and edit playbooks.\n• Use built-in ASIM parsers whenever possible.\n\nBusiness Requirements:\nAdatum identifies the following business requirements:\n• Follow the principle of least privilege whenever possible.\n• Minimize administrative effort whenever possible.\n\nYou need to implement the Microsoft Sentinel NRT rule for monitoring the designated break glass account. The solution must meet the Microsoft Sentinel requirements.\n\nHow should you complete the query? To answer, select the appropriate options in the answer area.\nNOTE: Each correct selection is worth one point.",
      "options": [
        "join",
        "lookup",
        "union",
        "_GetWatchlist",
        "external_table",
        "materialized_view"
      ],
      "answer": [
        "join",
        "_GetWatchlist"
      ],
      "explanation": "To monitor access from a designated break glass account using a Near-Real-Time (NRT) rule in Microsoft Sentinel, you can reference a watchlist containing the break glass accounts and **join** it with log data such as sign-in attempts.\n\n- The `_GetWatchlist` function is used to retrieve the list of monitored accounts from the watchlist.\n- The `join` operator is then used to match log records (e.g., sign-in attempts) with the entries in the watchlist.\n\nThis approach is efficient, aligns with best practices for security monitoring, and satisfies the requirement for real-time analytics.\n\n**Reference**: https://learn.microsoft.com/en-us/azure/sentinel/watchlists#reference-a-watchlist-in-a-kql-query",
      "image": "Images/hotspot78.png"
    },
    {
      "type": "drag_and_drop",
      "question": "Case Study -\n\nThis is a case study. Case studies are not timed separately. You can use as much exam time as you would like to complete each case. However, there may be additional case studies and sections on this exam. You must manage your time to ensure that you are able to complete all questions included on this exam in the time provided.\n\nTo answer the questions included in a case study, you will need to reference information that is provided in the case study. Case studies might contain exhibits and other resources that provide more information about the scenario that is described in the case study. Each question is independent of the other questions in this case study.\n\nAt the end of this case study, a review screen will appear. This screen allows you to review your answers and to make changes before you move to the next section of the exam. After you begin a new section, you cannot return to this section.\n\nTo start the case study -\nTo display the first question in this case study, click the Next button. Use the buttons in the left pane to explore the content of the case study before you answer the questions. Clicking these buttons displays information such as business requirements, existing environment, and problem statements. If the case study has an All Information tab, note that the information displayed is identical to the information displayed on the subsequent tabs. When you are ready to answer a question, click the Question button to return to the question.\n\nOverview -\n\nAdatum Corporation is a United States-based financial services company that has regional offices in New York, Chicago, and San Francisco.\n\nExisting Environment -\n\nIdentity Environment -\nThe on-premises network contains an Active Directory Domain Services (AD DS) forest named corp.adatum.com that syncs with an Azure AD tenant named adatum.com. All user and group management tasks are performed in corp.adatum.com. The corp.adatum.com domain contains a group named Group1 that syncs with adatum.com.\n\nLicensing Status -\nAll the users at Adatum are assigned a Microsoft 365 E5 license and an Azure Active Directory Premium P2 license.\n\nCloud Environment -\nThe cloud environment contains a Microsoft 365 subscription, an Azure subscription linked to the adatum.com tenant, and the resources shown in the following table:\n\n| Name      | Type                          | Description                                                          |\n|-----------|-------------------------------|----------------------------------------------------------------------|\n| Sentinel1 | Microsoft Sentinel workspace  | Includes a custom hunting query named HuntingQuery1                 |\n| Server2   | Azure virtual machine         | Runs Windows Server 2022                                            |\n\nOn-premises Environment -\n\nThe on-premises network contains the resources shown in the following table:\n\n| Name      | Type                  | Description                                                                                       |\n|-----------|-----------------------|---------------------------------------------------------------------------------------------------|\n| Server1   | Server                | Runs Windows Server 2019. Has Azure Arc-enabled and the Azure Monitor agent installed             |\n| Webapp1   | Web service           | An on-premises, public-facing HTTP/HTTPS web service that generates JSON output in response to GET HTTP requests |\n| Infoblox1 | Infoblox DNS service  | A third-party DNS service appliance linked to Sentinel1 by using a data connector                 |\n\nRequirements -\n\nPlanned changes -\nAdatum plans to perform the following changes:\n• Implement a query named rulequery1 that will include the following KQL query:\n\nAzureActivity\n| where ResourceProviderValue == \"MICROSOFT.CLOUDSHELL\"\n| where ActivityStatusValue == \"Start\"\n| extend \n    Account_0_Name = tostring(split(Caller, '@', 0)[0]),\n    Account_0_UPNSuffix = tostring(split(Caller, '@', 1)[0])\n| project Account_0_Name, Account_0_UPNSuffix, CallerIpAddress, TimeGenerated\n\n• Implement a Microsoft Sentinel scheduled rule that generates incidents based on rulequery1.\n\nMicrosoft Defender for Cloud Requirements:\nAdatum identifies the following Microsoft Defender for Cloud requirements:\n• The members of Group1 must be able to enable Defender for Cloud plans and apply regulatory compliance initiatives.\n• Microsoft Defender for Servers Plan 2 must be enabled on all the Azure virtual machines.\n• Server2 must be excluded from agentless scanning.\n\nMicrosoft Sentinel Requirements:\nAdatum identifies the following Microsoft Sentinel requirements:\n• Implement an Advanced Security Information Model (ASIM) query that will return a count of DNS requests that results in an NXDOMAIN response from Infoblox1.\n• Ensure that multiple alerts generated by rulequery1 in response to a single user launching Azure Cloud Shell multiple times are consolidated as a single incident.\n• Implement the Windows Security Events via AMA connector for Microsoft Sentinel and configure it to monitor the Security event log of Server1.\n• Ensure that incidents generated by rulequery1 are closed automatically if Azure Cloud Shell is launched by the company’s SecOps team.\n• Implement a custom Microsoft Sentinel workbook named Workbook1 that will include a query to dynamically retrieve data from Webapp1.\n• Implement a Microsoft Sentinel near-real-time (NRT) analytics rule that detects sign-ins to a designated break glass account.\n• Ensure that HuntingQuery1 runs automatically when the Hunting page of Microsoft Sentinel in the Azure portal is accessed.\n• Ensure that higher than normal volumes of password resets for corp.adatum.com user accounts are detected.\n• Minimize the overhead associated with queries that use ASIM parsers.\n• Ensure that the Group1 members can create and edit playbooks.\n• Use built-in ASIM parsers whenever possible.\n\nBusiness Requirements:\nAdatum identifies the following business requirements:\n• Follow the principle of least privilege whenever possible.\n• Minimize administrative effort whenever possible.\n\nYou need to implement the ASIM query for DNS requests. The solution must meet the Microsoft Sentinel requirements..\n\nHow should you configure the query? To answer, select the appropriate options in the answer area.\nNOTE: Each correct selection is worth one point.",
      "options": [
        "1| _Im_Dns",
        "2| _Im_Dns_InfobloxNIOS",
        "3| imDns",
        "4| A filtering parameter",
        "5| A pack parameter",
        "6| The WHERE clause"
      ],
      "answer": [
        "1| _Im_Dns",
        "4| A filtering parameter"
      ],
      "explanation": "o meet the requirement of using built-in ASIM parsers and minimize overhead, you should use the **_Im_Dns** table which is the normalized parser for DNS events across multiple sources.\n\nAdditionally, to filter events (such as for NXDOMAIN responses), you should use a **filtering parameter** with the ASIM parser, which allows efficient querying without needing to manipulate raw fields directly in the query logic.\n\n- **_Im_Dns** is preferred because it is a normalized schema provided by Microsoft for DNS events across sources like Windows, Infoblox, etc.\n- **Filtering parameters** allow using ASIM parsers with dynamic and efficient filtering, minimizing performance impact.\n\nReferences:\n- https://learn.microsoft.com/en-us/azure/sentinel/normalization-about-parsers",
      "image": "Images/hotspot77.png"
    },
    {
      "type": "drag_and_drop",
      "question": "Case Study -\n\nThis is a case study. Case studies are not timed separately. You can use as much exam time as you would like to complete each case. However, there may be additional case studies and sections on this exam. You must manage your time to ensure that you are able to complete all questions included on this exam in the time provided.\n\nTo answer the questions included in a case study, you will need to reference information that is provided in the case study. Case studies might contain exhibits and other resources that provide more information about the scenario that is described in the case study. Each question is independent of the other questions in this case study.\n\nAt the end of this case study, a review screen will appear. This screen allows you to review your answers and to make changes before you move to the next section of the exam. After you begin a new section, you cannot return to this section.\n\nTo start the case study -\nTo display the first question in this case study, click the Next button. Use the buttons in the left pane to explore the content of the case study before you answer the questions. Clicking these buttons displays information such as business requirements, existing environment, and problem statements. If the case study has an All Information tab, note that the information displayed is identical to the information displayed on the subsequent tabs. When you are ready to answer a question, click the Question button to return to the question.\n\nOverview -\n\nAdatum Corporation is a United States-based financial services company that has regional offices in New York, Chicago, and San Francisco.\n\nExisting Environment -\n\nIdentity Environment -\nThe on-premises network contains an Active Directory Domain Services (AD DS) forest named corp.adatum.com that syncs with an Azure AD tenant named adatum.com. All user and group management tasks are performed in corp.adatum.com. The corp.adatum.com domain contains a group named Group1 that syncs with adatum.com.\n\nLicensing Status -\nAll the users at Adatum are assigned a Microsoft 365 E5 license and an Azure Active Directory Premium P2 license.\n\nCloud Environment -\nThe cloud environment contains a Microsoft 365 subscription, an Azure subscription linked to the adatum.com tenant, and the resources shown in the following table:\n\n| Name      | Type                          | Description                                                          |\n|-----------|-------------------------------|----------------------------------------------------------------------|\n| Sentinel1 | Microsoft Sentinel workspace  | Includes a custom hunting query named HuntingQuery1                 |\n| Server2   | Azure virtual machine         | Runs Windows Server 2022                                            |\n\nOn-premises Environment -\n\nThe on-premises network contains the resources shown in the following table:\n\n| Name      | Type                  | Description                                                                                       |\n|-----------|-----------------------|---------------------------------------------------------------------------------------------------|\n| Server1   | Server                | Runs Windows Server 2019. Has Azure Arc-enabled and the Azure Monitor agent installed             |\n| Webapp1   | Web service           | An on-premises, public-facing HTTP/HTTPS web service that generates JSON output in response to GET HTTP requests |\n| Infoblox1 | Infoblox DNS service  | A third-party DNS service appliance linked to Sentinel1 by using a data connector                 |\n\nRequirements -\n\nPlanned changes -\nAdatum plans to perform the following changes:\n• Implement a query named rulequery1 that will include the following KQL query:\n\nAzureActivity\n| where ResourceProviderValue == \"MICROSOFT.CLOUDSHELL\"\n| where ActivityStatusValue == \"Start\"\n| extend \n    Account_0_Name = tostring(split(Caller, '@', 0)[0]),\n    Account_0_UPNSuffix = tostring(split(Caller, '@', 1)[0])\n| project Account_0_Name, Account_0_UPNSuffix, CallerIpAddress, TimeGenerated\n\n• Implement a Microsoft Sentinel scheduled rule that generates incidents based on rulequery1.\n\nMicrosoft Defender for Cloud Requirements:\nAdatum identifies the following Microsoft Defender for Cloud requirements:\n• The members of Group1 must be able to enable Defender for Cloud plans and apply regulatory compliance initiatives.\n• Microsoft Defender for Servers Plan 2 must be enabled on all the Azure virtual machines.\n• Server2 must be excluded from agentless scanning.\n\nMicrosoft Sentinel Requirements:\nAdatum identifies the following Microsoft Sentinel requirements:\n• Implement an Advanced Security Information Model (ASIM) query that will return a count of DNS requests that results in an NXDOMAIN response from Infoblox1.\n• Ensure that multiple alerts generated by rulequery1 in response to a single user launching Azure Cloud Shell multiple times are consolidated as a single incident.\n• Implement the Windows Security Events via AMA connector for Microsoft Sentinel and configure it to monitor the Security event log of Server1.\n• Ensure that incidents generated by rulequery1 are closed automatically if Azure Cloud Shell is launched by the company’s SecOps team.\n• Implement a custom Microsoft Sentinel workbook named Workbook1 that will include a query to dynamically retrieve data from Webapp1.\n• Implement a Microsoft Sentinel near-real-time (NRT) analytics rule that detects sign-ins to a designated break glass account.\n• Ensure that HuntingQuery1 runs automatically when the Hunting page of Microsoft Sentinel in the Azure portal is accessed.\n• Ensure that higher than normal volumes of password resets for corp.adatum.com user accounts are detected.\n• Minimize the overhead associated with queries that use ASIM parsers.\n• Ensure that the Group1 members can create and edit playbooks.\n• Use built-in ASIM parsers whenever possible.\n\nBusiness Requirements:\nAdatum identifies the following business requirements:\n• Follow the principle of least privilege whenever possible.\n• Minimize administrative effort whenever possible.\n\nYou need to monitor the password resets. The solution must meet the Microsoft Sentinel requirements.\n\nWhat should you do? To answer, select the appropriate options in the answer area.NOTE: Each correct selection is worth one point.",
      "options": [
        "1| Azure AD Password Protection",
        "2| Microsoft Defender for Identity",
        "3| Smart lockout",
        "4| A Microsoft security rule",
        "5| The Windows Security Events via AMA connector",
        "6| User and Entity Behavior Analytics (UEBA)"
      ],
      "answer": [
        "2| Microsoft Defender for Identity",
        "6| User and Entity Behavior Analytics (UEBA)"
      ],
      "explanation": "To detect high volumes of password resets for on-premises user accounts, Microsoft Defender for Identity (MDI) must be used to monitor AD DS activity. \nThis integrates with Microsoft Sentinel through UEBA, enabling behavior-based anomaly detection for identity-related activities.\n\nMDI provides deep visibility into user behavior, including password reset activities, while UEBA in Sentinel allows detection of unusual patterns, such as a spike in resets.\n\nAzure AD Password Protection and Smart lockout primarily focus on Azure AD and sign-in protection but do not provide the necessary telemetry for Sentinel to detect reset spikes in corp.adatum.com accounts.\n\nReferences:\n- https://learn.microsoft.com/en-us/azure/sentinel/enable-entity-behavior-analytics",
      "image": "Images/hotspot76.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have four Azure subscriptions. One of the subscriptions contains a Microsoft Sentinel workspace.\n\nYou need to deploy Microsoft Sentinel data connectors to collect data from the subscriptions by using Azure Policy. The solution must ensure that the policy will apply to new and existing resources in the subscriptions.\n\nWhich type of connectors should you provision, and what should you use to ensure that all the resources are monitored? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "API-based",
        "Diagnostic settings",
        "Log Analytics agent-based",
        "A remediation task",
        "A workbook",
        "An analytics rule"
      ],
      "answer": [
        "Diagnostic settings",
        "A remediation task"
      ],
      "explanation": "To collect data from multiple Azure subscriptions using Microsoft Sentinel and Azure Policy, you use **Diagnostic settings-based connectors**, which allow you to configure data collection from Azure resources. **A remediation task** ensures that policy assignments apply retroactively to existing resources as well as to new ones.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/connect-services-diagnostic-setting-based",
      "image": "Images/hotspot75.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft Sentinel workspace that contains a custom workbook.\n\nYou need to query the number of daily security alerts. The solution must meet the following requirements:\n\n• Identify alerts that occurred during the last 30 days.\n• Display the results in a timechart.\n\nHow should you complete the query? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "lookup",
        "project",
        "Summarize",
        "bin",
        "make series",
        "range"
      ],
      "answer": [
        "Summarize",
        "bin"
      ],
      "explanation": "To query time-series data for daily security alerts over the past 30 days and display them in a timechart, you use the `summarize` operator to aggregate results (e.g., by count), and `bin` to group the data by time intervals such as days. This enables effective visualization in a workbook.\n\nReference: https://learn.microsoft.com/en-us/azure/data-explorer/kusto/query/binfunction \n https://learn.microsoft.com/en-us/kusto/query/summarize-operator?view=microsoft-fabric ",
      "image": "Images/hotspot74.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have an Azure subscription that contains two users named User1 and User2 and a Microsoft Sentinel workspace named workspace1.\n\nYou need to ensure that the users can perform the following tasks in workspace1:\n• User1 must be able to dismiss incidents and assign incidents to users.\n• User2 must be able to modify analytics rules.\n\nThe solution must use the principle of least privilege.\n\nWhich role should you assign to each user? To answer, drag the appropriate roles to the correct users. Each role may be used once, more than once, or not at all. You may need to drag the split bar between panes or scroll to view content.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "Contributor",
        "Microsoft Sentinel Automation Contributor",
        "Microsoft Sentinel Contributor",
        "Microsoft Sentinel Reader",
        "Microsoft Sentinel Responder",
        "Reader"
      ],
      "answer": [
        "Microsoft Sentinel Responder",
        "Microsoft Sentinel Contributor"
      ],
      "explanation": "The **Microsoft Sentinel Responder** role provides just enough permissions for User1 to view, assign, and dismiss incidents—perfect for incident response tasks while maintaining least privilege.\n\nThe **Microsoft Sentinel Contributor** role allows User2 to create and modify analytics rules, perform investigation, and manage other core components in Microsoft Sentinel.\n\nThis approach aligns with the principle of least privilege by ensuring each user only gets the permissions needed for their role.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/roles",
      "image": "Images/hotspot73.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft Sentinel workspace.\n\nYou need to configure a report visual for a custom workbook. The solution must meet the following requirements:\n• The count and usage trend of AppDisplayName must be included.\n• The TrendList column must be useable in a sparkline visual.\n\nHow should you complete the KQL query? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "join",
        "let",
        "lookup",
        "mv-expand",
        "make_bag()",
        "make-series",
        "mv-expand",
        "render"
      ],
      "answer": [
        "join",
        "make-series"
      ],
      "explanation": "To fulfill the requirement of correlating data and visualizing trends over time in a sparkline visual, the `join` operator is used to combine data from multiple sources, enabling relationship building across datasets.\n\nThe `make-series` operator is necessary to build time series data that can feed into sparklines. It creates arrays (TrendList column) of values over defined time intervals, which are critical for visualizing usage trends effectively.\n\nUsing `make-series` instead of `summarize` is crucial here, as `make-series` explicitly structures data into a series format, making it suitable for sparkline visuals.\n\nReference:\n- https://www.cloudsma.com/2021/04/kusto-make-series-vs-summarize/",
      "image": "Images/hotspot72.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have an Azure subscription that contains a Microsoft Sentinel workspace.\n\nYou need to create a hunting query using Kusto Query Language (KQL) that meets the following requirements:\n\n• Identifies an anomalous number of changes to the rules of a network security group (NSG) made by the same security principal.\n• Automatically associates the security principal with a Microsoft Sentinel entity.\n\nHow should you complete the query? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "AuditLogs",
        "AzureActivity",
        "AzureDiagnostics",
        "| extend",
        "| parse-where",
        "| where"
      ],
      "answer": [
        "AzureActivity",
        "| extend"
      ],
      "explanation": "To detect anomalous changes to NSG rules, the correct data source is **AzureActivity**, as it logs administrative operations like NSG rule updates.\nThe `| extend` operator is then used to add contextual fields (e.g., principal identity) for use in entity mapping within Microsoft Sentinel.\n\nThis approach also allows Microsoft Sentinel to link the security principal to an entity for UEBA and investigation workflows.\n\nReferences:\n- https://learn.microsoft.com/en-us/azure/sentinel/hunting\n- https://learn.microsoft.com/en-us/azure/data-explorer/kusto/query/extendoperator\n- https://learn.microsoft.com/en-us/azure/azure-monitor/reference/tables/azureactivity",
      "image": "Images/hotspot71.png"
    },
    {
      "type": "drag_and_drop",
      "question": "Your network contains an on-premises Active Directory Domain Services (AD DS) domain that syncs with an Azure AD tenant.\n\nYou have a Microsoft Sentinel workspace named Sentinel1.\n\nYou need to enable User and Entity Behavior Analytics (UEBA) for Sentinel1 and collect security events from the AD DS domain.\n\nWhich three actions should you perform in sequence? To answer, move the appropriate actions from the list of actions to the answer area and arrange them in the correct order.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "For Sentinel1, configure the Windows Forwarded Events connector.",
        "To the AD DS domain, deploy Microsoft Defender for Identity.",
        "For the AD DS domain, configure Windows Event Forwarding.",
        "From Sentinel1, collect the AD DS security events by using the Legacy Agent connector.",
        "For Sentinel1, configure the Microsoft Defender for Identity connector.",
        "For Sentinel1, enable UEBA."
      ],
      "answer": [
        "To the AD DS domain, deploy Microsoft Defender for Identity.",
        "For Sentinel1, configure the Microsoft Defender for Identity connector.",
        "For Sentinel1, enable UEBA."
      ],
      "explanation": "**Step 1**: Deploy Microsoft Defender for Identity on the on-premises AD DS domain to begin monitoring domain controller traffic for behavioral analysis.\n\n**Step 2**: Configure the Microsoft Defender for Identity connector in Sentinel to integrate identity-based signals and telemetry into the workspace.\n\n**Step 3**: Enable UEBA in Microsoft Sentinel to leverage behavioral analytics features based on identity data from Defender for Identity.\n\nThis configuration pipeline ensures that Sentinel can ingest identity-related signals, correlate them with behavioral baselines, and raise alerts based on anomalous patterns.\n\n🔗 Reference: https://learn.microsoft.com/en-us/azure/sentinel/enable-entity-behavior-analytics",
      "image": "Images/hotspot70.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have an Azure subscription that contains the following resources:\n\n• A virtual machine named VM1 that runs Windows Server\n• A Microsoft Sentinel workspace named Sentinel1 that has User and Entity Behavior Analytics (UEBA) enabled\n\nYou have a scheduled query rule named Rule1 that tracks sign-in attempts to VM1.\n\nYou need to update Rule1 to detect when a user from outside the IT department of your company signs in to VM1. The solution must meet the following requirements:\n\n• Utilize UEBA results.\n• Maximize query performance.\n• Minimize the number of false positives.\n\nHow should you complete the rule definition? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "anti",
        "fullouter",
        "inner",
        "BehaviorAnalytics",
        "IdentityInfo",
        "SigninLogs"
      ],
      "answer": [
        "inner",
        "IdentityInfo"
      ],
      "explanation": "To meet the performance and accuracy requirements, you should use the **`inner`** join to only match relevant records across both datasets. This avoids the unnecessary overhead and noise from joins like `fullouter`.\n\n**`IdentityInfo`** is the correct enrichment table containing department metadata (such as identifying non-IT users), which can be used in correlation with UEBA signals to filter for unauthorized or anomalous access events.\n\nThis setup effectively maximizes performance while minimizing false positives.\n\n🔗 Reference: https://learn.microsoft.com/en-us/azure/sentinel/identify-threats-with-entity-behavior",
      "image": "Images/hotspot69.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have an Azure subscription that uses Microsoft Sentinel and contains a user named User1.\n\nYou need to ensure that User1 can enable User and Entity Behavior Analytics (UEBA) for entity behavior in Azure AD. The solution must use the principle of least privilege.\n\nWhich roles should you assign to User1? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "Global administrator",
        "Identity Governance Administrator",
        "Security administrator",
        "Security operator",
        "Microsoft Sentinel Automation Contributor",
        "Microsoft Sentinel Contributor",
        "Security Admin",
        "Security Assessment Contributor"
      ],
      "answer": [
        "Security administrator",
        "Microsoft Sentinel Contributor"
      ],
      "explanation": "**Security administrator** is required to manage security settings including enabling features like UEBA.\n\n**Microsoft Sentinel Contributor** allows managing Microsoft Sentinel settings, including enabling and configuring UEBA.\n\nThis combination meets the need to enable UEBA while respecting the principle of least privilege—avoiding overly permissive roles such as *Global administrator*.\n\n🔗 Reference: https://learn.microsoft.com/en-us/azure/sentinel/enable-entity-behavior-analytic",
      "image": "Images/hotspot68.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have an Azure subscription that contains a guest user named User1 and a Microsoft Sentinel workspace named workspace1.\n\nYou need to ensure that User1 can triage Microsoft Sentinel incidents in workspace1. The solution must use the principle of least privilege.\n\nWhich roles should you assign to User1? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "Microsoft Sentinel Automation Contributor",
        "Microsoft Sentinel Contributor",
        "Microsoft Sentinel Responder",
        "Attribute assignment reader",
        "Directory readers",
        "Global reader"
      ],
      "answer": [
        "Microsoft Sentinel Responder",
        "Directory readers"
      ],
      "explanation": "To allow **User1** to triage Microsoft Sentinel incidents with **least privilege**, the following roles are appropriate:\n\n- **Microsoft Sentinel Responder**: Grants permission to view and update incidents, comments, and assignments. This role is designed for incident responders.\n- **Directory Readers**: Grants read-only access to directory data, which is required to resolve entity data (e.g., usernames, groups) during investigations.\n\nRoles like *Global reader* or *Microsoft Sentinel Contributor* provide broader access than necessary, and *Automation Contributor* relates to playbooks, not incident triage.\n\n🔗 Reference: https://learn.microsoft.com/en-us/azure/sentinel/investigate-incidents",
      "image": "Images/hotspot67.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft Sentinel workspace that contains an Azure AD data connector.\n\nYou need to associate a bookmark with an Azure AD-related incident.\n\nWhat should you do? To answer, drag the appropriate blades to the correct tasks. Each blade may be used once, more than once, or not at all. You may need to drag the split bar between panes or scroll to view content.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "Hunting blade",
        "Incident blade",
        "Logs blade"
      ],
      "answer": [
        "Logs blade",
        "Hunting blade"
      ],
      "explanation": "To associate a bookmark with an incident, you must first create the bookmark from a relevant query:\n\n- Use the **Logs blade** to run KQL queries against Azure AD logs. Once you identify a pattern or threat, you can create a **bookmark** from the query result.\n- Then, use the **Hunting blade** to associate the bookmark with incidents or investigations during threat hunting activities.\n\nThe **Incident blade** is not used directly for bookmark creation or association.\n\n🔗 Reference: https://learn.microsoft.com/en-us/azure/sentinel/bookmarks",
      "image": "Images/hotspot66.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft Sentinel workspace named sws1.\n\n        You need to create a query that will detect when a user creates an unusually large number of Azure AD user accounts.\n\n        How should you complete the query? To answer, select the appropriate options in the answer area.\n\n        NOTE: Each correct selection is worth one point.",
      "options": [
        "1| AuditLogs",
        "2| AzureActivity",
        "3| BehaviorAnalytics",
        "4| SecurityEvent"
      ],
      "answer": [
        "3| BehaviorAnalytics",
        "1| AuditLogs"
      ],
      "explanation": "To detect unusually high volumes of user creation activity in Azure AD, we use a combination of behavioral insights and direct audit logs:\n\n        - **BehaviorAnalytics**: This ASIM table provides behavioral insights (like `ActivityInsights`) that highlight anomalies in user actions. It is optimal for detecting unusual account creation behavior.\n        - **AuditLogs**: This table records detailed Azure AD activity logs, including account creation (`ActionType == \"Add user\"`), which is necessary to join and project specific event metadata.\n\n        The query leverages these two sources to correlate anomalous patterns with actual audit trail events, enabling targeted threat detection in Sentinel.\n\n        References:\n        - https://learn.microsoft.com/en-us/azure/azure-monitor/reference/tables/behavioranalytics\n        - https://learn.microsoft.com/en-us/azure/azure-monitor/reference/tables/auditlogs",
      "image": "Images/hotspot65.png"
    },
    {
      "type": "drag_and_drop",
      "question": "Case study -\n\nThis is a case study. Case studies are not timed separately. You can use as much exam time as you would like to complete each case. However, there may be additional case studies and sections on this exam. You must manage your time to ensure that you are able to complete all questions included in the time provided.\n\nTo answer the questions included in a case study, you will need to reference information that is provided in the case study. Case studies might contain exhibits and other resources that provide more information about the scenario that is described in the case study. Each question is independent of the other questions in this case study.\n\nAt the end of this case study, a review screen will appear. This screen allows you to review your answers and to make changes before you move to the next section of the exam. After you begin a new section, you cannot return to this section.\n\nTo start the case study -\nTo display the first question in this case study, click the Next button. Use the buttons in the left pane to explore the content of the case study before you answer the questions. Clicking these buttons displays information such as business requirements, existing environment, and problem statements. If the case study has an All Information tab, note that the information displayed is identical to the information displayed on the subsequent tabs. When you are ready to answer a question, click the Question button to return to the question.\n\nOverview -\n\nFabrikam, Inc. is a financial services company.\n\nThe company has branch offices in New York, London, and Singapore. Fabrikam has remote users located across the globe. The remote users access company resources, including cloud resources, by using a VPN connection to a branch office.\n\nExisting Environment -\n\nIdentity Environment -\n\nThe network contains an Active Directory Domain Services (AD DS) forest named fabrikam.com that syncs with an Azure AD tenant named fabrikam.com. To sync the forest, Fabrikam uses Azure AD Connect with pass-through authentication enabled and password hash synchronization disabled.\n\nThe fabrikam.com forest contains two global groups named Group1 and Group2.\n\nMicrosoft 365 Environment -\n\nAll the users at Fabrikam are assigned a Microsoft 365 E5 license and an Azure Active Directory Premium Plan 2 license.\n\nFabrikam implements Microsoft Defender for Identity and Microsoft Defender for Cloud Apps and enables log collectors.\n\nAzure Environment -\n\nFabrikam has an Azure subscription that contains the resources shown in the following table:\n\n| Name      | Type                              | Description                                                                                           |\n|-----------|-----------------------------------|-------------------------------------------------------------------------------------------------------|\n| App1      | Azure logic app                   | To automate incident generation in an internal ticketing system, the security operations (SecOps) team invokes App1 by using an HTTP endpoint. |\n| SAWkspc1  | Azure Synapse Analytics workspace | SAWkspc1 hosts an Apache Spark pool named Pool1.                                                      |\n| LAWkspc1  | Log Analytics workspace           | LAWkspc1 will be used in a planned Microsoft Sentinel implementation.                                 |\n\nAmazon Web Services (AWS) Environment\n\nFabrikam has an Amazon Web Services (AWS) account named Account1. Account1 contains 100 Amazon Elastic Compute Cloud (EC2) instances that run a custom Windows Server 2022. The image includes Microsoft SQL Server 2019 and does NOT have any agents installed.\n\nCurrent Issues -\n\nWhen the users use the VPN connections, Microsoft 365 Defender raises a high volume of impossible travel alerts that are false positives.\nDefender for Identity raises a high volume of Suspected DCSync attack alerts that are false positives.\n\nRequirements -\n\nPlanned changes -\n\nFabrikam plans to implement the following services:\n• Microsoft Defender for Cloud\n• Microsoft Sentinel\n\nBusiness Requirements -\n\nFabrikam identifies the following business requirements:\n• Use the principle of least privilege, whenever possible.\n• Minimize administrative effort.\n\nMicrosoft Defender for Cloud Apps Requirements\n\nFabrikam identifies the following Microsoft Defender for Cloud Apps requirements:\n• Ensure that impossible travel alert policies are based on the previous activities of each user.\n• Reduce the amount of impossible travel alerts that are false positives.\n\nMicrosoft Defender for Identity Requirements\n\nMinimize the administrative effort required to investigate the false positive alerts.\n\nMicrosoft Defender for Cloud Requirements\n\nFabrikam identifies the following Microsoft Defender for Cloud requirements:\n• Ensure that the members of Group2 can modify security policies.\n• Ensure that the members of Group1 can assign regulatory compliance policy initiatives at the Azure subscription level.\n• Automate the deployment of the Azure Connected Machine agent for Azure Arc-enabled servers to the existing and future resources of Account1.\n• Minimize the administrative effort required to investigate the false positive alerts.\n\nMicrosoft Sentinel Requirements\n\nFabrikam identifies the following Microsoft Sentinel requirements:\n• Query for NXDOMAIN DNS requests from the last seven days by using built-in Advanced Security Information Model (ASIM) unifying parsers.\n• From AWS EC2 instances, collect Windows Security event log entries that include local group membership changes.\n• Identify anomalous activities of Azure AD users by using User and Entity Behavior Analytics (UEBA).\n• Evaluate the potential impact of compromised Azure AD user credentials by using UEBA.\n• Ensure that App1 is available for use in Microsoft Sentinel automation rules.\n• Identify the mean time to triage for incidents generated during the last 30 days.\n• Identify the mean time to close incidents generated during the last 30 days.\n• Ensure that the members of Group1 can create and run playbooks.\n• Ensure that the members of Group1 can manage analytics rules.\n• Run hunting queries on Pool1 by using Jupyter notebooks.\n• Ensure that the members of Group2 can manage incidents.\n• Maximize the performance of data queries.\n• Minimize the amount of collected data.\nYou need to meet the Microsoft Sentinel requirements for collecting Windows Security event logs.\nWhat should you do? To answer, select the appropriate options in the answer area.\n",
      "options": [
        "Azure Monitor agent",
        "Windows Azure VM Agent",
        "Log Analytics agent",
        "KQL",
        "WQL",
        "XPath"
      ],
      "answer": [
        "Log Analytics agent",
        "KQL"
      ],
      "explanation": "To collect Windows Security event logs from AWS EC2 instances running Windows Server, you need to:\n\n1. **Install the Log Analytics agent**: This agent is required to send log data from non-Azure Windows machines (including AWS EC2 instances) to Azure Monitor, which is used by Microsoft Sentinel.\n\n2. **Use KQL (Kusto Query Language)**: KQL is the query language used by Microsoft Sentinel to analyze and visualize data collected in Log Analytics workspaces. It allows you to create complex queries for threat detection, log correlation, and incident investigation.\n\nOther options:\n- Azure Monitor Agent is primarily used for Azure VMs and newer scenarios but not supported for all AWS cases yet.\n- Windows Azure VM Agent is used for Azure IaaS VMs only, not applicable for AWS.\n- WQL and XPath are local event query methods but not supported for Sentinel queries.\n\nReference: https://learn.microsoft.com/en-us/azure/azure-monitor/agents/azure-monitor-agent-migration",
      "image": "Images/hotspot64.png"
    },
    {
      "type": "drag_and_drop",
      "question": "Case study -\n\nThis is a case study. Case studies are not timed separately. You can use as much exam time as you would like to complete each case. However, there may be additional case studies and sections on this exam. You must manage your time to ensure that you are able to complete all questions included in the time provided.\n\nTo answer the questions included in a case study, you will need to reference information that is provided in the case study. Case studies might contain exhibits and other resources that provide more information about the scenario that is described in the case study. Each question is independent of the other questions in this case study.\n\nAt the end of this case study, a review screen will appear. This screen allows you to review your answers and to make changes before you move to the next section of the exam. After you begin a new section, you cannot return to this section.\n\nTo start the case study -\nTo display the first question in this case study, click the Next button. Use the buttons in the left pane to explore the content of the case study before you answer the questions. Clicking these buttons displays information such as business requirements, existing environment, and problem statements. If the case study has an All Information tab, note that the information displayed is identical to the information displayed on the subsequent tabs. When you are ready to answer a question, click the Question button to return to the question.\n\nOverview -\n\nFabrikam, Inc. is a financial services company.\n\nThe company has branch offices in New York, London, and Singapore. Fabrikam has remote users located across the globe. The remote users access company resources, including cloud resources, by using a VPN connection to a branch office.\n\nExisting Environment -\n\nIdentity Environment -\n\nThe network contains an Active Directory Domain Services (AD DS) forest named fabrikam.com that syncs with an Azure AD tenant named fabrikam.com. To sync the forest, Fabrikam uses Azure AD Connect with pass-through authentication enabled and password hash synchronization disabled.\n\nThe fabrikam.com forest contains two global groups named Group1 and Group2.\n\nMicrosoft 365 Environment -\n\nAll the users at Fabrikam are assigned a Microsoft 365 E5 license and an Azure Active Directory Premium Plan 2 license.\n\nFabrikam implements Microsoft Defender for Identity and Microsoft Defender for Cloud Apps and enables log collectors.\n\nAzure Environment -\n\nFabrikam has an Azure subscription that contains the resources shown in the following table:\n\n| Name      | Type                              | Description                                                                                           |\n|-----------|-----------------------------------|-------------------------------------------------------------------------------------------------------|\n| App1      | Azure logic app                   | To automate incident generation in an internal ticketing system, the security operations (SecOps) team invokes App1 by using an HTTP endpoint. |\n| SAWkspc1  | Azure Synapse Analytics workspace | SAWkspc1 hosts an Apache Spark pool named Pool1.                                                      |\n| LAWkspc1  | Log Analytics workspace           | LAWkspc1 will be used in a planned Microsoft Sentinel implementation.                                 |\n\nAmazon Web Services (AWS) Environment\n\nFabrikam has an Amazon Web Services (AWS) account named Account1. Account1 contains 100 Amazon Elastic Compute Cloud (EC2) instances that run a custom Windows Server 2022. The image includes Microsoft SQL Server 2019 and does NOT have any agents installed.\n\nCurrent Issues -\n\nWhen the users use the VPN connections, Microsoft 365 Defender raises a high volume of impossible travel alerts that are false positives.\nDefender for Identity raises a high volume of Suspected DCSync attack alerts that are false positives.\n\nRequirements -\n\nPlanned changes -\n\nFabrikam plans to implement the following services:\n• Microsoft Defender for Cloud\n• Microsoft Sentinel\n\nBusiness Requirements -\n\nFabrikam identifies the following business requirements:\n• Use the principle of least privilege, whenever possible.\n• Minimize administrative effort.\n\nMicrosoft Defender for Cloud Apps Requirements\n\nFabrikam identifies the following Microsoft Defender for Cloud Apps requirements:\n• Ensure that impossible travel alert policies are based on the previous activities of each user.\n• Reduce the amount of impossible travel alerts that are false positives.\n\nMicrosoft Defender for Identity Requirements\n\nMinimize the administrative effort required to investigate the false positive alerts.\n\nMicrosoft Defender for Cloud Requirements\n\nFabrikam identifies the following Microsoft Defender for Cloud requirements:\n• Ensure that the members of Group2 can modify security policies.\n• Ensure that the members of Group1 can assign regulatory compliance policy initiatives at the Azure subscription level.\n• Automate the deployment of the Azure Connected Machine agent for Azure Arc-enabled servers to the existing and future resources of Account1.\n• Minimize the administrative effort required to investigate the false positive alerts.\n\nMicrosoft Sentinel Requirements\n\nFabrikam identifies the following Microsoft Sentinel requirements:\n• Query for NXDOMAIN DNS requests from the last seven days by using built-in Advanced Security Information Model (ASIM) unifying parsers.\n• From AWS EC2 instances, collect Windows Security event log entries that include local group membership changes.\n• Identify anomalous activities of Azure AD users by using User and Entity Behavior Analytics (UEBA).\n• Evaluate the potential impact of compromised Azure AD user credentials by using UEBA.\n• Ensure that App1 is available for use in Microsoft Sentinel automation rules.\n• Identify the mean time to triage for incidents generated during the last 30 days.\n• Identify the mean time to close incidents generated during the last 30 days.\n• Ensure that the members of Group1 can create and run playbooks.\n• Ensure that the members of Group1 can manage analytics rules.\n• Run hunting queries on Pool1 by using Jupyter notebooks.\n• Ensure that the members of Group2 can manage incidents.\n• Maximize the performance of data queries.\n• Minimize the amount of collected data.\nYou need to create a query to investigate DNS-related activity. The solution must meet the Microsoft Sentinel requirements.\nHow should you complete the query? To answer, select the appropriate options in the answer area.\n",
      "options": [
        "_ASim_Dns",
        "_Im_Dns",
        "imDns",
        "(starttime=ago(7d),",
        "(where TimeGenerated > ago(7d) |",
        "(where TimeGenerated < ago(7d) |"
      ],
      "answer": [
        "_Im_Dns",
        "(where TimeGenerated > ago(7d) |"
      ],
      "explanation": "The Logic App Contributor role allows managing logic apps, required for playbook creation.\nThe Microsoft Sentinel Contributor role allows full management of Sentinel features including analytics rules.\nThe Microsoft Sentinel Responder role allows users to manage incidents without full administrative privileges, aligning with the principle of least privilege.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/roleshttps://learn.microsoft.com/en-us/azure/sentinel/normalization-about-parsers#unifying-parsers",
      "image": "Images/hotspot63.png"
    },
    {
      "type": "drag_and_drop",
      "question": "Case study -\n\nThis is a case study. Case studies are not timed separately. You can use as much exam time as you would like to complete each case. However, there may be additional case studies and sections on this exam. You must manage your time to ensure that you are able to complete all questions included in the time provided.\n\nTo answer the questions included in a case study, you will need to reference information that is provided in the case study. Case studies might contain exhibits and other resources that provide more information about the scenario that is described in the case study. Each question is independent of the other questions in this case study.\n\nAt the end of this case study, a review screen will appear. This screen allows you to review your answers and to make changes before you move to the next section of the exam. After you begin a new section, you cannot return to this section.\n\nTo start the case study -\nTo display the first question in this case study, click the Next button. Use the buttons in the left pane to explore the content of the case study before you answer the questions. Clicking these buttons displays information such as business requirements, existing environment, and problem statements. If the case study has an All Information tab, note that the information displayed is identical to the information displayed on the subsequent tabs. When you are ready to answer a question, click the Question button to return to the question.\n\nOverview -\n\nFabrikam, Inc. is a financial services company.\n\nThe company has branch offices in New York, London, and Singapore. Fabrikam has remote users located across the globe. The remote users access company resources, including cloud resources, by using a VPN connection to a branch office.\n\nExisting Environment -\n\nIdentity Environment -\n\nThe network contains an Active Directory Domain Services (AD DS) forest named fabrikam.com that syncs with an Azure AD tenant named fabrikam.com. To sync the forest, Fabrikam uses Azure AD Connect with pass-through authentication enabled and password hash synchronization disabled.\n\nThe fabrikam.com forest contains two global groups named Group1 and Group2.\n\nMicrosoft 365 Environment -\n\nAll the users at Fabrikam are assigned a Microsoft 365 E5 license and an Azure Active Directory Premium Plan 2 license.\n\nFabrikam implements Microsoft Defender for Identity and Microsoft Defender for Cloud Apps and enables log collectors.\n\nAzure Environment -\n\nFabrikam has an Azure subscription that contains the resources shown in the following table:\n\n| Name      | Type                              | Description                                                                                           |\n|-----------|-----------------------------------|-------------------------------------------------------------------------------------------------------|\n| App1      | Azure logic app                   | To automate incident generation in an internal ticketing system, the security operations (SecOps) team invokes App1 by using an HTTP endpoint. |\n| SAWkspc1  | Azure Synapse Analytics workspace | SAWkspc1 hosts an Apache Spark pool named Pool1.                                                      |\n| LAWkspc1  | Log Analytics workspace           | LAWkspc1 will be used in a planned Microsoft Sentinel implementation.                                 |\n\nAmazon Web Services (AWS) Environment\n\nFabrikam has an Amazon Web Services (AWS) account named Account1. Account1 contains 100 Amazon Elastic Compute Cloud (EC2) instances that run a custom Windows Server 2022. The image includes Microsoft SQL Server 2019 and does NOT have any agents installed.\n\nCurrent Issues -\n\nWhen the users use the VPN connections, Microsoft 365 Defender raises a high volume of impossible travel alerts that are false positives.\nDefender for Identity raises a high volume of Suspected DCSync attack alerts that are false positives.\n\nRequirements -\n\nPlanned changes -\n\nFabrikam plans to implement the following services:\n• Microsoft Defender for Cloud\n• Microsoft Sentinel\n\nBusiness Requirements -\n\nFabrikam identifies the following business requirements:\n• Use the principle of least privilege, whenever possible.\n• Minimize administrative effort.\n\nMicrosoft Defender for Cloud Apps Requirements\n\nFabrikam identifies the following Microsoft Defender for Cloud Apps requirements:\n• Ensure that impossible travel alert policies are based on the previous activities of each user.\n• Reduce the amount of impossible travel alerts that are false positives.\n\nMicrosoft Defender for Identity Requirements\n\nMinimize the administrative effort required to investigate the false positive alerts.\n\nMicrosoft Defender for Cloud Requirements\n\nFabrikam identifies the following Microsoft Defender for Cloud requirements:\n• Ensure that the members of Group2 can modify security policies.\n• Ensure that the members of Group1 can assign regulatory compliance policy initiatives at the Azure subscription level.\n• Automate the deployment of the Azure Connected Machine agent for Azure Arc-enabled servers to the existing and future resources of Account1.\n• Minimize the administrative effort required to investigate the false positive alerts.\n\nMicrosoft Sentinel Requirements\n\nFabrikam identifies the following Microsoft Sentinel requirements:\n• Query for NXDOMAIN DNS requests from the last seven days by using built-in Advanced Security Information Model (ASIM) unifying parsers.\n• From AWS EC2 instances, collect Windows Security event log entries that include local group membership changes.\n• Identify anomalous activities of Azure AD users by using User and Entity Behavior Analytics (UEBA).\n• Evaluate the potential impact of compromised Azure AD user credentials by using UEBA.\n• Ensure that App1 is available for use in Microsoft Sentinel automation rules.\n• Identify the mean time to triage for incidents generated during the last 30 days.\n• Identify the mean time to close incidents generated during the last 30 days.\n• Ensure that the members of Group1 can create and run playbooks.\n• Ensure that the members of Group1 can manage analytics rules.\n• Run hunting queries on Pool1 by using Jupyter notebooks.\n• Ensure that the members of Group2 can manage incidents.\n• Maximize the performance of data queries.\n• Minimize the amount of collected data.\nYou need to assign role-based access control (RBAC) roles to Group1 and Group2 to meet the Microsoft Sentinel requirements and the business requirements.\nWhich role should you assign to each group? To answer, drag the appropriate roles to the correct groups. Each role may be used once, more than once, or not at all. You\nmay need to drag the split bar between panes or scroll to view content.\n",
      "options": [
        "Logic App Contributor",
        "Logic App Operator",
        "Microsoft Sentinel Contributor",
        "Microsoft Sentinel Playbook Operator",
        "Microsoft Sentinel Responder"
      ],
      "answer": [
        "Logic App Contributor",
        "Microsoft Sentinel Contributor",
        "Microsoft Sentinel Responder"
      ],
      "explanation": "The Logic App Contributor role allows managing logic apps, required for playbook creation.\nThe Microsoft Sentinel Contributor role allows full management of Sentinel features including analytics rules.\nThe Microsoft Sentinel Responder role allows users to manage incidents without full administrative privileges, aligning with the principle of least privilege.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/roles",
      "image": "Images/hotspot62.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft Sentinel workspace.\n\nA Microsoft Sentinel incident is generated as shown in the following exhibit.\n\nUse the drop-down menus to select the answer choice that completes each statement based on the information presented in the graphic.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "A map of the entities connected to the alert can be viewed by selecting Alerts",
        "A map of the entities connected to the alert can be viewed by selecting Entities",
        "A map of the entities connected to the alert can be viewed by selecting Investigate",
        "A list of the activities performed during the investigation can be viewed by selecting Alerts",
        "A list of the activities performed during the investigation can be viewed by selecting Bookmarks",
        "A list of the activities performed during the investigation can be viewed by selecting Comments",
        "A list of the activities performed during the investigation can be viewed by selecting Status"
      ],
      "answer": [
        "A map of the entities connected to the alert can be viewed by selecting Investigate",
        "A list of the activities performed during the investigation can be viewed by selecting Comments"
      ],
      "explanation": "In Microsoft Sentinel:\n- The **Investigate** button opens an interactive graph showing relationships between entities in an incident, including alerts.\n- The **Comments** tab is used to record investigation activity, decisions, and progress throughout the incident lifecycle.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/investigate-incidents#audit-and-comment-on-incidents\n",
      "image": "Images/hotspot61.png"
    },
    {
      "type": "drag_and_drop",
      "question": "Your on-premises network contains 100 servers that run Windows Server.\n\nYou have an Azure subscription that uses Microsoft Sentinel.\n\nYou need to upload custom logs from the on-premises servers to Microsoft Sentinel.\n\nWhat should you do? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "Azure Connected Machine agent",
        "Log Analytics agent",
        "Microsoft Dependency agent",
        "Data connectors page of Microsoft Sentinel",
        "Log Analytics workspace settings of Microsoft Sentinel",
        "Logs blade of Microsoft Sentinel"
      ],
      "answer": [
        "Log Analytics agent",
        "Data connectors page of Microsoft Sentinel"
      ],
      "explanation": "To ingest custom logs from on-premises Windows Servers to Microsoft Sentinel, you must:\n\n1. **Install the Log Analytics agent**: This agent collects data and forwards it to Azure Monitor Logs, which is the underlying data platform for Sentinel.\n2. **Use the Data connectors page** in Microsoft Sentinel to configure and connect custom log sources using the agent.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/connect-custom-logs",
      "image": "Images/hotspot60.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft Sentinel workspace named Workspace1.\n\nYou configure Workspace1 to collect DNS events and deploy the Advanced Security Information Model (ASIM) unifying parser for the DNS schema.\n\nYou need to query the ASIM DNS schema to list all the DNS events from the last 24 hours that have a response code of ‘NXDOMAIN’ and were aggregated by the source IP address in 15-minute intervals. The solution must maximize query performance.\n\nHow should you complete the query? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "_Im_Dns",
        "Dns",
        "imDns",
        "(starttime=ago(1d).responsecodename= 'NXDOMAIN'",
        "| where TimeGenerated > ago(1d) | where ResponseCodeName =~ \"NXDOMAIN\"",
        "| where ResponseCodeName == \"NXDOMAIN\" | where TimeGenerated > ago(1d)"
      ],
      "answer": [
        "_Im_Dns",
        "| where TimeGenerated > ago(1d) | where ResponseCodeName =~ \"NXDOMAIN\""
      ],
      "explanation": "To query DNS logs using ASIM in Microsoft Sentinel efficiently, use the `_Im_Dns` schema for normalized DNS events.\n\n`| where TimeGenerated > ago(1d) | where ResponseCodeName =~ \"NXDOMAIN\"` filters for events in the past 24 hours and matches the response code while ignoring case sensitivity, maximizing query performance.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/normalization-schema-dns\nReference: https://learn.microsoft.com/en-us/azure/data-explorer/kusto/query/whereoperator",
      "image": "Images/hotspot59.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft Sentinel workspace named SW1.\n\nYou plan to create a custom workbook that will include a time chart.\n\nYou need to create a query that will identify the number of security alerts per day for each provider.\n\nHow should you complete the query? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "materialize",
        "project",
        "render",
        "bin",
        "series_add",
        "series_fill_linear",
        "take"
      ],
      "answer": [
        "bin",
        "render"
      ],
      "explanation": "To generate a time chart in Microsoft Sentinel using Kusto Query Language (KQL), you need to use the `bin()` function to group results into time intervals (e.g., 1d for daily), and the `render` statement to visualize the data.\n\n`bin()` is used to round the TimeGenerated field into daily buckets.\n`render` is then used to specify the chart type, such as `render timechart`.\n\nReference: https://learn.microsoft.com/en-us/azure/data-explorer/kusto/query/binfunction\nReference: https://learn.microsoft.com/en-us/azure/data-explorer/kusto/query/renderoperator",
      "image": "Images/hotspot58.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft Sentinel workspace named sws1.\n\nYou plan to create an Azure logic app that will raise an incident in an on-premises IT service management system when an incident is generated in sws1.\n\nYou need to configure the Microsoft Sentinel connector credentials for the logic app. The solution must meet the following requirements:\n\n• Minimize administrative effort.\n• Use the principle of least privilege.\n\nHow should you configure the credentials? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "A managed identity",
        "A service principal",
        "An Azure AD user account",
        "Microsoft Sentinel Automation Contributor",
        "Microsoft Sentinel Reader",
        "Microsoft Sentinel Responder"
      ],
      "answer": [
        "A managed identity",
        "Microsoft Sentinel Reader"
      ],
      "explanation": "A managed identity simplifies the credentials management by avoiding explicit secrets or credentials in the logic app configuration, minimizing administrative overhead.\n\nThe Microsoft Sentinel Reader role allows the logic app to access incidents and analytics information but does not grant write or edit permissions, aligning with the principle of least privilege.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/automation/authenticate-playbooks-to-sentinel#authenticate-with-managed-identity\n",
      "image": "Images/hotspot57.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have an Azure subscription.\n\nYou plan to implement a Microsoft Sentinel workspace. You anticipate that you will ingest 20 GB of security log data per day.\n\nYou need to configure storage for the workspace. The solution must meet the following requirements:\n\n• Minimize costs for daily ingested data.\n• Maximize the data retention period without incurring extra costs.\n\nWhat should you do for each requirement? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "Apply a daily cap.",
        "Use a commitment tier.",
        "Use the Pay-As-You-Go (PAYG) model.",
        "Set retention to 31 days.",
        "Set retention to 90 days.",
        "Set retention to 365 days."
      ],
      "answer": [
        "Use the Pay-As-You-Go (PAYG) model.",
        "Set retention to 90 days."
      ],
      "explanation": "Answer 1: PAYG\nUsing the Pay-As-You-Go model costs $5.22/GB. For 20 GB/day, that’s approximately $104.4/day. The cheapest commitment tier (100 GB/day) is $342.52/day, which is more expensive given the 20 GB/day usage.\n\nAnswer 2: 90 days\nMicrosoft Sentinel offers 90 days of data retention at no additional cost. Retention beyond 90 days and up to 2 years incurs additional charges under standard Azure Monitor retention pricing.\n\nReference: https://azure.microsoft.com/en-ca/pricing/details/microsoft-sentinel/",
      "image": "Images/hotspot56.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft Sentinel workspace.\n\nYou need to create a KQL query that will identify successful sign-ins from multiple countries during the last three hours.\n\nHow should you complete the query? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "imAuthentication",
        "imNetworkSession",
        "imProcessCreate",
        "imWebSession",
        "DstGeoCountry",
        "SrcGeoCountry",
        "SrcGeoRegion"
      ],
      "answer": [
        "imAuthentication",
        "SrcGeoCountry"
      ],
      "explanation": "To identify successful sign-ins from multiple countries using Microsoft Sentinel and ASIM parsers, `imAuthentication` is the correct ASIM parser for authentication events. `SrcGeoCountry` identifies the source country for the sign-in attempts. These allow you to analyze geographic patterns in sign-in behavior over a time range.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/normalize-asim-overview",
      "image": "Images/hotspot55.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft Sentinel workspace that has User and Entity Behavior Analytics (UEBA) enabled.\n\nYou need to identify all the log entries that relate to security-sensitive user actions performed on a server named Server1. The solution must meet the following requirements:\n\n• Only include security-sensitive actions by users that are NOT members of the IT department.\n• Minimize the number of false positives.\n\nHow should you complete the query? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "| join kind=fullouter (",
        "| join kind=inner (",
        "| join kind=innerunique (",
        "BehaviorAnalytics",
        "IdentityInfo",
        "SecurityEvent"
      ],
      "answer": [
        "| join kind=inner (",
        "IdentityInfo"
      ],
      "explanation": "The correct approach is to use an `inner` join to focus only on matching user records, reducing false positives. `IdentityInfo` contains enrichment about user identities including their group memberships (e.g., IT department), enabling filtering of non-IT users for more accurate security analysis.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/investigate-with-ueba#embed-identityinfo-data-in-your-analytics-rules-public-preview\n",
      "image": "Images/hotspot54.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft Sentinel workspace.\n\nYou develop a custom Advanced Security Information Model (ASIM) parser named Parser1 that produces a schema named Schema1.\n\nYou need to validate Schema1.\n\nHow should you complete the command? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "evaluate",
        "getschema",
        "invoke",
        "parse"
      ],
      "answer": [
        "getschema",
        "invoke"
      ],
      "explanation": "To validate a custom ASIM parser schema in Microsoft Sentinel, you use the `getschema` function to retrieve the schema definition and the `invoke` function to run the parser logic on sample data.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/watchlists-manage#edit-a-watchlist-item\n",
      "image": "Images/hotspot53.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have the following KQL query.\n\nlet IPList = _GetWatchlist('Bad_IPs');\nEvent\n| where Source == \"Microsoft-Windows-Sysmon\"\n| where EventID == 3\n| extend EvData = parse_xml(EventData)\n| extend EventDetail = EvData.DataItem.EventData.Data\n| extend SourceIP = EventDetail.[9].[\"#text\"], DestinationIP = EventDetail.[14].[\"#text\"]\n| where SourceIP in (IPList) or DestinationIP in (IPList)\n| extend IPMatch = case(SourceIP in (IPList), \"SourceIP\", DestinationIP in (IPList), \"DestinationIP\", \"None\")\n| extend timestamp = TimeGenerated, AccountCustomEntity = UserName, HostCustomEntity = Computer,\n  IPCustomEntity = case(IPMatch == \"SourceIP\", SourceIP, IPMatch == \"DestinationIP\", DestinationIP, \"None\")\n\nFor each of the following statements, select Yes if the statement is true. Otherwise, select No.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "The query uses a watchlist named Bad_IPs to filter IP addresses.",
        "The query filters for events from Windows Firewall.",
        "The query projects only the source IP address."
      ],
      "answer": [
        "Yes",
        "No",
        "No"
      ],
      "explanation": "- **Yes**: The query uses the `_GetWatchlist('Bad_IPs')` function to define a list of known bad IP addresses.\n- **No**: It filters for events where the source is `Microsoft-Windows-Sysmon`, not Windows Firewall.\n- **No**: The query extracts and evaluates both the `SourceIP` and `DestinationIP`, so it does not only project one.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/watchlists",
      "image": "Images/hotspot52.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft 365 E5 subscription that contains two users named User1 and User2.\n\nYou have the hunting query shown in the following exhibit.\n\nAuditLogs\n| where TimeGenerated > ago(7d)\n| where OperationName == \"Add user\"\n| project AddedTime = TimeGenerated, user = tostring(TargetResources[0].userPrincipalName)\n| join (AzureActivity\n| where OperationName == \"Create role assignment\"\n| project OperationName, RoleAssignmentTime = TimeGenerated, user = Caller) on user\n| project-away user1\n\nThe users perform the following actions:\n\n• User1 assigns User2 the Global administrator role.\n• User1 creates a new user named User3 and assigns the user a Microsoft Teams license.\n• User2 creates a new user named User4 and assigns the user the Security reader role.\n• User2 creates a new user named User5 and assigns the user the Security operator role.\n\nFor each of the following statements, select Yes if the statement is true. Otherwise, select No.\nNOTE: Each correct selection is worth one point.",
      "options": [
        "User1 created a user and assigned a role.",
        "User1 created a user and assigned a license.",
        "User2 created a user and assigned a role."
      ],
      "answer": [
        "No",
        "No",
        "Yes"
      ],
      "explanation": "The Kusto Query Language (KQL) used in the hunting query looks for users who both added a new user (from AuditLogs) and assigned them a role (from AzureActivity). This requires the same user to perform both actions.\n\n- User1 created User3 and assigned a license, but not a role — doesn't match the join.\n- User2 created User4 and User5, and also assigned them roles — this satisfies the query.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/hunting",
      "image": "Images/hotspot51.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You are investigating an incident by using Microsoft 365 Defender. You need to create an advanced hunting query to count failed sign-in\nauthentications on three devices named CFOLaptop, CEOLaptop, and COOLaptop. How should you complete the query? To answer, select the appropriate options\nin the answer area. NOTE: Each correct selection is worth one point.",
      "options": [
        "1| project LogonFailures=count()",
        "2| Summarize LogonFailures= count()",
        "3| Where ActionType == FailureReason",
        "4| Where DeviceName in (\"CFOLaptop\", \"CEOLaptop\", \"COOLaptop\") And",
        "5| ActionType == FailureReason",
        "6| DeviceEvents",
        "7| DeviceLogonEvents"
      ],
      "answer": [
        "7",
        "4",
        "5",
        "2"
      ],
      "explanation": "Correct query filters logons and counts failures.",
      "image": "images/cfo1.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You open the Cloud App Security portal as shown in the exhibit.\nYour environment does NOT have Microsoft Defender for Endpoint enabled.\nYou need to remediate the risk for the Launchpad app.\nWhich four actions should you perform in sequence?",
      "options": [
        "1| Tag app as Unsactioned",
        "2| Run the script on the source appliance",
        "3| Run the script in the Azure Cloud Shell",
        "4| Select the App",
        "5| Tag the app as Sanctioned",
        "6| Generate a block script"
      ],
      "answer": [
        "4",
        "1",
        "6",
        "2"
      ],
      "explanation": "Select the app.\nYou need to identify and select the Launchpad app within your management interface to apply further actions.\n\nTag the app as Unsanctioned.\nMarking the app as 'Unsanctioned' identifies it as not allowed within the organization's environment, signaling that it should be blocked or restricted.\n\nGenerate a block script.\nAfter tagging the app as unsanctioned, you generate a block script that can be used to enforce the blocking of the app across your network.\n\nRun the script on the source appliance.\nFinally, you deploy the block script to the relevant network appliance or gateway device to actively block the app's traffic and mitigate the associated risks.\n\nFor more details, refer to: https://docs.microsoft.com/en-us/cloud-app-security/governance-discovery",
      "image": "Images/applogimage.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You are informed of an increase in malicious email being received by users.\nYou need to create an advanced hunting query in Microsoft 365 Defender to identify whether the accounts of the email recipients were compromised.\nThe query must return the most recent 20 sign-ins performed by the recipients within an hour of receiving the known malicious email.\nHow should you complete the query? To answer, select the appropriate options in the answer area.\nNOTE: Each correct selection is worth one point.",
      "options": [
        "1| maliciousemails = emailattachmentinfo",
        "2| maliciousemails = EmailEvents",
        "3| maliciousemails = IdentityLogonEvents",
        "4| join(emailattachmentinfo",
        "5| join(EmailEvents",
        "6| join(IdentityLogonEvents",
        "7| Select 20",
        "8| Take 20",
        "9| Top 20"
      ],
      "answer": [
        "2| maliciousemails = EmailEvents",
        "6| join(IdentityLogonEvents",
        "8| Take 20"
      ],
      "explanation": "    To determine if user accounts were compromised after receiving a malicious email, you start by using EmailEvents to identify affected recipients.\n\n            You then join the data with IdentityLogonEvents to correlate sign-in activity and finally use 'take 20' to return the most recent 20 logon events per user.\n\n            This pattern allows security analysts to investigate whether those recipients were targeted and potentially compromised within the time window.\n\n            For reference, see:\n            https://docs.microsoft.com/en-us/microsoft-365/security/defender/advanced-hunting-query-emails-devices?view=o365-worldwide",
      "image": "Images/kqldrop2.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft 365 E5 subscription.\nYou plan to perform cross-domain investigations by using Microsoft 365 Defender.\nYou need to create an advanced hunting query to identify devices affected by a malicious email attachment.\nNOTE: Each correct selection is worth one point.How should you complete the query?\nQuery: EmailAttachmentInfo\n  |Where SenderFromAddress =~ \"MalicousSender@example.com\" \n  |Where isnotempty (sha256) \n",
      "options": [
        "1| extend",
        "2| join",
        "3| project",
        "4| union",
        "5| extend",
        "6| join",
        "7| project",
        "8| union",
        "9| extend",
        "10| join",
        "11| project",
        "12| union"
      ],
      "answer": [
        "2",
        "7",
        "11"
      ],
      "explanation": "To identify devices affected by a malicious email attachment, you can use the following advanced hunting query:\n\n                EmailAttachmentInfo\n                | where SenderFromAddress =~ \"MaliciousSender@example.com\"\n                | where isnotempty(SHA256)\n                | join (\n                //Check devices for any activity involving the attachments\n                 DeviceFileEvents\n                | project FileName, SHA256\n                ) on SHA256\n                | project Timestamp, FileName , SHA256, DeviceName, DeviceId, NetworkMessageId, SenderFromAddress, RecipientEmailAddress\n\n            This query first filters emails with attachments from a specific sender and ensures the SHA-256 hash is not empty.\n            It then joins the email data with device file events to identify any activity involving the attachments.\n            Finally, it projects relevant fields for further analysis.\n\n            For more details, refer to: https://docs.microsoft.com/en-us/microsoft-365/security/mtp/advanced-hunting-query-emails-devices?view=o365-worldwide",
      "image": "Images/kqldrop1.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft 365 E5 subscription that uses Microsoft Defender and an Azure subscription that uses Azure Sentinel.\nYou need to identify all the devices that contain files in emails sent by a known malicious email sender. The query will be based on the match of the SHA256 hash.\nHow should you complete the query? To answer, select the appropriate options in the answer area.\nNOTE: Each correct selection is worth one point.",
      "options": [
        "1| DeviceId",
        "2| RecipientEmailAddress",
        "3| SenderFromAddress",
        "4| SHA256",
        "5| DeviceId",
        "6| RecipientEmailAddress",
        "7| SenderFromAddress",
        "8| SHA256"
      ],
      "answer": [
        "4| SHA256",
        "8| SHA256"
      ],
      "explanation": "The where clause filters the EmailAttachmentInfo table to only include attachments sent by the specified sender and that have a non-empty SHA256 hash value. This effectively filters the results to only include attachments from the specified sender and that have a known hash value.\n                The join operator combines the results of the previous step with the results of a second query that selects the DeviceFileEvent table and projects the FileName, SHA256, DeviceName, and DeviceId fields. This effectively creates a join between the two tables based on the SHA256 field, linking the attachments with file events on devices.\n                The project operator selects the desired fields from the joined results and includes them in the final output.\n                This query will work in both Microsoft Defender and Azure Sentinel, as it is a valid advanced hunting query in both platforms.",
      "image": "Images/kqldrop3.jpg"
    },
    {
      "type": "drag_and_drop",
      "question": "You purchase a Microsoft 365 subscription.\nYou plan to configure Microsoft Cloud App Security.\nYou need to create a custom template-based policy that detects connections to Microsoft 365 apps that originate from a botnet network.\nWhat should you use? To answer, select the appropriate options in the answer area.\nNOTE: Each correct selection is worth one point.",
      "options": [
        "1| access policy",
        "2| activity policy",
        "3| Anomaly detection policy",
        "4| IP address tag",
        "5| Source",
        "6| User agent string"
      ],
      "answer": [
        "3| Anomaly detection policy",
        "4| IP address tag"
      ],
      "explanation": "Reference:\n            https://docs.microsoft.com/en-us/cloud-app-security/anomaly-detection-policy\n\n            → **Anomaly detection policy**: Specifically designed to identify suspicious behavior, such as access from known botnet IPs, based on Microsoft's Threat Intelligence.\n\n            → **IP address tag**: Supports identifying risky or botnet IPs, allowing detection logic to trigger alerts when connections originate from such sources.\n\n            The built-in 'Activity from suspicious IP addresses' anomaly detection template uses these mechanisms to detect botnet activity and reduce false positives using machine learning.",
      "image": "Images/kqldrop4.jpg"
    },
    {
      "type": "drag_and_drop",
      "question": "You have an Azure subscription linked to an Azure Active Directory (Azure AD) tenant. The tenant contains two users named User1 and User2.\n        You plan to deploy Azure Defender.\n\n        You need to enable User1 and User2 to perform tasks at the subscription level as shown in the following table:\n\n        - **User1 Tasks**: Assign initiatives, edit security policies, enable automatic provisioning\n        - **User2 Tasks**: View alerts and recommendations, apply security recommendations, dismiss alerts\n\n        The solution must use the principle of least privilege.\n\n        Which role should you assign to each user? To answer, drag the appropriate roles to the correct users. Each role may be used once, more than once, or not at all.\n        You may need to drag the split bar between panes or scroll to view content.",
      "options": [
        "1| Contributor",
        "2| Owner",
        "3| Security Administrator",
        "4| Security Reader"
      ],
      "answer": [
        "2| Owner",
        "1| Contributor"
      ],
      "explanation": "User1 must be assigned the **Owner** role to enable automatic provisioning, which requires owner-level permissions at the subscription level.\n\n        User2 can be assigned the **Contributor** role, which allows actions such as dismissing alerts and applying recommendations.\n\n        → 'Security Reader' and 'Security Administrator' roles are valid only at the resource or management group level for Azure Security Center/Defender for Cloud, but are not sufficient at the subscription level.\n\n        References:\n        - https://docs.microsoft.com/en-us/azure/defender-for-cloud/permissions\n        - https://docs.microsoft.com/en-us/azure/defender-for-cloud/enable-auto-provisioning",
      "image": "Images/userdrop1.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft 365 E5 subscription that contains 200 Windows 10 devices enrolled in Microsoft Defender for Endpoint.\n\n            You need to ensure that users can access the devices by using a remote shell connection directly from the Microsoft 365 Defender portal. The solution must use the principle of least privilege.\n\n            What should you do in the Microsoft 365 Defender portal? To answer, select the appropriate options in the answer area.\n\n            NOTE: Each correct selection is worth one point.",
      "options": [
        "1| Turn on endpoint detection and response (EDR) in block mode",
        "2| Turn on live response",
        "3| Turn off tamper protection",
        "4| Add network assessment job",
        "5| Create a device group that contains the devices and set automation level to full",
        "6| Create a device group that contains the devices and set the automation level to no automated response"
      ],
      "answer": [
        "2| Turn on live response",
        "4| Add network assessment job"
      ],
      "explanation": "Box 1: **Turn on Live Response** – This feature allows you to remotely connect to a device’s shell directly from the Defender portal. It’s essential for performing investigations and immediate response actions.\n\n            Box 2: **Add network assessment job** – Although this seems unrelated at first, network assessment helps populate the inventory and access capabilities within the portal. It’s part of ensuring managed visibility and control.\n\n            References:\n            - https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/respond-machine-alerts?view=o365-worldwide\n            - https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/network-devices?view=o365-worldwide",
      "image": "Images/hotspot2.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft 365 subscription that uses Microsoft 365 Defender and contains a user named User1.\n             You are notified that the account of User1 is compromised.\n\n             You need to review the alerts triggered on the devices to which User1 signed in.\n\n             How should you complete the query? To answer, select the appropriate options in the answer area.\n\n             NOTE: Each correct selection is worth one point.",
      "options": [
        "1| extend",
        "2| join",
        "3| project",
        "4| project",
        "5| summarize",
        "6| take"
      ],
      "answer": [
        "2| join",
        "4| project"
      ],
      "explanation": "To correlate sign-in data for User1 with alert activity:\n                - **Box 1: join** – This is used to correlate two datasets, such as sign-in activity with alert events by joining on a shared field like DeviceId or Timestamp.\n                - **Box 2: project** – This is used to select the relevant columns (e.g., AlertName, DeviceName, Timestamp) for review after the join operation.\n                This query pattern enables you to identify which alerts are linked to the devices that User1 accessed, helping trace the scope of compromise.",
      "image": "Images/hotspot3.jpg"
    },
    {
      "type": "drag_and_drop",
      "question": "You have an Azure subscription that contains the users shown in the following table.\nUser1 | Security Administrator\nUser2 | Security Reader\nUser3 | Contributor\nYou need to delegate the following tasks:\n\n Enable Microsoft Defender for Servers on virtual machines.\n Review security recommendations and enable server vulnerability scans.\nThe solution must use the principle of least privilege.\nWhich user should perform each task? To answer, drag the appropriate users to the correct tasks.\nEach user may be used once, more than once, or not at all. You may need to drag the split bar between panes or scroll to view content.\nNOTE: Each correct selection is worth one point.",
      "options": [
        "1| User1",
        "2| User2",
        "3| User3"
      ],
      "answer": [
        "1| User1",
        "2| User2"
      ],
      "explanation": "• **Enable Microsoft Defender for Servers** requires sufficient permissions to configure Defender plans, which the **Security Administrator** (User1) has.\n\n• **Review security recommendations and enable vulnerability scans** can be accomplished by a **Security Reader** (User2), who has read access to security recommendations and visibility into vulnerability data.\n\nThis setup follows the principle of least privilege: only assigning the minimum roles necessary for the required tasks.",
      "image": "Images/hotspot4.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft 365 E5 subscription.\n\nYou need to create a hunting query that will return every email that contains an attachment named Document.pdf. The query must meet the following requirements:\n\n• Only show emails sent during the last hour.\n• Optimize query performance.\n\nHow should you complete the query? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "1| |join DeviceFileEvents on SHA256",
        "2| | join kind=inner(DeviceFileEvents | where Timestamp >ago(1h)) on SHA256",
        "3| | where Timestamp > ago(1h)",
        "4| | where Timestamp < ago(1h)"
      ],
      "answer": [
        "3| | where Timestamp > ago(1h)",
        "2| | join kind=inner(DeviceFileEvents | where Timestamp >ago(1h)) on SHA256"
      ],
      "explanation": "The first clause filters email data to include only those within the last hour, optimizing dataset size. The inner join ensures only matching entries from both tables are processed, reducing unnecessary computation. This structure is both accurate and efficient.",
      "image": "Images/hotspot5.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft 365 E5 subscription that uses Microsoft Defender 365.\n\nYour network contains an on-premises Active Directory Domain Services (AD DS) domain that syncs with Azure AD.\n\nYou need to identify the 100 most recent sign-in attempts recorded on devices and AD DS domain controllers.\n\nHow should you complete the KQL query? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "1| IdentityInfo",
        "2| IdentityLogonEvents",
        "3| IdentityQueryEvents",
        "4| join kind=full outer",
        "5| join kind=inner",
        "6| union"
      ],
      "answer": [
        "2| IdentityLogonEvents",
        "6| union"
      ],
      "explanation": "To gather sign-in events across both on-premises AD DS and cloud-managed devices, you should start with **IdentityLogonEvents**, which captures sign-in activity for both environments.\n\nThen, use **union** to merge sign-in data from multiple sources if needed, such as different log tables or environments. This combination provides a unified view of recent sign-in attempts.\n\nReference: https://learn.microsoft.com/en-us/microsoft-365/security/defender/advanced-hunting-identitylogonevents-table?view=o365-worldwide",
      "image": "Images/draganddrop6.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft 365 E5 subscription that uses Microsoft Defender 365.\n\nYour network contains an on-premises Active Directory Domain Services (AD DS) domain that syncs with Azure AD.\n\nYou need to identify LDAP requests by AD DS users to enumerate AD DS objects.\n\nHow should you complete the KQL query? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "1| IdentityDirectoryEvents",
        "2| IdentityInfo",
        "3| IdentityQueryEvents",
        "4| contains",
        "5| has",
        "6| isnotempty"
      ],
      "answer": [
        "3| IdentityQueryEvents",
        "6| isnotempty"
      ],
      "explanation": "To identify LDAP enumeration requests from AD DS users, use the `IdentityQueryEvents` table, which includes queries against directory services. Filtering for rows where fields such as TargetDeviceName or Query are `isnotempty` allows you to isolate valid LDAP queries indicating enumeration activity.\n\nReference: https://learn.microsoft.com/en-us/microsoft-365/security/defender/advanced-hunting-identity-query-events?view=o365-worldwide",
      "image": "Images/hotspot7.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a custom detection rule that includes the following KQL query.\n\nAlertInfo\nwhere Severity == \"High\"\n| distinct AlertId\n| join AlertEvidence on AlertId\n| where EntityType in (\"User\", \"Mailbox\")\n| where EvidenceRole == \"Impacted\"\n| summarize by Timestamp, AlertId, AccountName, AccountObjectId, EntityType, DeviceId, SHA256\n| join EmailEvents on $left.AccountObjectId == $right.RecipientObjectId\n| where DeliveryAction == \"Delivered\"\n| summarize by Timestamp, AlertId, ReportId, RecipientObjectId, RecipientEmailAddress, EntityType, DeviceId, SHA256\n\nFor each of the following statements, select Yes if True. Otherwise, select No.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "Yes",
        "No"
      ],
      "answer": [
        "Yes",
        "No",
        "No"
      ],
      "explanation": "The query begins by filtering high severity alerts, then joins with alert evidence to identify impacted users and mailboxes. It continues by summarizing details and joins with EmailEvents to identify emails delivered to those users.\n\n→ The first statement is 'Yes' because the query does identify high severity alerts linked to impacted user accounts.\n→ The second is 'No' because it only includes impacted entities, not other roles such as 'associated'.\n→ The third is 'No' as the query is scoped to only 'Delivered' actions, ignoring quarantined or blocked ones.",
      "image": "Images/hotspot6.png"
    },
    {
      "type": "drag_and_drop",
      "question": "Your network contains an on-premises Active Directory Domain Services (AD DS) domain that syncs with Azure AD.\n\nYou have a Microsoft 365 E5 subscription that uses Microsoft Defender 365.\n\nYou need to identify all the interactive authentication attempts by the users in the finance department of your company.\n\nHow should you complete the KQL query? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "BehaviourAnalytics",
        "IdentityInfo",
        "IdentityQueryEvent",
        "auditlogs",
        "IdentityLogonEvents",
        "Sgning logs"
      ],
      "answer": [
        "IdentityInfo",
        "IdentityLogonEvents"
      ],
      "explanation": "The query requires two sources:\n\n1. **IdentityInfo** – This table contains user-related metadata such as department, job title, and account status. It is necessary for filtering users specifically in the finance department.\n\n2. **IdentityLogonEvents** – This table contains all identity-based sign-in data and is required to filter for interactive authentication attempts.\n\nCombining these two datasets allows analysts to filter authentication logs down to users in a specific organizational unit or department, such as finance.\n\nReference: https://learn.microsoft.com/en-us/microsoft-365/security/defender/advanced-hunting-identitylogonevents-table?view=o365-worldwide",
      "image": "Images/hotspon8.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You are informed of an increase in malicious email being received by users.\nYou need to create an advanced hunting query in Microsoft 365 Defender to identify whether the accounts of the email recipients were compromised.\nThe query must return the most recent 20 sign-ins performed by the recipients within an hour of receiving the known malicious email.\nHow should you complete the query? To answer, select the appropriate options in the answer area.\nNOTE: Each correct selection is worth one point.",
      "options": [
        "1| maliciousemails = emailattachmentinfo",
        "2| maliciousemails = EmailEvents",
        "3| maliciousemails = IdentityLogonEvents",
        "4| join(emailattachmentinfo",
        "5| join(EmailEvents",
        "6| join(IdentityLogonEvents",
        "7| Select 20",
        "8| Take 20",
        "9| Top 20"
      ],
      "answer": [
        "2| maliciousemails = EmailEvents",
        "6| join(IdentityLogonEvents",
        "8| Take 20"
      ],
      "explanation": "To determine if user accounts were compromised after receiving a malicious email, you start by using EmailEvents to identify affected recipients.\n            You then join the data with IdentityLogonEvents to correlate sign-in activity and finally use 'take 20' to return the most recent 20 logon events per user.\n            This pattern allows security analysts to investigate whether those recipients were targeted and potentially compromised within the time window.\n\n            For reference, see:\n            https://docs.microsoft.com/en-us/microsoft-365/security/defender/advanced-hunting-query-emails-devices?view=o365-worldwide",
      "image": "Images/kqldrop2.png"
    },
    {
      "type": "drag_and_drop",
      "question": "Case study\n-\n\n    \nThis is a case study. Case studies are not timed separately. You can use as much exam time as you would like to complete each case. However, there may be additional case studies and sections on this exam. You must manage your time to ensure that you are able to complete all questions included on this exam in the time provided.\n\n    \nTo answer the questions included in a case study, you will need to reference information that is provided in the case study. Case studies might contain exhibits and other resources that provide more information about the scenario that is described in the case study. Each question is independent of the other questions in this case study.\n\n    \nAt the end of this case study, a review screen will appear. This screen allows you to review your answers and to make changes before you move to the next section of the exam. After you begin a new section, you cannot return to this section.\n    n\nTo start the case study\n-\n    \nTo display the first question in this case study, click the Next button. Use the buttons in the left pane to explore the content of the case study before you answer the questions. Clicking these buttons displays information such as business requirements, existing environment, and problem statements. If the case study has an All Information tab, note that the information displayed is identical to the information displayed on the subsequent tabs. When you are ready to answer a question, click the Question button to return to the question.\n\n\n    \nOverview\n\n    -\n\nLitware Inc. is a renewable energy company.\n\n    \nLitware has offices in Boston and Seattle. Litware also has remote users located across the United States. To access Litware resources, including cloud resources, the remote users establish a VPN connection to either office.\n\n\n    \nExisting Environment\n-\n\n\n    \nIdentity Environment\n-\n\n    \nThe network contains an Active Directory forest named litware.com that syncs to an Azure Active Directory (Azure AD) tenant named litware.com.\n\n    \n\nMicrosoft 365 Environment\n-\n\n    \nLitware has a Microsoft 365 E5 subscription linked to the litware.com Azure AD tenant. Microsoft Defender for Endpoint is deployed to all computers that run Windows 10. All Microsoft Defender for Cloud Apps built-in anomaly detection policies are enabled.\n\n    \n\nAzure Environment\n\n    -\n\nLitware has an Azure subscription linked to the litware.com Azure AD tenant. The subscription contains resources in the East US Azure region as shown in the following table.\n\n\nNetwork Environment\n\n    -\n\nEach Litware office connects directly to the internet and has a site-to-site VPN connection to the virtual networks in the Azure subscription.\n\n    \n\nOn-premises Environment\n\n    -\n\nThe on-premises network contains the computers shown in the following table.\n\n    \n\nCurrent Problems\n\n    -\n\nMicrosoft Defender for Cloud Apps frequently generates false positive alerts when users connect to both offices simultaneously.\n\n    \nPlanned Changes and Requirements\n\n    \n\nPlanned Changes\n\n    -\n\nLitware plans to implement the following changes:\n\n    \n• Create and configure Microsoft Sentinel in the Azure subscription.\n    \n• Validate Microsoft Sentinel functionality by using Azure AD test user accounts.\n\n    \n\nBusiness Requirements\n\n    -\n\nLitware identifies the following business requirements:\n\n    \n• The principle of least privilege must be used whenever possible.\n    \n• Costs must be minimized, as long as all other requirements are met.\n    \n• Logs collected by Log Analytics must provide a full audit trail of user activities.\n    \n• All domain controllers must be protected by using Microsoft Defender for Identity.\n\n    \n\nAzure Information Protection Requirements\n\n    \nAll files that have sensitivity labels and are stored on the Windows 10 computers must be available from the Azure Information Protection – Data discovery dashboard.\n\n\nMicrosoft Defender for Endpoint Requirements\n\n    \nAll Microsoft Defender for Cloud Apps unsanctioned apps must be blocked on the Windows 10 computers by using Microsoft Defender for Endpoint.\n\n    \n\nMicrosoft Defender for Cloud Apps Security Requirements\n\n    \nMicrosoft Defender for Cloud Apps must identify whether a user connection is anomalous based on tenant-level data.\n\n    \n\nMicrosoft Defender for Cloud Requirements\n\n    \nAll servers must send logs to the same Log Analytics workspace.\n\n    \n\nMicrosoft Sentinel Requirements\n\n    \nLitware must meet the following Microsoft Sentinel requirements:\n\n    \n• Integrate Microsoft Sentinel and Microsoft Defender for Cloud Apps.\n    \n• Ensure that a user named admin1 can configure Microsoft Sentinel playbooks.\n    \n• Create a Microsoft Sentinel analytics rule based on a custom query. The rule must automatically initiate the execution of a playbook.\n• Add notes to events that represent data access from a specific IP address to provide the ability to reference the IP address when navigating through an investigation graph while hunting.\n    \n• Create a test rule that generates alerts when inbound access to Microsoft Office 365 by the Azure AD test user accounts is detected. Alerts generated by the rule must be grouped into individual incidents, with one incident per test user account.\n\n\nYou need to configure DC1 to meet the business requirements.\n    \n\nWhich three actions should you perform in sequence? To answer, move the appropriate actions from the list of actions to the answer area and arrange them in the correct order.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "Provide Domain Administrator Credentials to litware.com directory domain",
        "Create an instance of Microsoft Defender for Identity",
        "Provide Global Administrator credentials to the liteware.com azure AD tenant",
        "Install the sensor on dc1",
        "Install the standalone sensor on DC1"
      ],
      "answer": [
        "Provide Global Administrator credentials to the liteware.com azure AD tenant",
        "Create an instance of Microsoft Defender for Identity",
        "Install the sensor on dc1"
      ],
      "explanation": "To onboard a domain controller into Microsoft Defender for Identity:\n\n1. **Global Administrator credentials** are required to authorize the Defender for Identity instance in Azure AD.\n2. You must then **create an instance of Microsoft Defender for Identity** to start the setup process.\n3. After that, **install the sensor on the domain controller (DC1)** to begin monitoring and threat detection.\n\nA standalone sensor is used in environments where port mirroring is configured or where sensor installation directly on the domain controller is not allowed.\n\nReference: https://learn.microsoft.com/en-us/defender-for-identity/install-step1",
      "image": "Images/hotspot10.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft 365 E5 subscription that uses Microsoft Defender for Endpoint.\n\nYou need to create a detection rule that meets the following requirements:\n\n• Is triggered when a device that has critical software vulnerabilities was active during the last hour\n• Limits the number of duplicate results\n\nHow should you complete the KQL query? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "| Distinct CveID",
        "| Distinct DeviceID",
        "| project-away CveID",
        "| project-keep DeviceID",
        "| Distinct DeviceId, ReportID",
        "| Project-TimeStamp ,DeviceID, ReportID",
        "| Summarize count() by DeviceID, ReportId"
      ],
      "answer": [
        "| Distinct DeviceID",
        "| Project-TimeStamp ,DeviceID, ReportID"
      ],
      "explanation": "The correct approach to avoid duplicate results while identifying recently active devices with critical vulnerabilities is:\n\n→ | Distinct DeviceID helps ensure that each device is only counted once.\n\n→ | Project-TimeStamp ,DeviceID, ReportID returns a concise output containing only the relevant identifiers and the timestamp of the event, reducing noise and focusing the detection rule.\n\nThis format ensures the query is efficient and meets the requirements for both time filtering and result deduplication.\n\nReference:\nhttps://learn.microsoft.com/en-us/microsoft-365/security/defender/advanced-hunting-schema-devicevulnerabilities-table?view=o365-worldwide",
      "image": "Images/hotspot11.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft 365 E5 subscription that uses Microsoft Teams.\n\nYou need to perform a content search of Teams chats for a user by using the Microsoft Purview compliance portal. The solution must minimize the scope of the search.\n\nHow should you configure the content search? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "Exchange mailboxes",
        "Exchange public folders",
        "Sharepoint sites",
        "category",
        "itemclass",
        "kind"
      ],
      "answer": [
        "Exchange mailboxes",
        "kind"
      ],
      "explanation": "To perform a focused Teams chat search using Microsoft Purview:\n\n→ **Exchange mailboxes** must be selected because Teams chat messages are stored in the hidden mailbox folders of users.\n\n→ **kind** is the correct KQL filter property to identify specific message types such as 'im' (instant message), which corresponds to Teams chat data.\n\n→ Options like 'SharePoint sites' or 'public folders' are unrelated to Teams messages.\n\nReference:\nhttps://learn.microsoft.com/en-us/microsoft-365/compliance/content-search?view=o365-worldwide",
      "image": "Images/hotspot12.png"
    }
  ],
  "Topic 2": [
    {
      "type": "multiple_choice",
      "question": "You use Azure Security Center.\n\nYou receive a security alert in Security Center.\n\nYou need to view recommendations to resolve the alert in Security Center.\n\nSolution: From Security alerts, you select the alert, select Take Action, and then expand the Prevent future attacks section.\n\nDoes this meet the goal?",
      "options": [
        "A. Yes",
        "B. No"
      ],
      "answer": [
        "B"
      ],
      "explanation": "This solution shows preventative steps for future alerts but does not display the current recommendations directly related to the active alert. To view the alert-specific recommendations, you should go to the **Recommendations** blade in Microsoft Defender for Cloud (formerly Azure Security Center). \n\nReference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/security-alerts"
    },
    {
      "type": "multiple_choice",
      "question": "You receive an alert from Azure Defender for Key Vault.\n\nYou discover that the alert is generated from multiple suspicious IP addresses.\n\nYou need to reduce the potential of Key Vault secrets being leaked while you investigate the issue. The solution must be implemented as soon as possible and must minimize the impact on legitimate users.\n\nWhat should you do first?",
      "options": [
        "A. Modify the access control settings for the key vault.",
        "B. Enable the Key Vault firewall.",
        "C. Create an application security group.",
        "D. Modify the access policy for the key vault."
      ],
      "answer": [
        "B"
      ],
      "explanation": "Enabling the Key Vault firewall allows you to restrict access to trusted IP ranges and block suspicious or unknown IP addresses immediately. This helps reduce the risk of exposure with minimal impact to trusted users who connect from approved networks.\n\nReference: https://learn.microsoft.com/en-us/azure/key-vault/general/network-security"
    },
    {
      "type": "multiple_choice",
      "question": "You have a Microsoft 365 subscription that uses Azure Defender.\n\nYou have 100 virtual machines in a resource group named RG1.\n\nYou assign the Security Admin role to a new user named SecAdmin1.\n\nYou need to ensure that SecAdmin1 can apply quick fixes to the virtual machines by using Azure Defender. The solution must use the principle of least privilege.\n\nWhich role should you assign to SecAdmin1?",
      "options": [
        "A. the Security Reader role for the subscription",
        "B. the Contributor for the subscription",
        "C. the Contributor role for RG1",
        "D. the Owner role for RG1"
      ],
      "answer": [
        "C"
      ],
      "explanation": "To apply quick fixes using Defender for Cloud, the user needs **Contributor** permissions on the resource group that contains the virtual machines. This adheres to the principle of least privilege by limiting scope to RG1 instead of the full subscription.\n\nReference: https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles# contributor"
    },
    {
      "type": "multiple_choice",
      "question": "You provision a Linux virtual machine in a new Azure subscription.\n\n        You enable Azure Defender and onboard the virtual machine to Azure Defender.\n\n        You need to verify that an attack on the virtual machine triggers an alert in Azure Defender.\n\n        Which two Bash commands should you run on the virtual machine? Each correct answer presents part of the solution.\n\n        NOTE: Each correct selection is worth one point.",
      "options": [
        "A. cp /bin/echo ./asc_alerttest_662jfi039n",
        "B. ./alerttest testing eicar pipe",
        "C. cp /bin/echo ./alerttest",
        "D. ./asc_alerttest_662jfi039n testing eicar pipe"
      ],
      "answer": [
        "A",
        "D"
      ],
      "explanation": "To simulate an alert in Microsoft Defender for Cloud (formerly Azure Defender), you can copy a known command and execute it in a specific pattern.\n\n        → A. Copies the /bin/echo binary to a specific filename `asc_alerttest_*`, which simulates a suspicious binary presence.\n\n        → D. Executes the file with a testing string to generate a high-confidence test alert.\n\n        Reference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/quickstart-onboard-linux-agent# generate-simulated-alerts"
    },
    {
      "type": "multiple_choice",
      "question": "You create an Azure subscription named sub1.\n\nIn sub1, you create a Log Analytics workspace named workspace1.\n\nYou enable Azure Security Center and configure Security Center to use workspace1.\n\nYou need to collect security event logs from the Azure virtual machines that report to workspace1.\n\nWhat should you do?",
      "options": [
        "A. From Security Center, enable data collection",
        "B. In sub1, register a provider.",
        "C. From Security Center, create a Workflow automation.",
        "D. In workspace1, create a workbook."
      ],
      "answer": [
        "A"
      ],
      "explanation": "Data collection must be enabled in Security Center to collect security logs from VMs into Log Analytics.\n\nReference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/enable-data-collection"
    },
    {
      "type": "multiple_choice",
      "question": "Your company uses Azure Security Center and Azure Defender.\n\n    The security operations team at the company informs you that it does NOT receive email notifications for security alerts.\n\n    What should you configure in Security Center to enable the email notifications?",
      "options": [
        "A. Security solutions",
        "B. Security policy",
        "C. Pricing & settings",
        "D. Security alerts",
        "E. Azure Defender"
      ],
      "answer": [
        "C"
      ],
      "explanation": "To configure email notifications, go to 'Pricing & settings' in Microsoft Defender for Cloud.\n\n    Reference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/email-notifications-security-alerts"
    },
    {
      "type": "multiple_choice",
      "question": "You use Azure Security Center.\n\n    You receive a security alert in Security Center.\n\n    You need to view recommendations to resolve the alert in Security Center.\n\n    Solution: From Regulatory compliance, you download the report.\n\n    Does this meet the goal?",
      "options": [
        "A. Yes",
        "B. No"
      ],
      "answer": [
        "B"
      ],
      "explanation": "Regulatory compliance reports are not used to resolve alerts. Use the Security alerts blade instead.\n\n    Reference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/recommendations"
    },
    {
      "type": "multiple_choice",
      "question": "You use Azure Security Center.\n\n    You receive a security alert in Security Center.\n\n    You need to view recommendations to resolve the alert in Security Center.\n\n    Solution: From Security alerts, you select the alert, select Take Action, and then expand the Mitigate the threat section.\n\n    Does this meet the goal?",
      "options": [
        "A. Yes",
        "B. No"
      ],
      "answer": [
        "A"
      ],
      "explanation": "This is the correct procedure to view mitigation steps directly tied to a security alert.\n\n    Reference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/alerts-overview"
    },
    {
      "type": "multiple_choice",
      "question": "You have an Azure subscription that has Azure Defender enabled for all supported resource types.\n\n    You need to configure the continuous export of high-severity alerts to enable their retrieval from a third-party SIEM solution.\n\n    To which service should you export the alerts?",
      "options": [
        "A. Azure Cosmos DB",
        "B. Azure Event Grid",
        "C. Azure Event Hubs",
        "D. Azure Data Lake"
      ],
      "answer": [
        "C"
      ],
      "explanation": "Azure Event Hubs allows integration with third-party SIEM solutions by streaming alerts and telemetry.\n\n    Reference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/continuous-export"
    },
    {
      "type": "multiple_choice",
      "question": "You are responsible for responding to Azure Defender for Key Vault alerts.\n\n    During an investigation of an alert, you discover unauthorized attempts to access a key vault from a Tor exit node.\n\n    What should you configure to mitigate the threat?",
      "options": [
        "A. Key Vault firewalls and virtual networks",
        "B. Azure Active Directory (Azure AD) permissions",
        "C. Role-based access control (RBAC) for the key vault",
        "D. The access policy settings of the key vault"
      ],
      "answer": [
        "A"
      ],
      "explanation": "To restrict access to trusted networks and prevent Tor-based access, configure Key Vault firewalls and virtual network rules.\n\n    Reference: https://learn.microsoft.com/en-us/azure/key-vault/general/network-security"
    },
    {
      "type": "multiple_choice",
      "question": "You have an Azure subscription that contains a Log Analytics workspace.\n\n        You need to enable just-in-time (JIT) VM access and network detections for Azure resources.\n\n        Where should you enable Azure Defender?",
      "options": [
        "A. at the subscription level",
        "B. at the workspace level",
        "C. at the resource level"
      ],
      "answer": [
        "A"
      ],
      "explanation": "To enable just-in-time (JIT) VM access and network threat detections, Azure Defender must be enabled at the **subscription level**.\n\n        This activates protections across a wide range of supported resource types such as VMs, Storage, SQL, etc., and enables features like JIT access and threat detection across the subscription.\n\n\n        → Workspace-level configuration is used primarily for log data collection.\n\n        → Resource-level enabling does not activate global threat protection features.\n\n\n        Reference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/defender-for-cloud-introduction"
    },
    {
      "type": "multiple_choice",
      "question": "You use Azure Defender.\n\n        You have an Azure Storage account that contains sensitive information.\n\n        You need to run a PowerShell script if someone accesses the storage account from a suspicious IP address.\n\n        Which two actions should you perform? Each correct answer presents part of the solution.\n\n        NOTE: Each correct selection is worth one point.",
      "options": [
        "A. From Azure Security Center, enable workflow automation.",
        "B. Create an Azure logic app that has a manual trigger.",
        "C. Create an Azure logic app that has an Azure Security Center alert trigger.",
        "D. Create an Azure logic app that has an HTTP trigger.",
        "E. From Azure Active Directory (Azure AD), add an app registration."
      ],
      "answer": [
        "A",
        "C"
      ],
      "explanation": "To automate responses such as running PowerShell scripts when suspicious activity is detected, you must:\n\n        → **A. Enable workflow automation** in Microsoft Defender for Cloud (formerly Azure Security Center). This lets you respond to alerts with Logic Apps.\n\n        → **C. Use a Logic App with a Security Center alert trigger**, which launches the remediation logic when a matching alert (e.g., access from suspicious IP) is raised.\n\n\n        Other options like HTTP/manual triggers or app registration are not necessary for this use case.\n\n\n        Reference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/workflow-automation"
    },
    {
      "type": "multiple_choice",
      "question": "You use Azure Security Center.\n\n        You receive a security alert in Security Center.\n\n        You need to view recommendations to resolve the alert in Security Center.\n\n        What should you do?",
      "options": [
        "A. From Security alerts, select the alert, select Take Action, and then expand the Prevent future attacks section.",
        "B. From Security alerts, select Take Action, and then expand the Mitigate the threat section.",
        "C. From Regulatory compliance, download the report.",
        "D. From Recommendations, download the CSV report."
      ],
      "answer": [
        "B"
      ],
      "explanation": "The Mitigate the threat section of the Take Action menu within a security alert provides tailored recommendations to resolve the specific threat. This is the correct place to investigate how to remediate issues raised by Defender for Cloud alerts.\n\n        Reference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/alerts"
    },
    {
      "type": "multiple_choice",
      "question": "You have a suppression rule in Azure Security Center for 10 virtual machines that are used for testing. The virtual machines run Windows Server.\n\n        You are troubleshooting an issue on the virtual machines.\n\n        In Security Center, you need to view the alerts generated by the virtual machines during the last five days.\n\n        What should you do?",
      "options": [
        "A. Change the rule expiration date of the suppression rule.",
        "B. Change the state of the suppression rule to Disabled.",
        "C. Modify the filter for the Security alerts page.",
        "D. View the Windows event logs on the virtual machines."
      ],
      "answer": [
        "C"
      ],
      "explanation": "The suppression rule hides alerts from view but does not delete them. You can still view them by modifying the filters in the Security alerts page to include suppressed alerts.\n\n        Reference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/alerts-suppression-rules"
    },
    {
      "type": "multiple_choice",
      "question": "You have a suppression rule in Azure Security Center for 10 virtual machines that are used for testing. The virtual machines run Windows Server.\n\n        You are troubleshooting an issue on the virtual machines.\n\n        In Security Center, you need to view the alerts generated by the virtual machines during the last five days.\n\n        What should you do?",
      "options": [
        "A. Change the rule expiration date of the suppression rule.",
        "B. Change the state of the suppression rule to Disabled.",
        "C. Modify the filter for the Security alerts page.",
        "D. View the Windows event logs on the virtual machines."
      ],
      "answer": [
        "C"
      ],
      "explanation": "The suppression rule hides alerts from view but does not delete them. You can still view them by modifying the filters in the Security alerts page to include suppressed alerts.\n\n        Reference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/alerts-suppression-rules"
    },
    {
      "type": "multiple_choice",
      "question": "You use Azure Security Center.\n\n        You receive a security alert in Security Center.\n\n        You need to view recommendations to resolve the alert in Security Center.\n\n        What should you do?",
      "options": [
        "A. From Security alerts, select the alert, select Take Action, and then expand the Prevent future attacks section.",
        "B. From Security alerts, select Take Action, and then expand the Mitigate the threat section.",
        "C. From Regulatory compliance, download the report.",
        "D. From Recommendations, download the CSV report."
      ],
      "answer": [
        "B"
      ],
      "explanation": "The Mitigate the threat section provides actionable guidance specific to the alert and shows how to resolve it.\n\n        Reference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/alerts"
    },
    {
      "type": "multiple_choice",
      "question": "You have a suppression rule in Azure Security Center for 10 virtual machines that are used for testing. The virtual machines run Windows Server.\n\n        You are troubleshooting an issue on the virtual machines.\n\n        In Security Center, you need to view the alerts generated by the virtual machines during the last five days.\n\n        What should you do?",
      "options": [
        "A. Change the rule expiration date of the suppression rule.",
        "B. Change the state of the suppression rule to Disabled.",
        "C. Modify the filter for the Security alerts page.",
        "D. View the Windows event logs on the virtual machines."
      ],
      "answer": [
        "C"
      ],
      "explanation": "Suppressed alerts can still be reviewed by updating the filters on the Security alerts page.\n\n        Reference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/alerts-suppression-rules"
    },
    {
      "type": "multiple_choice",
      "question": "You create an Azure subscription.\n\n        You enable Azure Defender for the subscription.\n\n        You need to use Azure Defender to protect on-premises computers.\n\n        What should you do on the on-premises computers?",
      "options": [
        "A. Install the Log Analytics agent.",
        "B. Install the Dependency agent.",
        "C. Configure the Hybrid Runbook Worker role.",
        "D. Install the Connected Machine agent."
      ],
      "answer": [
        "A"
      ],
      "explanation": "The Log Analytics agent enables data collection from on-premises machines to Azure for Defender for Cloud.\n\n        Reference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/quickstart-onboard-machines"
    },
    {
      "type": "multiple_choice",
      "question": "A security administrator receives email alerts from Azure Defender for activities such as potential malware uploaded to a storage account and potential successful brute force attacks.\n\n        The security administrator does NOT receive email alerts for activities such as antimalware action failed and suspicious network activity.\n\n        You need to ensure that the security administrator receives email alerts for all the activities.\n\n        What should you configure in the Security Center settings?",
      "options": [
        "A. the severity level of email notifications",
        "B. a cloud connector",
        "C. the Azure Defender plans",
        "D. the integration settings for Threat detection"
      ],
      "answer": [
        "A"
      ],
      "explanation": "Adjusting the severity threshold in Defender for Cloud settings allows email alerts for lower-severity events.\n\n        Reference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/configure-email-notifications"
    },
    {
      "type": "multiple_choice",
      "question": "You have Linux virtual machines on Amazon Web Services (AWS).\n\n        You deploy Azure Defender and enable auto-provisioning.\n\n        You need to monitor the virtual machines by using Azure Defender.\n\n        Solution: You enable Azure Arc and onboard the virtual machines to Azure Arc.\n\n        Does this meet the goal?",
      "options": [
        "A. Yes",
        "B. No"
      ],
      "answer": [
        "A"
      ],
      "explanation": "Azure Arc enables non-Azure machines to be treated as Azure resources for Defender for Cloud protection.\n\n        Reference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/quickstart-onboard-machines"
    },
    {
      "type": "multiple_choice",
      "question": "You have Linux virtual machines on Amazon Web Services (AWS).\n\n        You deploy Azure Defender and enable auto-provisioning.\n\n        You need to monitor the virtual machines by using Azure Defender.\n\n        Solution: You manually install the Log Analytics agent on the virtual machines.\n\n        Does this meet the goal?",
      "options": [
        "A. Yes",
        "B. No"
      ],
      "answer": [
        "B"
      ],
      "explanation": "The Log Analytics agent alone is not sufficient; you must first onboard the VMs via Azure Arc.\n\n        Reference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/quickstart-onboard-machines"
    },
    {
      "type": "multiple_choice",
      "question": "You have five on-premises Linux servers.\n\n        You have an Azure subscription that uses Microsoft Defender for Cloud.\n\n        You need to use Defender for Cloud to protect the Linux servers.\n\n        What should you install on the servers first?",
      "options": [
        "A. the Dependency agent",
        "B. the Log Analytics agent",
        "C. the Azure Connected Machine agent",
        "D. the Guest Configuration extension"
      ],
      "answer": [
        "C"
      ],
      "explanation": "Azure Connected Machine agent is required to connect on-prem Linux servers to Azure via Azure Arc.\n\n        Reference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/quickstart-onboard-machines"
    },
    {
      "type": "multiple_choice",
      "question": "You have an Azure subscription that has Microsoft Defender for Cloud enabled.\n\n        You have a virtual machine named Server1 that runs Windows Server 2022 and is hosted in Amazon Web Services (AWS).\n\n        You need to collect logs and resolve vulnerabilities for Server1 by using Defender for Cloud.\n\n        What should you install first on Server1?",
      "options": [
        "A. the Microsoft Monitoring Agent",
        "B. the Azure Monitor agent",
        "C. the Azure Arc agent",
        "D. the Azure Pipelines agent"
      ],
      "answer": [
        "C"
      ],
      "explanation": "To bring Server1 under Defender for Cloud’s visibility, the Azure Arc agent must be installed first.\n\n        Reference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/quickstart-onboard-machines"
    },
    {
      "type": "multiple_choice",
      "question": "You have an Azure subscription that uses Microsoft Defender for Cloud and contains a storage account named storage1.\n\n        You receive an alert that there was an unusually high volume of delete operations on the blobs in storage1.\n\n        You need to identify which blobs were deleted.\n\n        What should you review?",
      "options": [
        "A. the activity logs of storage1",
        "B. the Azure Storage Analytics logs",
        "C. the alert details",
        "D. the related entities of the alert"
      ],
      "answer": [
        "B"
      ],
      "explanation": "Azure Storage Analytics logs contain the detailed blob operation data needed to identify deleted blobs.\n\n        Reference: https://learn.microsoft.com/en-us/azure/storage/blobs/monitor-blob-storage"
    },
    {
      "type": "multiple_choice",
      "question": "You have an Azure subscription that uses Microsoft Defender for Cloud.\n\nYou need to filter the security alerts view to show the following alerts:\n• Unusual user accessed a key vault\n• Log on from an unusual location\n• Impossible travel activity\nWhich severity should you use?",
      "options": [
        "A. Informational",
        "B. Low",
        "C. Medium",
        "D. High"
      ],
      "answer": [
        "C"
      ],
      "explanation": "Alerts involving behavioral anomalies like unusual location or access patterns are typically classified as 'Medium' severity. Microsoft Defender for Cloud uses this severity level for alerts that indicate suspicious but not yet confirmed threats.\n\nReference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/alerts-overview"
    },
    {
      "type": "multiple_choice",
      "question": "You plan to review Microsoft Defender for Cloud alerts by using a third-party security information and event management (SIEM) solution.\n\nYou need to locate alerts that indicate the use of the Privilege Escalation MITRE ATT&CK tactic.\nWhich JSON key should you search?",
      "options": [
        "A. Description",
        "B. Intent",
        "C. ExtendedProperies",
        "D. Entities"
      ],
      "answer": [
        "B"
      ],
      "explanation": "Microsoft Defender for Cloud includes MITRE ATT&CK tactics in the 'Intent' field in exported alert data. This helps SIEM solutions categorize and filter alerts by attack goals.\n\nReference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/managing-and-responding-alerts"
    },
    {
      "type": "multiple_choice",
      "question": "You have an Azure subscription that has Microsoft Defender for Cloud enabled.\n\nYou have a virtual machine that runs Windows 10 and has the Log Analytics agent installed.\n\nYou need to simulate an attack on the virtual machine that will generate an alert.\nWhat should you do first?",
      "options": [
        "A. Run the Log Analytics Troubleshooting Tool.",
        "B. Copy an executable and rename the file as ASC_AlertTest_662jfi039N.exe.",
        "C. Modify the settings of the Microsoft Monitoring Agent.",
        "D. Run the MMASetup executable and specify the –foo argument"
      ],
      "answer": [
        "B"
      ],
      "explanation": "Using a known test pattern like renaming an executable to ASC_AlertTest triggers a simulated attack that generates a Defender alert for validation purposes.\n\nReference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/quickstart-onboard-machines"
    },
    {
      "type": "multiple_choice",
      "question": "You have an Azure subscription that uses Microsoft Defender for Cloud and contains 100 virtual machines that run Windows Server.\n\nYou need to configure Defender for Cloud to collect event data from the virtual machines. The solution must minimize administrative effort and costs.\n\nWhich two actions should you perform? Each correct answer presents part of the solution.",
      "options": [
        "A. From the workspace created by Defender for Cloud, set the data collection level to Common.",
        "B. From the Microsoft Endpoint Manager admin center, enable automatic enrollment.",
        "C. From the Azure portal, create an Azure Event Grid subscription.",
        "D. From the workspace created by Defender for Cloud, set the data collection level to All Events.",
        "E. From Defender for Cloud in the Azure portal, enable automatic provisioning for the virtual machines."
      ],
      "answer": [
        "A",
        "E"
      ],
      "explanation": "Setting the data collection level to 'Common' helps reduce cost while collecting essential security events. Enabling automatic provisioning simplifies deploying agents across VMs.\n\nReference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/enable-data-collection"
    },
    {
      "type": "multiple_choice",
      "question": "You have an Azure subscription that uses Microsoft Defender for Cloud and contains a user named User1.\n\nYou need to ensure that User1 can modify Microsoft Defender for Cloud security policies. The solution must use the principle of least privilege.\n\nWhich role should you assign to User1?",
      "options": [
        "A. Security operator",
        "B. Security Admin",
        "C. Owner",
        "D. Contributor"
      ],
      "answer": [
        "B"
      ],
      "explanation": "The Security Admin role allows full access to security policies and recommendations in Microsoft Defender for Cloud.\n\nReference: https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#security-admin"
    },
    {
      "type": "multiple_choice",
      "question": "You have an Azure subscription that contains a user named User1.\n\nUser1 is assigned an Azure Active Directory Premium Plan 2 license.\n\nYou need to identify whether the identity of User1 was compromised during the last 90 days.\n\nWhat should you use?",
      "options": [
        "A. the risk detections report",
        "B. the risky users report",
        "C. Identity Secure Score recommendations",
        "D. the risky sign-ins report"
      ],
      "answer": [
        "B"
      ],
      "explanation": "The risky users report identifies users flagged for potential compromise based on risk events.\n\nReference: https://learn.microsoft.com/en-us/azure/active-directory/reports-monitoring/concept-risky-users"
    },
    {
      "type": "multiple_choice",
      "question": "You have an Azure subscription that uses Microsoft Defender for Cloud.\n\nYou have an Amazon Web Services (AWS) account that contains an Amazon EC2 instance named EC2-1.\n\nYou need to onboard EC2-1 to Defender for Cloud.\n\nWhat should you install on EC2-1?",
      "options": [
        "A. the Log Analytics agent",
        "B. the Azure Connected Machine agent",
        "C. the unified Microsoft Defender for Endpoint solution package",
        "D. Microsoft Monitoring Agent"
      ],
      "answer": [
        "B"
      ],
      "explanation": "To onboard non-Azure machines like AWS EC2 instances to Defender for Cloud, use the Azure Arc agent (Connected Machine agent).\n\nReference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/quickstart-onboard-machines"
    },
    {
      "type": "multiple_choice",
      "question": "You have an Azure subscription that uses Microsoft Defender for Cloud and contains a resource group named RG1.\nRG1 contains 20 virtual machines that run Windows Server 2019.\n\nYou need to configure just-in-time (JIT) access for the virtual machines in RG1. The solution must meet the following requirements:\n\n• Limit the maximum request time to two hours.\n• Limit protocols access to Remote Desktop Protocol (RDP) only.\n• Minimize administrative effort.\n\nWhat should you use?",
      "options": [
        "A. Azure AD Privileged Identity Management (PIM)",
        "B. Azure Policy",
        "C. Azure Bastion",
        "D. Azure Front Door"
      ],
      "answer": [
        "B"
      ],
      "explanation": "Azure Policy allows you to enforce specific security configurations at scale.\nYou can use Azure Policy to configure JIT VM access through Microsoft Defender for Cloud, meeting all three requirements with minimal effort.\nJIT policies help restrict access and automatically apply security recommendations.\n\nReference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/just-in-time-access-overview"
    },
    {
      "type": "multiple_choice",
      "question": "You have an Azure subscription that contains a virtual machine named VM1 and uses Microsoft Defender for Cloud.\n\nMicrosoft Defender for Cloud has automatic provisioning configured to use Azure Monitor Agent.\n\nYou need to create a custom alert suppression rule that will suppress false positive alerts for suspicious use of PowerShell on VM1.\n\nWhat should you do first?",
      "options": [
        "A. From Microsoft Defender for Cloud, export the alerts to a Log Analytics workspace.",
        "B. From Microsoft Defender for Cloud, add a workflow automation.",
        "C. On VM1, trigger a PowerShell alert.",
        "D. On VM1, run the Get-MPThreatCatalog cmdlet."
      ],
      "answer": [
        "C"
      ],
      "explanation": "To create a suppression rule, you first need an instance of the alert to appear in Microsoft Defender for Cloud.\nTriggering the PowerShell activity ensures that the alert is generated, after which you can apply a suppression rule to avoid future false positives.\n\nReference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/alerts-suppression-rules"
    },
    {
      "type": "multiple_choice",
      "question": "You have the resources shown in the following table:\n\n| Name    | Type            | Description                                | Location                  |\n|---------|-----------------|--------------------------------------------|---------------------------|\n| Server1 | Server          | File server that runs Windows Server       | On-premises               |\n| Server2 | Virtual machine | Application server that runs Linux         | Amazon Web Services (AWS) |\n| Server3 | Virtual machine | Domain controller that runs Windows Server | Azure                     |\n| Server4 | Server          | Domain controller that runs Windows Server | On-premises               |\n\nYou have an Azure subscription that uses Microsoft Defender for Cloud.\n\nYou need to enable Microsoft Defender for Servers on each resource.\n\nWhich resources will require the installation of the Azure Arc agent?",
      "options": [
        "A. Server3 only",
        "B. Server1 and Server4 only",
        "C. Server1, Server2, and Server4 only",
        "D. Server1, Server2, Server3, and Server4"
      ],
      "answer": [
        "C"
      ],
      "explanation": "Azure Arc is required to extend Defender for Servers to on-premises and multicloud (non-Azure) VMs.\nServer1 and Server4 are on-premises, and Server2 is in AWS. Therefore, all three require Azure Arc. Server3 is in Azure and does not.\n\nReference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/defender-for-servers-introduction#onboard-non-azure-machines-using-azure-arc"
    },
    {
      "type": "multiple_choice",
      "question": "You have an Azure subscription that uses Microsoft Defender for Cloud.\n\n        You have a GitHub account named Account1 that contains 10 repositories.\n\n        You need to ensure that Defender for Cloud can access the repositories in Account1.\n\n        What should you do first in the Microsoft Defender for Cloud portal?",
      "options": [
        "A. Enable integrations.",
        "B. Enable a plan.",
        "C. Add an environment.",
        "D. Enable security policies."
      ],
      "answer": [
        "C"
      ],
      "explanation": "To connect a GitHub organization and its repositories to Defender for Cloud,\n        you must first add it as an environment. This grants Defender the required permissions to monitor and assess the security of your GitHub repositories.\n\n        Reference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/quickstart-onboard-github"
    },
    {
      "type": "multiple_choice",
      "question": "You have an Azure subscription that uses Microsoft Defender for Cloud and contains 100 virtual machines that run Windows Server.\n\n        You need to configure Defender for Cloud to collect event data from the virtual machines. The solution must minimize administrative effort and costs.\n\n        Which two actions should you perform? Each correct answer presents part of the solution.\n\n        NOTE: Each correct selection is worth one point.",
      "options": [
        "A. Configure auto-provisioning by setting the security event storage to Common.",
        "B. From the Microsoft Endpoint Manager admin center, enable automatic enrollment.",
        "C. From the Azure portal, create an Azure Event Grid subscription.",
        "D. Configure auto-provisioning by setting the security event storage to All Events.",
        "E. From Defender for Cloud in the Azure portal, enable Microsoft Defender for Servers."
      ],
      "answer": [
        "A",
        "E"
      ],
      "explanation": "Option A configures Defender for Cloud to collect a minimal set of security events\n        ('Common') which helps reduce cost and administrative overhead. Option E enables Microsoft Defender for Servers,\n        which includes capabilities such as vulnerability assessments, just-in-time VM access, and security event collection.\n\n        Reference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/defender-for-servers-introduction"
    },
    {
      "type": "multiple_choice",
      "question": "You have an Azure subscription that uses Microsoft Defender for Cloud.\n\n        You have an Amazon Web Services (AWS) subscription. The subscription contains multiple virtual machines that run Windows Server.\n\n        You need to enable Microsoft Defender for Servers on the virtual machines.\n\n        Which two actions should you perform? Each correct answer presents part of the solution.\n\n        NOTE: Each correct answer is worth one point.",
      "options": [
        "A. From Defender for Cloud, enable agentless scanning.",
        "B. Onboard the virtual machines to Microsoft Defender for Endpoint.",
        "C. From Defender for Cloud, configure the AWS connector.",
        "D. Install the Azure Virtual Machine Agent (VM Agent) on each virtual machine.",
        "E. From Defender for Cloud, configure auto-provisioning."
      ],
      "answer": [
        "C",
        "E"
      ],
      "explanation": "To enable Defender for Servers on AWS VMs, you must first connect the AWS account using\n        the AWS connector (C), and then configure auto-provisioning (E) to deploy the required agents like the Log Analytics agent\n        or Microsoft Defender for Endpoint.\n\n        Reference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/aws-integration"
    },
    {
      "type": "multiple_choice",
      "question": "You create an Azure subscription named sub1.\n\n        In sub1, you create a Log Analytics workspace named workspace1.\n\n        You enable Microsoft Defender for Cloud and configure Defender for Cloud to use workspace1.\n\n        You need to collect security event logs from the Azure virtual machines that report to workspace1.\n\n        What should you do?",
      "options": [
        "A. From Defender for Cloud, modify Microsoft Defender for Servers plan settings.",
        "B. In sub1, register a provider.",
        "C. From Defender for Cloud, create a workflow automation.",
        "D. In workspace1, create a workbook."
      ],
      "answer": [
        "A"
      ],
      "explanation": "To configure Defender for Cloud to collect security logs, you must modify the Microsoft Defender\n        for Servers plan settings and specify the desired data collection level and workspace.\n\n        Reference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/defender-for-servers-introduction#enable-defender-for-servers"
    },
    {
      "type": "multiple_choice",
      "question": "You have an existing Azure logic app that is used to block Azure Active Directory (Azure AD) users.\n        The logic app is triggered manually.\n\n        You deploy Azure Sentinel.\n\n        You need to use the existing logic app as a playbook in Azure Sentinel.\n\n        What should you do first?",
      "options": [
        "A. Add a new scheduled query rule.",
        "B. Add a data connector to Azure Sentinel.",
        "C. Configure a custom Threat Intelligence connector in Azure Sentinel.",
        "D. Modify the trigger in the logic app."
      ],
      "answer": [
        "D"
      ],
      "explanation": "To convert a manually triggered logic app into a Sentinel playbook, you must change\n        its trigger to be one supported by Sentinel (e.g., 'When a response to an Azure Sentinel alert is triggered').\n\n        Reference: https://learn.microsoft.com/en-us/azure/sentinel/tutorial-respond-threats-playbook"
    },
    {
      "type": "multiple_choice",
      "question": "Your company uses Azure Sentinel to manage alerts from more than 10,000 IoT devices.\n        A security manager at the company reports that tracking security threats is increasingly difficult due to the large number of incidents.\n        You need to recommend a solution to provide a custom visualization to simplify the investigation of threats and to infer threats by using machine learning.\n        What should you include in the recommendation?",
      "options": [
        "A. built-in queries",
        "B. livestream",
        "C. notebooks",
        "D. bookmarks"
      ],
      "answer": [
        "C"
      ],
      "explanation": "Azure Sentinel notebooks are Jupyter notebooks integrated with Azure Sentinel.\n        They allow security teams to perform advanced hunting, visualize data, and use machine learning for threat detection,\n        investigation, and response in a highly customizable way.\n\n        Reference: https://learn.microsoft.com/en-us/azure/sentinel/notebooks"
    },
    {
      "type": "multiple_choice",
      "question": "You have a playbook in Azure Sentinel.\n        When you trigger the playbook, it sends an email to a distribution group.\n        You need to modify the playbook to send the email to the owner of the resource instead of the distribution group.\n        What should you do?",
      "options": [
        "A. Add a parameter and modify the trigger.",
        "B. Add a custom data connector and modify the trigger.",
        "C. Add a condition and modify the action.",
        "D. Add an alert and modify the action."
      ],
      "answer": [
        "A"
      ],
      "explanation": "To make the playbook dynamic and send emails to different recipients based on context,\n        you should use parameters in the logic app and modify the trigger to accept input that includes the owner's email.\n        This approach allows greater flexibility and meets the need to target the resource owner.\n\n        Reference: https://learn.microsoft.com/en-us/azure/sentinel/tutorial-respond-threats-playbook"
    },
    {
      "type": "multiple_choice",
      "question": "Your company stores the data of every project in a different Azure subscription.\n        All the subscriptions use the same Azure Active Directory (Azure AD) tenant.\n        Every project consists of multiple Azure virtual machines that run Windows Server.\n        The Windows events of the virtual machines are stored in a Log Analytics workspace in each machine's respective subscription.\n        You deploy Azure Sentinel to a new Azure subscription.\n        You need to perform hunting queries in Azure Sentinel to search across all the Log Analytics workspaces of all the subscriptions.\n        Which two actions should you perform? Each correct answer presents part of the solution.\n        NOTE: Each correct selection is worth one point.",
      "options": [
        "A. Add the Security Events connector to the Azure Sentinel workspace.",
        "B. Create a query that uses the workspace expression and the union operator.",
        "C. Use the alias statement.",
        "D. Create a query that uses the resource expression and the alias operator.",
        "E. Add the Azure Sentinel solution to each workspace."
      ],
      "answer": [
        "B",
        "E"
      ],
      "explanation": "To query across multiple workspaces in Azure Sentinel, you must use the workspace() expression\n        and union operator in your query. Additionally, Azure Sentinel must be enabled in each workspace from which you want to collect data.\n\n        Reference: https://learn.microsoft.com/en-us/azure/sentinel/hunt-hunting-queries#query-across-workspaces"
    },
    {
      "type": "multiple_choice",
      "question": "You have an Azure Sentinel workspace.\n    You need to test a playbook manually in the Azure portal.\n    From where can you run the test in Azure Sentinel?",
      "options": [
        "A. Playbooks",
        "B. Analytics",
        "C. Threat intelligence",
        "D. Incidents"
      ],
      "answer": [
        "D"
      ],
      "explanation": "To manually trigger and test a playbook in Azure Sentinel, you must do so from the Incidents view.\n    Here, you can associate the playbook with an incident and execute it directly.\n\n    Reference: https://learn.microsoft.com/en-us/azure/sentinel/automate-response"
    },
    {
      "type": "multiple_choice",
      "question": "You have a custom analytics rule to detect threats in Azure Sentinel.\n    You discover that the analytics rule stopped running. The rule was disabled, and the rule name has a prefix of AUTO DISABLED.\n    What is a possible cause of the issue?",
      "options": [
        "A. There are connectivity issues between the data sources and Log Analytics.",
        "B. The number of alerts exceeded 10,000 within two minutes.",
        "C. The rule query takes too long to run and times out.",
        "D. Permissions to one of the data sources of the rule query were modified."
      ],
      "answer": [
        "D"
      ],
      "explanation": "Azure Sentinel automatically disables custom analytics rules if required data access permissions are lost.\n    This can occur when permissions to a data source are modified or revoked.\n\n    Reference: https://learn.microsoft.com/en-us/azure/sentinel/troubleshoot#auto-disabled-analytics-rules"
    },
    {
      "type": "multiple_choice",
      "question": "Your company uses Azure Sentinel.\n    A new security analyst reports that she cannot assign and resolve incidents in Azure Sentinel.\n    You need to ensure that the analyst can assign and resolve incidents. The solution must use the principle of least privilege.\n    Which role should you assign to the analyst?",
      "options": [
        "A. Azure Sentinel Responder",
        "B. Logic App Contributor",
        "C. Azure Sentinel Contributor",
        "D. Azure Sentinel Reader"
      ],
      "answer": [
        "A"
      ],
      "explanation": "The Azure Sentinel Responder role grants permissions to view incidents, update their status,\n    assign them to users, and add comments. It adheres to the principle of least privilege by not including unnecessary permissions.\n\n    Reference: https://learn.microsoft.com/en-us/azure/sentinel/roles#azure-sentinel-roles"
    },
    {
      "type": "multiple_choice",
      "question": "You recently deployed Azure Sentinel.\n    You discover that the default Fusion rule does not generate any alerts. You verify that the rule is enabled.\n    You need to ensure that the Fusion rule can generate alerts.\n    What should you do?",
      "options": [
        "A. Disable, and then enable the rule.",
        "B. Add data connectors",
        "C. Create a new machine learning analytics rule.",
        "D. Add a hunting bookmark."
      ],
      "answer": [
        "B"
      ],
      "explanation": "The Fusion rule in Azure Sentinel relies on input from various data connectors to detect multistage attacks.\n    If no relevant data connectors are connected, the rule cannot function effectively.\n    Enabling the necessary connectors ensures the rule has the input data required to generate alerts.\n\n    Reference: https://learn.microsoft.com/en-us/azure/sentinel/fusion\"\n"
    },
    {
      "type": "multiple_choice",
      "question": "A company uses Azure Sentinel.\n    You need to create an automated threat response.\n    What should you use?",
      "options": [
        "A. a data connector",
        "B. a playbook",
        "C. a workbook",
        "D. a Microsoft incident creation rule"
      ],
      "answer": [
        "B"
      ],
      "explanation": "Playbooks in Azure Sentinel are used for automated incident response.\n    They are based on Azure Logic Apps and allow you to create workflows that respond to alerts and incidents.\n\n    Reference: https://learn.microsoft.com/en-us/azure/sentinel/tutorial-respond-threats-playbook\"\n"
    },
    {
      "type": "multiple_choice",
      "question": "You have an Azure Sentinel deployment in the East US Azure region.\n    You create a Log Analytics workspace named LogsWest in the West US Azure region.\n    You need to ensure that you can use scheduled analytics rules in the existing Azure Sentinel deployment to generate alerts based on queries to LogsWest.\n    What should you do first?",
      "options": [
        "A. Deploy Azure Data Catalog to the West US Azure region.",
        "B. Modify the workspace settings of the existing Azure Sentinel deployment.",
        "C. Add Azure Sentinel to a workspace.",
        "D. Create a data connector in Azure Sentinel."
      ],
      "answer": [
        "C"
      ],
      "explanation": "To run analytics rules on a workspace, Azure Sentinel must first be enabled on that workspace.\n    You must add Azure Sentinel to the LogsWest workspace to use it with scheduled rules.\n\n    Reference: https://learn.microsoft.com/en-us/azure/sentinel/quickstart-onboard\"\n"
    },
    {
      "type": "multiple_choice",
      "question": "You create a custom analytics rule to detect threats in Azure Sentinel.\n    You discover that the rule fails intermittently.\n    What are two possible causes of the failures? Each correct answer presents part of the solution.",
      "options": [
        "A. The rule query takes too long to run and times out.",
        "B. The target workspace was deleted.",
        "C. Permissions to the data sources of the rule query were modified.",
        "D. There are connectivity issues between the data sources and Log Analytics"
      ],
      "answer": [
        "A",
        "D"
      ],
      "explanation": "Intermittent failures of analytics rules in Azure Sentinel can occur due to long-running queries that time out,\n    or temporary connectivity issues with data sources. Both scenarios prevent the rule from executing successfully.\n\n    Reference: https://learn.microsoft.com/en-us/azure/sentinel/troubleshoot#analytics-rule-failures\"\n"
    },
    {
      "type": "multiple_choice",
      "question": "You recently deployed Azure Sentinel.\nYou discover that the default Fusion rule does not generate any alerts. You verify that the rule is enabled.\nYou need to ensure that the Fusion rule can generate alerts.\nWhat should you do?",
      "options": [
        "A. Disable, and then enable the rule.",
        "B. Add data connectors",
        "C. Create a new machine learning analytics rule.",
        "D. Add a hunting bookmark."
      ],
      "answer": [
        "B"
      ],
      "explanation": "The Fusion rule in Azure Sentinel relies on input from various data connectors to detect multistage attacks.\nIf no relevant data connectors are connected, the rule cannot function effectively.\nEnabling the necessary connectors ensures the rule has the input data required to generate alerts.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/fusion\"\n"
    },
    {
      "type": "multiple_choice",
      "question": "A company uses Azure Sentinel.\nYou need to create an automated threat response.\nWhat should you use?",
      "options": [
        "A. a data connector",
        "B. a playbook",
        "C. a workbook",
        "D. a Microsoft incident creation rule"
      ],
      "answer": [
        "B"
      ],
      "explanation": "Playbooks in Azure Sentinel are used for automated incident response.\nThey are based on Azure Logic Apps and allow you to create workflows that respond to alerts and incidents.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/tutorial-respond-threats-playbook\"\n"
    },
    {
      "type": "multiple_choice",
      "question": "You have an Azure Sentinel deployment in the East US Azure region.\nYou create a Log Analytics workspace named LogsWest in the West US Azure region.\nYou need to ensure that you can use scheduled analytics rules in the existing Azure Sentinel deployment to generate alerts based on queries to LogsWest.\nWhat should you do first?",
      "options": [
        "A. Deploy Azure Data Catalog to the West US Azure region.",
        "B. Modify the workspace settings of the existing Azure Sentinel deployment.",
        "C. Add Azure Sentinel to a workspace.",
        "D. Create a data connector in Azure Sentinel."
      ],
      "answer": [
        "C"
      ],
      "explanation": "To run analytics rules on a workspace, Azure Sentinel must first be enabled on that workspace.\nYou must add Azure Sentinel to the LogsWest workspace to use it with scheduled rules.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/quickstart-onboard\"\n"
    },
    {
      "type": "multiple_choice",
      "question": "You create a custom analytics rule to detect threats in Azure Sentinel.\nYou discover that the rule fails intermittently.\nWhat are two possible causes of the failures? Each correct answer presents part of the solution.",
      "options": [
        "A. The rule query takes too long to run and times out.",
        "B. The target workspace was deleted.",
        "C. Permissions to the data sources of the rule query were modified.",
        "D. There are connectivity issues between the data sources and Log Analytics"
      ],
      "answer": [
        "A",
        "D"
      ],
      "explanation": "Intermittent failures of analytics rules in Azure Sentinel can occur due to long-running queries that time out,\nor temporary connectivity issues with data sources. Both scenarios prevent the rule from executing successfully.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/troubleshoot#analytics-rule-failures\"\n"
    },
    {
      "type": "multiple_choice",
      "question": "You are configuring Azure Sentinel.\n    You need to create an incident in Azure Sentinel when a sign-in to an Azure virtual machine from a malicious IP address is detected.\n    Solution: You create a scheduled query rule for a data connector.\n    Does this meet the goal?",
      "options": [
        "A. Yes",
        "B. No"
      ],
      "answer": [
        "A"
      ],
      "explanation": "Creating a scheduled query rule for a data connector allows Azure Sentinel to detect specific threat patterns—such as sign-ins from malicious IP addresses—and automatically generate incidents.\n    This solution meets the requirement.\n\n    Reference: https://learn.microsoft.com/en-us/azure/sentinel/tutorial-detect-threats-custom\"\n    "
    },
    {
      "type": "multiple_choice",
      "question": "You are configuring Azure Sentinel.\n    You need to create an incident in Azure Sentinel when a sign-in to an Azure virtual machine from a malicious IP address is detected.\n    Solution: You create a hunting bookmark.\n    Does this meet the goal?",
      "options": [
        "A. Yes",
        "B. No"
      ],
      "answer": [
        "B"
      ],
      "explanation": "Hunting bookmarks in Azure Sentinel are used to flag and track suspicious data during proactive threat hunting.\n    They do not automatically create incidents. Therefore, this does not meet the goal.\n\n    Reference: https://learn.microsoft.com/en-us/azure/sentinel/bookmarks\"\n    "
    },
    {
      "type": "multiple_choice",
      "question": "You are configuring Azure Sentinel.\n    You need to create an incident in Azure Sentinel when a sign-in to an Azure virtual machine from a malicious IP address is detected.\n    Solution: You create a Microsoft incident creation rule for a data connector.\n    Does this meet the goal?",
      "options": [
        "A. Yes",
        "B. No"
      ],
      "answer": [
        "A"
      ],
      "explanation": "Incident creation rules can be configured to automatically generate incidents in Azure Sentinel when specific alert conditions from data connectors are met.\n    This satisfies the requirement.\n\n    Reference: https://learn.microsoft.com/en-us/azure/sentinel/tutorial-detect-threats-custom#create-a-scheduled-analytics-rule\"\n    "
    },
    {
      "type": "multiple_choice",
      "question": "You plan to create a custom Azure Sentinel query that will track anomalous Azure Active Directory (Azure AD) sign-in activity and present the activity as a time chart aggregated by day.\n    You need to create a query that will be used to display the time chart.\n    What should you include in the query?",
      "options": [
        "A. extend",
        "B. bin",
        "C. makeset",
        "D. workspace"
      ],
      "answer": [
        "B"
      ],
      "explanation": "The 'bin' operator in Kusto Query Language (KQL) is used to group events by time intervals for time series analysis.\n    It’s essential for visualizing aggregated data over time, such as a daily time chart.\n\n    Reference: https://learn.microsoft.com/en-us/azure/data-explorer/kusto/query/binfunction\"\n    "
    },
    {
      "type": "multiple_choice",
      "question": "You are configuring Azure Sentinel.\n    You need to send a Microsoft Teams message to a channel whenever a sign-in from a suspicious IP address is detected.\n    Which two actions should you perform in Azure Sentinel?",
      "options": [
        "A. Add a playbook.",
        "B. Associate a playbook to an incident.",
        "C. Enable Entity behavior analytics.",
        "D. Create a workbook.",
        "E. Enable the Fusion rule."
      ],
      "answer": [
        "A",
        "B"
      ],
      "explanation": "Playbooks in Azure Sentinel use Logic Apps to automate responses like sending messages to Microsoft Teams.\n    To execute a playbook automatically in response to an alert, it must be associated with the incident that triggers it.\n\n    Reference: https://learn.microsoft.com/en-us/azure/sentinel/tutorial-respond-threats-playbook\"\n    "
    },
    {
      "type": "multiple_choice",
      "question": "You need to visualize Azure Sentinel data and enrich the data by using third-party data sources to identify indicators of compromise (IoC).\n    What should you use?",
      "options": [
        "A. notebooks in Azure Sentinel",
        "B. Microsoft Cloud App Security",
        "C. Azure Monitor",
        "D. hunting queries in Azure Sentinel"
      ],
      "answer": [
        "A"
      ],
      "explanation": "Notebooks in Azure Sentinel allow security analysts to use Jupyter notebooks to perform advanced analytics, enrich data using threat intelligence sources, and visualize IoCs using custom code.\n    They are ideal for threat hunting and forensic investigations.\n\n    Reference: https://learn.microsoft.com/en-us/azure/sentinel/notebooks\"\n    "
    },
    {
      "type": "multiple_choice",
      "question": "This is a case study. Case studies are not timed separately. You can use as much exam time as you would like to complete each case. However, there may be additional case studies and sections on this exam. You must manage your time to ensure that you are able to complete all questions included in this exam in the time provided.\n\nTo answer the questions included in a case study, you will need to reference information that is provided in the case study. Case studies might contain exhibits and other resources that provide more information about the scenario that is described in the case study. Each question is independent of the other questions in this case study.\n\nAt the end of this case study, a review screen will appear. This screen allows you to review your answers and to make changes before you move to the next section of the exam. After you begin a new section, you cannot return to this section.\n\nTo start the case study\n-\nTo display the first question in this case study, click the Next button. Use the buttons in the left pane to explore the content of the case study before you answer the questions. Clicking these buttons displays information such as business requirements, existing environment, and problem statements. If the case study has an All Information tab, note that the information displayed is identical to the information displayed on the subsequent tabs. When you are ready to answer a question, click the Question button to return to the question.\n\nOverview\n-\n\nFabrikam, Inc. is a financial services company.\n\nThe company has branch offices in New York, London, and Singapore. Fabrikam has remote users located across the globe. The remote users access company resources, including cloud resources, by using a VPN connection to a branch office.\n\nExisting Environment\n-\n\nIdentity Environment\n-\n\nThe network contains an Active Directory Domain Services (AD DS) forest named fabrikam.com that syncs with an Azure AD tenant named fabrikam.com. To sync the forest, Fabrikam uses Azure AD Connect with pass-through authentication enabled and password hash synchronization disabled.\n\nThe fabrikam.com forest contains two global groups named Group1 and Group2.\n\nMicrosoft 365 Environment\n-\n\nAll the users at Fabrikam are assigned a Microsoft 365 E5 license and an Azure Active Directory Premium Plan 2 license.\n\nFabrikam implements Microsoft Defender for Identity and Microsoft Defender for Cloud Apps and enables log collectors.\n\nAzure Environment\n-\n\nFabrikam has an Azure subscription that contains the resources shown in the following table.\n\n| Name      | Type                              | Description                                                                                         |\n|-----------|-----------------------------------|-----------------------------------------------------------------------------------------------------|\n| App1      | Azure logic app                   | To automate incident generation in an internal ticketing system, the SecOps team invokes App1 using an HTTP endpoint. |\n| SAWkspc1  | Azure Synapse Analytics workspace | SAWkspc1 hosts an Apache Spark pool named Pool1.                                                    |\n| LAWkspc1  | Log Analytics workspace           | LAWkspc1 will be used in a planned Microsoft Sentinel implementation.                              |\n\nAmazon Web Services (AWS) Environment\n\nFabrikam has an Amazon Web Services (AWS) account named Account1. Account1 contains 100 Amazon Elastic Compute Cloud (EC2) instances that run a custom Windows Server 2022. The image includes Microsoft SQL Server 2019 and does NOT have any agents installed.\n\nCurrent Issues\n-\n\nWhen the users use the VPN connections, Microsoft 365 Defender raises a high volume of impossible travel alerts that are false positives.\nDefender for Identity raises a high volume of Suspected DCSync attack alerts that are false positives.\n\nRequirements\n-\n\nPlanned changes\n-\n\nFabrikam plans to implement the following services:\n• Microsoft Defender for Cloud\n• Microsoft Sentinel\n\nBusiness Requirements\n-\n\nFabrikam identifies the following business requirements:\n• Use the principle of least privilege, whenever possible.\n• Minimize administrative effort.\n\nMicrosoft Defender for Cloud Requirements\n-\n\nFabrikam identifies the following Microsoft Defender for Cloud requirements:\n• Ensure that the members of Group2 can modify security policies.\n• Ensure that the members of Group1 can assign regulatory compliance policy initiatives at the Azure subscription level.\n• Automate the deployment of the Azure Connected Machine agent for Azure Arc-enabled servers to the existing and future resources of Account1.\n• Minimize the administrative effort required to investigate the false positive alerts.\n\nYou need to deploy the native cloud connector to Account1 to meet the Microsoft Defender for Cloud requirements.\n\nWhat should you do in Account1 first?",
      "options": [
        "A. Create an AWS user for Defender for Cloud.",
        "B. Configure AWS Security Hub.",
        "C. Deploy the AWS Systems Manager (SSM) agent.",
        "D. Create an Access control (IAM) role for Defender for Cloud."
      ],
      "answer": [
        "B"
      ],
      "explanation": "**Explanation:**\nTo enable native integration of AWS resources into Microsoft Defender for Cloud, the AWS Security Hub must be configured first. This enables security findings to be shared with Defender for Cloud via the AWS Security Hub integration.\n\n**Reference:**\nhttps://learn.microsoft.com/en-us/azure/defender-for-cloud/aws-integration"
    },
    {
      "type": "multiple_choice",
      "question": "You have the resources shown in the following table.\n\n| Name    | Type            | Description                                | Location                  |\n|---------|-----------------|--------------------------------------------|---------------------------|\n| Server1 | Server          | File server that runs Windows Server       | On-premises               |\n| Server2 | Virtual machine | Application server that runs Linux         | Amazon Web Services (AWS) |\n| Server3 | Virtual machine | Domain controller that runs Windows Server | Azure                     |\n| Server4 | Server          | Domain controller that runs Windows Server | On-premises               |\n\nYou have an Azure subscription that uses Microsoft Defender for Cloud.\n\nYou need to enable Microsoft Defender for Servers on each resource.\n\nWhich resources will require the installation of the Azure Arc agent?",
      "options": [
        "A. Server3 only",
        "B. Server1 and Server4 only",
        "C. Server1, Server2, and Server4 only",
        "D. Server1, Server2, Server3, and Server4"
      ],
      "answer": [
        "C"
      ],
      "explanation": "**Explanation:**\nMicrosoft Defender for Servers requires Azure Arc to onboard non-Azure machines.\nServer1 and Server4 are on-premises, and Server2 is in AWS. All three are non-Azure resources and therefore require Azure Arc.\nServer3 is already in Azure and can be onboarded directly without Azure Arc.\n\n**Reference:**\nhttps://learn.microsoft.com/en-us/azure/defender-for-cloud/defender-for-servers-introduction"
    },
    {
      "type": "multiple_choice",
      "question": "Case study -\n\nThis is a case study. Case studies are not timed separately. You can use as much exam time as you would like to complete each case. However, there may be additional case studies and sections on this exam. You must manage your time to ensure that you are able to complete all questions included in this exam in the time provided.\n\nTo answer the questions included in a case study, you will need to reference information that is provided in the case study. Case studies might contain exhibits and other resources that provide more information about the scenario that is described in the case study. Each question is independent of the other questions in this case study.\n\nAt the end of this case study, a review screen will appear. This screen allows you to review your answers and to make changes before you move to the next section of the exam. After you begin a new section, you cannot return to this section.\n\nTo start the case study -\nTo display the first question in this case study, click the Next button. Use the buttons in the left pane to explore the content of the case study before you answer the questions. Clicking these buttons displays information such as business requirements, existing environment, and problem statements. If the case study has an All Information tab, note that the information displayed is identical to the information displayed on the subsequent tabs. When you are ready to answer a question, click the Question button to return to the question.\n\nOverview -\n\nAdatum Corporation is a United States-based financial services company that has regional offices in New York, Chicago, and San Francisco.\n\nExisting Environment -\n\nIdentity Environment -\n\nThe on-premises network contains an Active Directory Domain Services (AD DS) forest named corp.adatum.com that syncs with an Azure AD tenant named adatum.com. All user and group management tasks are performed in corp.adatum.com. The corp.adatum.com domain contains a group named Group1 that syncs with adatum.com.\n\nLicensing Status -\n\nAll the users at Adatum are assigned a Microsoft 365 ES license and an Azure Active Directory Premium P2 license.\n\nCloud Environment -\n\nThe cloud environment contains a Microsoft 365 subscription, an Azure subscription linked to the adatum.com tenant, and the resources shown in the following table:\n\n| Name      | Type                             | Description                                               |\n|-----------|----------------------------------|-----------------------------------------------------------|\n| Sentinel1 | Microsoft Sentinel workspace     | Includes a custom hunting query named HuntingQuery1       |\n| Server2   | Azure virtual machine            | Runs Windows Server 2022                                  |\n\nOn-premises Environment -\n\nThe on-premises network contains the resources shown in the following table:\n\n| Name      | Type                 | Description                                                                                       |\n|-----------|----------------------|---------------------------------------------------------------------------------------------------|\n| Server1   | Server               | Runs Windows Server 2019. Has Azure Arc-enabled and the Azure Monitor agent installed              |\n| Webapp1   | Web service          | An on-premises, public-facing HTTP/HTTPS web service that generates JSON output in response to GET HTTP requests |\n| Infoblox1 | Infoblox DNS service | A third-party DNS service appliance linked to Sentinel1 by using a data connector                 |\n\nRequirements -\n\nPlanned changes -\n\nAdatum plans to perform the following changes:\n• Implement a query named rulequery1 that will include a KQL query.\n• Implement a Microsoft Sentinel scheduled rule that generates incidents based on rulequery1.\n\nMicrosoft Defender for Cloud Requirements:\n• The members of Group1 must be able to enable Defender for Cloud plans and apply regulatory compliance initiatives.\n• Microsoft Defender for Servers Plan 2 must be enabled on all the Azure virtual machines.\n• Server2 must be excluded from agentless scanning.\n\nMicrosoft Sentinel Requirements:\n• Implement an ASIM query to return a count of DNS requests resulting in NXDOMAIN from Infoblox1.\n• Consolidate alerts from rulequery1 into a single incident if launched multiple times.\n• Configure the AMA connector for Windows Security logs on Server1.\n• Automatically close incidents triggered by rulequery1 for SecOps team activity.\n• Implement a workbook named Workbook1 that pulls data dynamically from Webapp1.\n• Implement a near-real-time rule for break glass account sign-ins.\n• Automatically run HuntingQuery1 when the Hunting page is accessed.\n• Detect abnormal volumes of password resets.\n• Minimize overhead in ASIM parser usage.\n• Ensure Group1 can manage playbooks.\n• Use built-in ASIM parsers where possible.\n\nBusiness Requirements:\n• Apply the principle of least privilege.\n• Minimize administrative effort.\n\nYou need to implement the Defender for Cloud requirements.\n\nWhat should you configure for Server2?",
      "options": [
        "A. the Microsoft Antimalware extension",
        "B. the Azure Automanage machine configuration extension for Windows",
        "C. an Azure resource lock",
        "D. an Azure resource tag"
      ],
      "answer": [
        "D"
      ],
      "image": "Images/hotspot35.png",
      "explanation": "To exclude a virtual machine (VM) from agentless scanning in Microsoft Defender for Cloud, you can apply an Azure resource tag that disables this feature. This is consistent with Microsoft’s recommendation to use tags for configuration control.\n\nReference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/agentless-scanning"
    },
    {
      "type": "multiple_choice",
      "question": "Case study -\n\nThis is a case study. Case studies are not timed separately. You can use as much exam time as you would like to complete each case. However, there may be additional case studies and sections on this exam. You must manage your time to ensure that you are able to complete all questions included in this exam in the time provided.\n\nTo answer the questions included in a case study, you will need to reference information that is provided in the case study. Case studies might contain exhibits and other resources that provide more information about the scenario that is described in the case study. Each question is independent of the other questions in this case study.\n\nAt the end of this case study, a review screen will appear. This screen allows you to review your answers and to make changes before you move to the next section of the exam. After you begin a new section, you cannot return to this section.\n\nTo start the case study -\nTo display the first question in this case study, click the Next button. Use the buttons in the left pane to explore the content of the case study before you answer the questions. Clicking these buttons displays information such as business requirements, existing environment, and problem statements. If the case study has an All Information tab, note that the information displayed is identical to the information displayed on the subsequent tabs. When you are ready to answer a question, click the Question button to return to the question.\n\nOverview -\n\nAdatum Corporation is a United States-based financial services company that has regional offices in New York, Chicago, and San Francisco.\n\nExisting Environment -\n\nIdentity Environment -\n\nThe on-premises network contains an Active Directory Domain Services (AD DS) forest named corp.adatum.com that syncs with an Azure AD tenant named adatum.com. All user and group management tasks are performed in corp.adatum.com. The corp.adatum.com domain contains a group named Group1 that syncs with adatum.com.\n\nLicensing Status -\n\nAll the users at Adatum are assigned a Microsoft 365 ES license and an Azure Active Directory Premium P2 license.\n\nCloud Environment -\n\nThe cloud environment contains a Microsoft 365 subscription, an Azure subscription linked to the adatum.com tenant, and the resources shown in the following table:\n\n| Name      | Type                             | Description                                               |\n|-----------|----------------------------------|-----------------------------------------------------------|\n| Sentinel1 | Microsoft Sentinel workspace     | Includes a custom hunting query named HuntingQuery1       |\n| Server2   | Azure virtual machine            | Runs Windows Server 2022                                  |\n\nOn-premises Environment -\n\nThe on-premises network contains the resources shown in the following table:\n\n| Name      | Type                 | Description                                                                                       |\n|-----------|----------------------|---------------------------------------------------------------------------------------------------|\n| Server1   | Server               | Runs Windows Server 2019. Has Azure Arc-enabled and the Azure Monitor agent installed              |\n| Webapp1   | Web service          | An on-premises, public-facing HTTP/HTTPS web service that generates JSON output in response to GET HTTP requests |\n| Infoblox1 | Infoblox DNS service | A third-party DNS service appliance linked to Sentinel1 by using a data connector                 |\n\nRequirements -\n\nPlanned changes -\n\nAdatum plans to perform the following changes:\n• Implement a query named rulequery1 that will include a KQL query.\n• Implement a Microsoft Sentinel scheduled rule that generates incidents based on rulequery1.\n\nMicrosoft Defender for Cloud Requirements:\n• The members of Group1 must be able to enable Defender for Cloud plans and apply regulatory compliance initiatives.\n• Microsoft Defender for Servers Plan 2 must be enabled on all the Azure virtual machines.\n• Server2 must be excluded from agentless scanning.\n\nMicrosoft Sentinel Requirements:\n• Implement an ASIM query to return a count of DNS requests resulting in NXDOMAIN from Infoblox1.\n• Consolidate alerts from rulequery1 into a single incident if launched multiple times.\n• Configure the AMA connector for Windows Security logs on Server1.\n• Automatically close incidents triggered by rulequery1 for SecOps team activity.\n• Implement a workbook named Workbook1 that pulls data dynamically from Webapp1.\n• Implement a near-real-time rule for break glass account sign-ins.\n• Automatically run HuntingQuery1 when the Hunting page is accessed.\n• Detect abnormal volumes of password resets.\n• Minimize overhead in ASIM parser usage.\n• Ensure Group1 can manage playbooks.\n• Use built-in ASIM parsers where possible.\n\nBusiness Requirements:\n• Apply the principle of least privilege.\n• Minimize administrative effort.\n\nYou need to implement the Defender for Cloud requirements.\n\nWhich subscription-level role should you assign to Group1?",
      "options": [
        "A. Security Assessment Contributor",
        "B. Contributor",
        "C. Security Admin",
        "D. Owner"
      ],
      "answer": [
        "D"
      ],
      "image": "Images/hotspot35.png",
      "explanation": "To meet the Defender for Cloud requirement of enabling plans and applying compliance initiatives, Group1 must be assigned the 'Owner' role at the subscription level. This role provides full access to all resources, including the ability to delegate access to others.\n\nReference: https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#owner"
    },
    {
      "type": "multiple_choice",
      "question": "You provision Azure Sentinel for a new Azure subscription.\nYou are configuring the Security Events connector.\nWhile creating a new rule from a template in the connector, you decide to generate a new alert for every event.\nYou create the following rule query.\n\nBy which two components can you group alerts into incidents? Each correct answer presents a complete solution.\nNOTE: Each correct selection is worth one point.",
      "options": [
        "A. user",
        "B. resource group",
        "C. IP address",
        "D. computer"
      ],
      "answer": [
        "A",
        "D"
      ],
      "image": "Images/hotspot39.png",
      "explanation": "In Azure Sentinel, alerts can be grouped into incidents based on key entities such as 'user' and 'computer'. This helps correlate events tied to the same actor or machine, providing a clearer incident view.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/tutorial-detect-threats-custom"
    },
    {
      "type": "drag_and_drop",
      "question": "You have an Azure subscription that has Azure Defender enabled for all supported resource types.\n\n        You create an Azure logic app named LA1.\n\n        You plan to use LA1 to automatically remediate security risks detected in Azure Security Center.\n\n        You need to test LA1 in Security Center.\n\n        What should you do? To answer, select the appropriate options in the answer area.\n\n        NOTE: Each correct selection is worth one point.",
      "options": [
        "When an Azure Security Center Recommendation is created or triggered",
        "When Azure security center alert is created or triggered",
        "When a response to an azure security center alert is triggered",
        "recommendations",
        "workflow automation",
        "security alerts"
      ],
      "answer": [
        "When Azure security center alert is created or triggered",
        "workflow automation"
      ],
      "explanation": "To test a Logic App that is intended to remediate issues detected by Azure Security Center, you should:\n\n        → Use the trigger: 'When Azure security center alert is created or triggered' – this ensures the Logic App runs in response to a security alert.\n\n        → Use 'workflow automation' in Security Center – this is the feature used to connect Logic Apps to alert-triggered workflows.\n\n        This setup allows real-time testing and response via Logic Apps.\n\n        Reference: https://learn.microsoft.com/en-us/azure/security-center/workflow-automation",
      "image": "Images/hotspot13.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have resources in Azure and Google Cloud.\nYou need to ingest Google Cloud Platform (GCP) data into Azure Defender.\nIn which order should you perform the actions? To answer, move all actions from the list of actions to the answer area and arrange them in the correct order.\nSelect and Place:",
      "options": [
        "Configure the GCP Security Command Center",
        "Enable Security health analytics",
        "Enable the GCP Security command center API",
        "Create a a dedicated Private key",
        "From Azure Security Center add cloud connectors"
      ],
      "answer": [
        "Configure the GCP Security Command Center",
        "Enable Security health analytics",
        "Enable the GCP Security command center API",
        "Create a a dedicated Private key",
        "From Azure Security Center add cloud connectors"
      ],
      "explanation": "To integrate GCP data into Microsoft Defender for Cloud, the correct steps are as follows:\n1. Configure the GCP Security Command Center – This sets up the security framework for GCP monitoring.\n2. Enable Security Health Analytics – Enables essential analytics for threat detection in GCP.\n3. Enable the GCP Security Command Center API – Required for exporting data to external platforms.\n4. Create a dedicated Private key – Used for authentication by Defender for Cloud when accessing GCP data.\n5. From Azure Security Center add cloud connectors – Establishes the connection and completes the integration.\nReference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/gcp-onboarding",
      "image": "Images/hotspot14.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You need to use an Azure Resource Manager template to create a workflow automation that will trigger an automatic remediation when specific security alerts are received by Azure Security Center.\nHow should you complete the portion of the template that will provision the required Azure resources? To answer, select the appropriate options in the answer area.\nNOTE: Each correct selection is worth one point.",
      "options": [
        "Microsoft Automation",
        "Microsoft Logic",
        "Microsoft Security"
      ],
      "answer": [
        "Microsoft Security",
        "Microsoft Logic"
      ],
      "explanation": "When defining an ARM template for a security alert workflow automation:\n- The first resource namespace is Microsoft.Security to define the security automation.\n- The second is Microsoft.Logic to connect it to a Logic App that performs remediation.\nReference: https://docs.microsoft.com/en-us/azure/security-center/quickstart-automation-alert",
      "image": "Images/hotspot15.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You manage the security posture of an Azure subscription that contains two virtual machines named vm1 and vm2.\n\n        The secure score in Azure Security Center is shown in the Security Center exhibit. (Click the Security Center tab.)\n\n        \nAzure Policy assignments are configured as shown in the Policies exhibit. (Click the Policies tab.)\n\n        \nFor each of the following statements, select Yes if the statement is true. Otherwise, select No.\n\n        NOTE: Each correct selection is worth one point.",
      "options": [
        "Both virtual machines have inbound rules that allow access from either Any or Internet ranges | Yes",
        "Both virtual machines have inbound rules that allow access from either Any or Internet ranges | No",
        "Both virtual machines have management ports exposed directly to the internet | Yes",
        "Both virtual machines have management ports exposed directly to the internet | No",
        "If you enable just-in-time network access controls on all virtual machines, you will increase the secure score by four point | Yes",
        "If you enable just-in-time network access controls on all virtual machines, you will increase the secure score by four point | No"
      ],
      "answer": [
        "Both virtual machines have inbound rules that allow access from either Any or Internet ranges | Yes",
        "Both virtual machines have management ports exposed directly to the internet | No",
        "If you enable just-in-time network access controls on all virtual machines, you will increase the secure score by four point | Yes"
      ],
      "explanation": "• The Secure Score UI indicates that both VMs have insecure inbound access (from Any or Internet), so the first statement is **Yes**.\n\n• There is only one recommendation about management ports being open, so not both are affected—this makes the second statement **No**.\n\n• Just-in-time (JIT) access typically contributes 2 points per VM, so applying JIT to both VMs increases the secure score by 4 points — this makes the third statement **Yes**.\n\nReference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/secure-score-security-controls# just-in-time-vm-access",
      "image": "Images/hotspot16.jpg"
    },
    {
      "type": "drag_and_drop",
      "question": "You are informed of a new common vulnerabilities and exposures (CVE) vulnerability that affects your environment.\n\n        You need to use Microsoft Defender Security Center to request remediation from the team responsible for the affected systems if there is a documented active exploit available.\n\n        Which three actions should you perform in sequence? To answer, move the appropriate actions from the list of actions to the answer area and arrange them in the correct order.\n\n        Select and Place:",
      "options": [
        "From Device Inventory, search for the CVE.",
        "Open the Threat Protection report.",
        "From Threat & Vulnerability Management, select Weaknesses, and search for the CVE.",
        "From Advanced hunting, search for CveId in the DeviceTvmSoftwareInventoryVulnerabilities table.",
        "Create the remediation request.",
        "Select Security recommendations."
      ],
      "answer": [
        "From Threat & Vulnerability Management, select Weaknesses, and search for the CVE.",
        "Select Security recommendations.",
        "Create the remediation request."
      ],
      "explanation": "To remediate a CVE using Microsoft Defender for Endpoint (Security Center):\n\n1. **Search for the CVE in Weaknesses** within the Threat & Vulnerability Management dashboard to locate affected devices and assess exposure.\n2. **Select the corresponding security recommendation** that Defender for Endpoint provides based on the CVE's context.\n3. **Create a remediation request** directly from the recommendation to assign and track remediation tasks across responsible teams.\n\nThis structured approach ensures remediation actions are based on Defender's insight and automation capabilities.\n\nReference: https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/remediation?view=o365-worldwide",
      "image": "Images/hotspot17.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have an Azure Storage account that will be accessed by multiple Azure Function apps during the development of an application.\n\n        You need to hide Azure Defender alerts for the storage account.\n\n        Which entity type and field should you use in a suppression rule? To answer, select the appropriate options in the answer area.\n\n        NOTE: Each correct selection is worth one point.",
      "options": [
        "IP address",
        "Azure Resource",
        "Host",
        "User account",
        "Name",
        "Resource Id",
        "Address",
        "Command line"
      ],
      "answer": [
        "Azure Resource",
        "Resource Id"
      ],
      "explanation": "To suppress alerts in Microsoft Defender for Cloud (formerly Azure Security Center) for a specific resource like an Azure Storage account, you create a suppression rule.\n\n- The **entity type** should be **Azure Resource** because you're targeting a specific Azure service.\n- The **field** should be **Resource Id**, which uniquely identifies the Azure Storage account within the subscription.\n\nReference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/alerts-suppression-rules",
      "image": "Images/hotspot18.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have an Azure Functions app that generates thousands of alerts in Azure Security Center each day for normal activity.\n\n        You need to hide the alerts automatically in Security Center.\n\n        Which three actions should you perform in sequence in Security Center? Each correct answer presents part of the solution.\n\n        NOTE: Each correct selection is worth one point.\n\n        Select and Place:",
      "options": [
        "Select Pricing & settings.",
        "Select IP as the entity type and specify the IP address.",
        "Select Azure Resource as the entity type and specify the Resource ID.",
        "Select Security policy.",
        "Select Security alerts.",
        "Select Suppression rules, and then select Create new suppression rule."
      ],
      "answer": [
        "Select Security alerts.",
        "Select Suppression rules, and then select Create new suppression rule.",
        "Select Azure Resource as the entity type and specify the Resource ID."
      ],
      "explanation": "To automatically suppress specific types of alerts for a known source in Azure Security Center (now Microsoft Defender for Cloud):\n\n1. **Select Security alerts** – You start by navigating to existing alerts to identify the noisy alert type.\n2. **Select Suppression rules, and then select Create new suppression rule** – You initiate the creation of a rule to hide future instances of this alert.\n3. **Select Azure Resource as the entity type and specify the Resource ID** – Since the alerts are coming from a known Azure Functions app, you use the resource's unique identifier to target it specifically.\n\nReference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/alerts-suppression-rules",
      "image": "Images/hotspot19.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have an Azure subscription.\n\n         You need to delegate permissions to meet the following requirements:\n\n         ✑ Enable and disable Azure Defender.\n\n        ✑ Apply security recommendations to resources.\n\n        The solution must use the principle of least privilege.\n\n         Which Azure Security Center role should you use for each requirement? To answer, drag the appropriate roles to the correct requirements. Each role may be used once, more than once, or not at all. You may need to drag the split bar between panes or scroll to view content.\n\n        NOTE: Each correct selection is worth one point.\n\n        Select and Place:",
      "options": [
        "Security Admin",
        "Resource Group Owner",
        "Subscription Contributor",
        "Subscription Owner"
      ],
      "answer": [
        "Security Admin",
        "Subscription Contributor"
      ],
      "explanation": "To meet the least privilege model:\n\n- **Enable and disable Azure Defender** requires **Security Admin** role because it grants permissions to manage security policies including enabling/disabling Defender plans.\n- **Apply security recommendations** requires the **Subscription Contributor** role, which allows making changes to Azure resources in a subscription.\n\nReference: https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles# security-admin",
      "image": "Images/hotspot20.jpg"
    },
    {
      "type": "drag_and_drop",
      "question": "You have an Azure subscription that uses Azure Defender.\n\n    You plan to use Azure Security Center workflow automation to respond to Azure Defender threat alerts.\n\n    You need to create an Azure policy that will perform threat remediation automatically.\n\n    What should you include in the solution? To answer, select the appropriate options in the answer area.\n\n    NOTE: Each correct selection is worth one point.",
      "options": [
        "Append",
        "DeployIfNotExists",
        "EnforceRegoPolicy",
        "An Azure Automation runbook that has a webhook",
        "An Azure Logic Apps app that has the trigger set to When an Azure Security Center Alert is created or triggered",
        "An Azure Logic Apps app that has the trigger set to When a response to an Azure Security Center alert is triggered"
      ],
      "answer": [
        "DeployIfNotExists",
        "An Azure Logic Apps app that has the trigger set to When an Azure Security Center Alert is created or triggered"
      ],
      "explanation": "To automate remediation of threats detected by Azure Defender using Azure Security Center workflow automation:\n\n- **DeployIfNotExists** is the correct policy effect used in Azure Policy when you want to ensure a resource exists and can trigger deployment of supporting components if it's missing.\n- **An Azure Logic Apps app with the trigger set to 'When an Azure Security Center Alert is created or triggered'** is required to act on threat alerts automatically.\n\nReference: https://learn.microsoft.com/en-us/azure/security-center/workflow-automation",
      "image": "Images/hotspot21.jpg"
    },
    {
      "type": "drag_and_drop",
      "question": "You have an on-premises datacenter that contains a custom web app named App1. App1 uses Active Directory Domain Services (AD DS) authentication and is accessible by using Microsoft Entra application proxy.\n\nYou have a Microsoft 365 E5 subscription that uses Microsoft Defender XDR.\n\nYou receive an alert that a user downloaded highly confidential documents.\n\nYou need to remediate the risk associated with the alert by requiring multi-factor authentication (MFA) when users use App1 to initiate the download of documents that have a Highly Confidential sensitivity label applied.\n\nWhat should you do? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "Conditional Access",
        "Microsoft Entra Domain Services",
        "Microsoft Entra ID Protection",
        "Microsoft Defender for Cloud Apps",
        "Microsoft Defender for Identity",
        "Microsoft Defender for Office 365"
      ],
      "answer": [
        "Conditional Access",
        "Microsoft Defender for Cloud Apps"
      ],
      "explanation": "To enforce MFA based on sensitivity label and app access:\n\n- **Microsoft Defender for Cloud Apps** enables session control and inspection of activity (like file downloads) in real-time. You can apply conditional session controls based on file sensitivity labels.\n- **Conditional Access** policies are required to define access conditions (e.g., apply MFA) for users accessing App1 via Entra application proxy.\n\nReference: https://learn.microsoft.com/en-us/defender-cloud-apps/session-policy\nReference: https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-conditional-access",
      "image": "Images/hotspot22.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have an Azure subscription. The subscription contains 10 virtual machines that are onboarded to Microsoft Defender for Cloud.\n\n    You need to ensure that when Defender for Cloud detects digital currency mining behavior on a virtual machine, you receive an email notification. The solution must generate a test email.\n\n    Which three actions should you perform in sequence? To answer, move the appropriate actions from the list of actions to the answer area and arrange them in the correct order.\n\n    Select and Place:",
      "options": [
        "From Workflow automation in Defender for Cloud, change the status of the workflow automation.",
        "From Logic App Designer, run a trigger.",
        "From Security alerts in Defender for Cloud, create a sample alert.",
        "From Logic App Designer, create a logic app.",
        "From Workflow automation in Defender for Cloud, add a workflow automation."
      ],
      "answer": [
        "From Logic App Designer, create a logic app.",
        "From Logic App Designer, run a trigger.",
        "From Workflow automation in Defender for Cloud, add a workflow automation."
      ],
      "explanation": "To receive notifications for specific Defender for Cloud alerts:\n\n1. **Create a logic app** using the Logic App Designer to define the email notification behavior.\n2. **Run a trigger** in Logic Apps to test and validate the notification logic.\n3. **Add a workflow automation** in Defender for Cloud to link security alerts like crypto mining detection to the logic app.\n\nReference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/workflow-automation",
      "image": "Images/hotspot23.jpg"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft subscription that has Microsoft Defender for Cloud enabled.\n\n\n    You configure the Azure logic apps shown in the following table.\n\n\n    Name: LogicApp1 | Trigger: When Defender for Cloud recommendation is created or triggered | Action: Send Email\n\n    Name: LogicApp2 | Trigger: When Defender for Cloud alert is created or triggered | Action: Send Email\n\n\n    You need to configure an automatic action that will run if a **Suspicious process executed** alert is triggered.\n\n    The solution must minimize administrative effort.\n\n\n    Which three actions should you perform in sequence? To answer, move the appropriate actions from the list of actions to the answer area and arrange them in the correct order.",
      "options": [
        "Configure the Mitigate the threat settings.",
        "Configure the Suppress similar alerts settings.",
        "Filter by alert title.",
        "Configure the Trigger automated response settings.",
        "Configure the Prevent future attacks settings.",
        "Select Take action."
      ],
      "answer": [
        "Select Take action.",
        "Configure the Prevent future attacks settings.",
        "Configure the Trigger automated response settings."
      ],
      "explanation": "To automatically trigger a response when a specific alert like 'Suspicious process executed' is raised, follow these steps:\n\n1. **Select Take action** – This opens the alert management interface.\n2. **Configure the Prevent future attacks settings** – This area is used to define proactive remediation steps.\n3. **Configure the Trigger automated response settings** – This links the alert to a logic app like LogicApp2, allowing an automatic action (e.g., send email) to be triggered.\n\nThis method ensures minimal administrative overhead and leverages existing automation.\n\nReference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/alerts-automate-response",
      "image": "Images/hotspot24.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have 50 on-premises servers.\n\n    You have an Azure subscription that uses Microsoft Defender for Cloud. The Defender for Cloud deployment has Microsoft Defender for Servers and automatic provisioning enabled.\n\n    You need to configure Defender for Cloud to support the on-premises servers. The solution must meet the following requirements:\n\n    • Provide threat and vulnerability management.\n    • Support data collection rules.\n\n    Which three actions should you perform in sequence? To answer, move the appropriate actions from the list of actions to the answer area and arrange them in the correct order.",
      "options": [
        "From the Add servers with Azure Arc settings in the Azure portal, generate an installation script.",
        "From the Data controller settings in the Azure portal, create an Azure Arc data controller.",
        "On the on-premises servers, install the Log Analytics agent.",
        "On the on-premises servers, install the Azure Connected Machine agent.",
        "On the on-premises servers, install the Azure Monitor agent."
      ],
      "answer": [
        "From the Add servers with Azure Arc settings in the Azure portal, generate an installation script.",
        "On the on-premises servers, install the Azure Connected Machine agent.",
        "On the on-premises servers, install the Azure Monitor agent."
      ],
      "explanation": "To onboard on-premises servers for Microsoft Defender for Cloud, follow these steps:\n\n    1. Generate the installation script via Azure Arc settings to configure proper onboarding.\n    2. Install the Azure Connected Machine agent on the servers to connect them to Azure Arc.\n    3. Install the Azure Monitor agent, which supports data collection rules and Defender for Cloud features such as threat and vulnerability management.\n\n    Reference: https://learn.microsoft.com/en-us/azure/azure-arc/servers/onboard-service-principal",
      "image": "Images/hotspot25.png"
    },
    {
      "type": "drag_and_drop",
      "question": "You have an Azure subscription that uses Microsoft Defender for Cloud and contains an Azure logic app named app1.\n\nYou need to ensure that app1 launches when a specific Defender for Cloud security alert is generated.\nHow should you complete the Azure Resource Manager (ARM) template? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "Microsoft.Automation/automationAccounts",
        "Microsoft.Logic/workflows",
        "Microsoft.Security/automations",
        "Actions",
        "Contents",
        "Triggers"
      ],
      "answer": [
        "Microsoft.Security/automations",
        "Triggers"
      ],
      "image": "Images/hotspot26.png",
      "explanation": "**Explanation:**\nTo automatically trigger a Logic App from a Microsoft Defender for Cloud alert, you must configure an automation rule using the correct resource type and section:\n\n- `Microsoft.Security/automations` is the correct resource type for defining automation rules in ARM templates that respond to security alerts.\n- `Triggers` is the key section in the ARM template that specifies what conditions will cause the automation to fire (i.e., when a specific alert is generated).\n\n**Reference:**\nhttps://learn.microsoft.com/en-us/azure/defender-for-cloud/alerts-logic-apps"
    },
    {
      "type": "drag_and_drop",
      "question": "You have an Azure subscription that has Microsoft Defender for Cloud enabled for all supported resource types.\n\nYou create an Azure logic app named LA1.\n\nYou plan to use LA1 to automatically remediate security risks detected in Defender for Cloud.\n\nYou need to test LA1 in Defender for Cloud.\n\nWhat should you do? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "When a Defender for Cloud Recommendation is created or triggered",
        "When a Defender for Cloud Alert is created or triggered",
        "When a response to a Defender for Cloud alert is triggered",
        "Recommendations",
        "Security alerts",
        "Regulatory compliance standards"
      ],
      "answer": [
        "When a Defender for Cloud Recommendation is created or triggered",
        "Regulatory compliance standards"
      ],
      "image": "Images/hotspot27.png",
      "explanation": "**Explanation:**\nTo test a Logic App such as LA1 for automated remediation in Microsoft Defender for Cloud, you use:\n\n- **'When a Defender for Cloud Recommendation is created or triggered'** as the trigger to test remediation based on a security recommendation event.\n- **'Regulatory compliance standards'** are reviewed to determine which recommendations and policies apply.\n\nThis setup ensures the Logic App is activated under realistic policy and compliance conditions for testing purposes.\n\n**Reference:**\nhttps://learn.microsoft.com/en-us/azure/defender-for-cloud/automation-response"
    },
    {
      "type": "drag_and_drop",
      "question": "You create a new Azure subscription and start collecting logs for Azure Monitor.\n\nYou need to validate that Microsoft Defender for Cloud will trigger an alert when a malicious file is present on an Azure virtual machine running Windows Server.\n\nWhich three actions should you perform in a sequence? To answer, move the appropriate actions from the list of action to the answer area and arrange them in the correct order.\n\nNOTE: More than one order of answer choices is correct. You will receive credit for any of the correct orders you select.",
      "options": [
        "Rename the executable file as AlertTest.exe.",
        "Copy an executable file on a virtual machine and rename the file as ASC_AlertTest_662jfi039N.exe.",
        "Change the alert severity threshold for emails to Medium.",
        "Run the executable file and specify the appropriate arguments.",
        "Change the alert severity threshold for emails to Low.",
        "Enable Microsoft Defender for Cloud's enhanced security features for the subscription."
      ],
      "answer": [
        "Change the alert severity threshold for emails to Low.",
        "Copy an executable file on a virtual machine and rename the file as ASC_AlertTest_662jfi039N.exe.",
        "Run the executable file and specify the appropriate arguments."
      ],
      "image": "Images/hotspot28.png",
      "explanation": "**Explanation:**\nTo trigger an alert in Microsoft Defender for Cloud for validation purposes:\n\n1. **Change the alert severity threshold for emails to Low** – ensures even low-severity test alerts are visible.\n2. **Copy an executable file on a virtual machine and rename the file as ASC_AlertTest_662jfi039N.exe** – this is a known pattern recognized by Defender.\n3. **Run the executable file and specify the appropriate arguments** – this triggers the behavior for alert testing.\n\nThis process mimics a threat scenario and allows validation of alert mechanisms in Microsoft Defender for Cloud.\n\n**Reference:**\nhttps://learn.microsoft.com/en-us/azure/defender-for-cloud/alerts-validation"
    },
    {
      "type": "drag_and_drop",
      "question": "You have an Azure subscription that uses Microsoft Defender for Cloud.\n\nYou create a Google Cloud Platform (GCP) organization named GCP1.\n\nYou need to onboard GCP1 to Defender for Cloud by using the native cloud connector. The solution must ensure that all future GCP projects are onboarded automatically.\n\nWhat should you include in the solution? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "A management group and an Azure AD service principal",
        "A management project and a custom role",
        "An Azure AD administrative unit and a managed identity",
        "Deploying a Bicep template",
        "Running a script in Azure Cloud Shell",
        "Running a script in GCP Cloud Shell"
      ],
      "answer": [
        "A management project and a custom role",
        "Running a script in GCP Cloud Shell"
      ],
      "image": "Images/hotspot29.png",
      "explanation": "**Explanation:**\nTo onboard a Google Cloud Platform (GCP) organization to Microsoft Defender for Cloud using the native connector, you must first configure a **management project and custom role** in GCP, which allows Defender for Cloud to monitor and secure GCP resources.\n\nThen, you must **run a script in GCP Cloud Shell** to create and configure the necessary resources (such as service accounts, roles, and APIs).\n\nThis approach ensures that all current and future GCP projects are onboarded automatically.\n\n**Reference:**\nhttps://learn.microsoft.com/en-us/azure/defender-for-cloud/quickstart-onboard-gcp"
    },
    {
      "type": "drag_and_drop",
      "question": "Case study\n-\n\nThis is a case study. Case studies are not timed separately. You can use as much exam time as you would like to complete each case. However, there may be additional case studies and sections on this exam. You must manage your time to ensure that you are able to complete all questions included in this exam in the time provided.\n\nTo answer the questions included in a case study, you will need to reference information that is provided in the case study. Case studies might contain exhibits and other resources that provide more information about the scenario that is described in the case study. Each question is independent of the other questions in this case study.\n\nAt the end of this case study, a review screen will appear. This screen allows you to review your answers and to make changes before you move to the next section of the exam. After you begin a new section, you cannot return to this section.\n\nTo start the case study\n-\nTo display the first question in this case study, click the Next button. Use the buttons in the left pane to explore the content of the case study before you answer the questions. Clicking these buttons displays information such as business requirements, existing environment, and problem statements. If the case study has an All Information tab, note that the information displayed is identical to the information displayed on the subsequent tabs. When you are ready to answer a question, click the Question button to return to the question.\n\nOverview\n-\n\nFabrikam, Inc. is a financial services company.\n\nThe company has branch offices in New York, London, and Singapore. Fabrikam has remote users located across the globe. The remote users access company resources, including cloud resources, by using a VPN connection to a branch office.\n\nExisting Environment\n-\n\nIdentity Environment\n-\n\nThe network contains an Active Directory Domain Services (AD DS) forest named fabrikam.com that syncs with an Azure AD tenant named fabrikam.com. To sync the forest, Fabrikam uses Azure AD Connect with pass-through authentication enabled and password hash synchronization disabled.\n\nThe fabrikam.com forest contains two global groups named Group1 and Group2.\n\nMicrosoft 365 Environment\n-\n\nAll the users at Fabrikam are assigned a Microsoft 365 E5 license and an Azure Active Directory Premium Plan 2 license.\n\nFabrikam implements Microsoft Defender for Identity and Microsoft Defender for Cloud Apps and enables log collectors.\n\nAzure Environment\n-\n\nFabrikam has an Azure subscription that contains the resources shown in the following table.\n\n| Name      | Type                              | Description                                                                                         |\n|-----------|-----------------------------------|-----------------------------------------------------------------------------------------------------|\n| App1      | Azure logic app                   | To automate incident generation in an internal ticketing system, the SecOps team invokes App1 using an HTTP endpoint. |\n| SAWkspc1  | Azure Synapse Analytics workspace | SAWkspc1 hosts an Apache Spark pool named Pool1.                                                    |\n| LAWkspc1  | Log Analytics workspace           | LAWkspc1 will be used in a planned Microsoft Sentinel implementation.                              |\n\nAmazon Web Services (AWS) Environment\n\nFabrikam has an Amazon Web Services (AWS) account named Account1. Account1 contains 100 Amazon Elastic Compute Cloud (EC2) instances that run a custom Windows Server 2022. The image includes Microsoft SQL Server 2019 and does NOT have any agents installed.\n\nCurrent Issues\n-\n\nWhen the users use the VPN connections, Microsoft 365 Defender raises a high volume of impossible travel alerts that are false positives.\nDefender for Identity raises a high volume of Suspected DCSync attack alerts that are false positives.\n\nRequirements\n-\n\nPlanned changes\n-\n\nFabrikam plans to implement the following services:\n• Microsoft Defender for Cloud\n• Microsoft Sentinel\n\nBusiness Requirements\n-\n\nFabrikam identifies the following business requirements:\n• Use the principle of least privilege, whenever possible.\n• Minimize administrative effort.\n\nMicrosoft Defender for Cloud Apps Requirements\n\nFabrikam identifies the following Microsoft Defender for Cloud Apps requirements:\n• Ensure that impossible travel alert policies are based on the previous activities of each user.\n• Reduce the amount of impossible travel alerts that are false positives.\n\nMicrosoft Defender for Identity Requirements\n\nMinimize the administrative effort required to investigate the false positive alerts.\n\nMicrosoft Defender for Cloud Requirements\n\nFabrikam identifies the following Microsoft Defender for Cloud requirements:\n• Ensure that the members of Group2 can modify security policies.\n• Ensure that the members of Group1 can assign regulatory compliance policy initiatives at the Azure subscription level.\n• Automate the deployment of the Azure Connected Machine agent for Azure Arc-enabled servers to the existing and future resources of Account1.\n• Minimize the administrative effort required to investigate the false positive alerts.\n\nMicrosoft Sentinel Requirements\n\nFabrikam identifies the following Microsoft Sentinel requirements:\n• Query for NXDOMAIN DNS requests from the last seven days by using built-in Advanced Security Information Model (ASIM) unifying parsers.\n• From AWS EC2 instances, collect Windows Security event log entries that include local group membership changes.\n• Identify anomalous activities of Azure AD users by using User and Entity Behavior Analytics (UEBA).\n• Evaluate the potential impact of compromised Azure AD user credentials by using UEBA.\n• Ensure that App1 is available for use in Microsoft Sentinel automation rules.\n• Identify the mean time to triage for incidents generated during the last 30 days.\n• Identify the mean time to close incidents generated during the last 30 days.\n• Ensure that the members of Group1 can create and run playbooks.\n• Ensure that the members of Group1 can manage analytics rules.\n• Run hunting queries on Pool1 by using Jupyter notebooks.\n• Ensure that the members of Group2 can manage incidents.\n• Maximize the performance of data queries.\n• Minimize the amount of collected data.\n\nYou need to meet the Microsoft Defender for Cloud Apps requirements.\n\nWhat should you do? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "Low",
        "Medium",
        "High",
        "Add IP address ranges.",
        "Enable leaked credential detection.",
        "Disable leaked credential detection."
      ],
      "answer": [
        "Low",
        "Add IP address ranges."
      ],
      "image": "Images/hotspot30.png",
      "explanation": "**Explanation:**\nTo reduce false positives for impossible travel alerts and base them on previous user activity, Microsoft recommends:\n\n- Setting the sensitivity level of the alert policy to **Low** to reduce noise.\n- Adding **IP address ranges** (such as VPN IPs) to mark trusted locations and suppress irrelevant alerts.\n\n**Reference:**\nhttps://learn.microsoft.com/en-us/defender-cloud-apps/policy-impossible-travel"
    },
    {
      "type": "drag_and_drop",
      "question": "Case study\n-\n\nThis is a case study. Case studies are not timed separately. You can use as much exam time as you would like to complete each case. However, there may be additional case studies and sections on this exam. You must manage your time to ensure that you are able to complete all questions included in this exam in the time provided.\n\nTo answer the questions included in a case study, you will need to reference information that is provided in the case study. Case studies might contain exhibits and other resources that provide more information about the scenario that is described in the case study. Each question is independent of the other questions in this case study.\n\nAt the end of this case study, a review screen will appear. This screen allows you to review your answers and to make changes before you move to the next section of the exam. After you begin a new section, you cannot return to this section.\n\nTo start the case study\n-\nTo display the first question in this case study, click the Next button. Use the buttons in the left pane to explore the content of the case study before you answer the questions. Clicking these buttons displays information such as business requirements, existing environment, and problem statements. If the case study has an All Information tab, note that the information displayed is identical to the information displayed on the subsequent tabs. When you are ready to answer a question, click the Question button to return to the question.\n\nOverview\n-\n\nFabrikam, Inc. is a financial services company.\n\nThe company has branch offices in New York, London, and Singapore. Fabrikam has remote users located across the globe. The remote users access company resources, including cloud resources, by using a VPN connection to a branch office.\n\nExisting Environment\n-\n\nIdentity Environment\n-\n\nThe network contains an Active Directory Domain Services (AD DS) forest named fabrikam.com that syncs with an Azure AD tenant named fabrikam.com. To sync the forest, Fabrikam uses Azure AD Connect with pass-through authentication enabled and password hash synchronization disabled.\n\nThe fabrikam.com forest contains two global groups named Group1 and Group2.\n\nMicrosoft 365 Environment\n-\n\nAll the users at Fabrikam are assigned a Microsoft 365 E5 license and an Azure Active Directory Premium Plan 2 license.\n\nFabrikam implements Microsoft Defender for Identity and Microsoft Defender for Cloud Apps and enables log collectors.\n\nAzure Environment\n-\n\nFabrikam has an Azure subscription that contains the resources shown in the following table.\n\n| Name      | Type                              | Description                                                                                         |\n|-----------|-----------------------------------|-----------------------------------------------------------------------------------------------------|\n| App1      | Azure logic app                   | To automate incident generation in an internal ticketing system, the SecOps team invokes App1 using an HTTP endpoint. |\n| SAWkspc1  | Azure Synapse Analytics workspace | SAWkspc1 hosts an Apache Spark pool named Pool1.                                                    |\n| LAWkspc1  | Log Analytics workspace           | LAWkspc1 will be used in a planned Microsoft Sentinel implementation.                              |\n\nAmazon Web Services (AWS) Environment\n\nFabrikam has an Amazon Web Services (AWS) account named Account1. Account1 contains 100 Amazon Elastic Compute Cloud (EC2) instances that run a custom Windows Server 2022. The image includes Microsoft SQL Server 2019 and does NOT have any agents installed.\n\nCurrent Issues\n-\n\nWhen the users use the VPN connections, Microsoft 365 Defender raises a high volume of impossible travel alerts that are false positives.\nDefender for Identity raises a high volume of Suspected DCSync attack alerts that are false positives.\n\nRequirements\n-\n\nPlanned changes\n-\n\nFabrikam plans to implement the following services:\n• Microsoft Defender for Cloud\n• Microsoft Sentinel\n\nBusiness Requirements\n-\n\nFabrikam identifies the following business requirements:\n• Use the principle of least privilege, whenever possible.\n• Minimize administrative effort.\n\nMicrosoft Defender for Cloud Requirements\n-\n\nFabrikam identifies the following Microsoft Defender for Cloud requirements:\n• Ensure that the members of Group2 can modify security policies.\n• Ensure that the members of Group1 can assign regulatory compliance policy initiatives at the Azure subscription level.\n• Automate the deployment of the Azure Connected Machine agent for Azure Arc-enabled servers to the existing and future resources of Account1.\n• Minimize the administrative effort required to investigate the false positive alerts.\n\nYou need to assign role-based access control (RBAC) roles to Group1 and Group2 to meet the Microsoft Defender for Cloud requirements and the business requirements.\n\nWhich role should you assign to each group? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "Contributor",
        "Owner",
        "Security Admin",
        "Security Assessment Contributor"
      ],
      "answer": [
        "Security Assessment Contributor",
        "Security Admin"
      ],
      "image": "Images/hotspot31.png",
      "explanation": "**Explanation:**\n- Group1 must assign regulatory compliance policy initiatives. This action is covered under the **Security Assessment Contributor** role.\n- Group2 must modify security policies, which is a function provided by the **Security Admin** role.\n\n**Reference:**\nhttps://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#security-admin\nhttps://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#security-assessment-contributor"
    },
    {
      "type": "drag_and_drop",
      "question": "You have an Azure subscription named Sub1 that uses Microsoft Defender for Cloud.\n\nYou have an Azure DevOps organization named AzDO1.\n\nYou need to integrate Sub1 and AzDO1. The solution must meet the following requirements:\n\n• Detect secrets exposed in pipelines by using Defender for Cloud.\n• Minimize administrative effort.\n\nWhat should you do? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "image": "Images/hotspot32.png",
      "options": [
        "Add an environment",
        "Configure workflow automation",
        "Enable a plan",
        "Configure OAuth",
        "Configure security policies",
        "Install an extension"
      ],
      "answer": [
        "Add an environment",
        "Install an extension"
      ],
      "explanation": "**Explanation:**\nTo integrate Azure DevOps with Microsoft Defender for Cloud and detect exposed secrets with minimal effort:\n1. You must **Add an environment** in Defender for Cloud to establish integration with the DevOps organization.\n2. Then **Install the Microsoft Defender for DevOps extension** in Azure DevOps to enable scanning for security issues, including secret exposure.\n\n**Reference:**\nhttps://learn.microsoft.com/en-us/azure/defender-for-cloud/defender-for-devops-introduction"
    },
    {
      "type": "drag_and_drop",
      "question": "You have an Azure subscription that uses Microsoft Defender for Cloud.\n\nYou need to create a workflow that will send a Microsoft Teams message to the IT department of your company when a new Microsoft Secure Score action is generated.\n\nWhich three actions should you perform in sequence? To answer, move the appropriate actions from the list of actions to the answer area and arrange them in the correct order.",
      "image": "Images/hotspot33.png",
      "options": [
        "Create an Azure logic app that includes the Defender for Cloud regulatory compliance assessment trigger.",
        "Configure workflow automation.",
        "Create an Azure logic app that includes the Defender for Cloud alert trigger.",
        "Create an Azure logic app that includes the Defender for Cloud recommendation trigger.",
        "Configure a trigger condition."
      ],
      "answer": [
        "Configure workflow automation.",
        "Create an Azure logic app that includes the Defender for Cloud alert trigger.",
        "Configure a trigger condition."
      ],
      "explanation": "**Explanation:**\nTo alert your IT department via Microsoft Teams when a new Secure Score action is generated in Microsoft Defender for Cloud:\n1. **Configure workflow automation** to define what type of alerts will trigger a workflow.\n2. **Create an Azure Logic App with a Defender for Cloud alert trigger** to listen for security alerts such as new secure score actions.\n3. **Configure a trigger condition** to filter for specific actions, like those related to Secure Score changes.\n\n**Reference:**\nhttps://learn.microsoft.com/en-us/azure/defender-for-cloud/alerts-trigger-logic-apps"
    },
    {
      "type": "drag_and_drop",
      "question": "You have an Azure subscription named Sub1 and an Azure DevOps organization named AzDO1. AzDO1 uses Defender for Cloud and contains a project that has a YAML pipeline named Pipeline1.\n\nPipeline1 outputs the details of discovered open source software vulnerabilities to Defender for Cloud.\n\nYou need to configure Pipeline to output the results of secret scanning to Defender for Cloud.\n\nWhat should you add to Pipeline1? To answer, select the appropriate options in the answer area.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "categories:",
        "inputs:",
        "outputs:"
      ],
      "answer": [
        "inputs:",
        "categories:"
      ],
      "image": "Images/hotspot34.png",
      "explanation": "To configure secret scanning integration with Microsoft Defender for Cloud in Azure DevOps pipelines, you need to declare the `inputs:` and `categories:` sections within the YAML pipeline definition. This enables Defender for Cloud to properly recognize and ingest secret scanning data during pipeline execution."
    },
    {
      "type": "drag_and_drop",
      "question": "You plan to connect an external solution that will send Common Event Format (CEF) messages to Azure Sentinel.\nYou need to deploy the log forwarder.\nWhich three actions should you perform in sequence? To answer, move the appropriate actions from the list of actions to the answer area and arrange them in the correct order.",
      "options": [
        "Deploy an OMS Gateway on the network.",
        "Set the syslog daemon to forward the events directly to Azure Sentinel.",
        "Configure the syslog daemon. Restart the syslog daemon and the Log Analytics agent.",
        "Download and install the Log Analytics agent.",
        "Set the Log Analytics agent to listen on port 25226 and forward the CEF messages to Azure Sentinel."
      ],
      "answer": [
        "Download and install the Log Analytics agent.",
        "Set the Log Analytics agent to listen on port 25226 and forward the CEF messages to Azure Sentinel.",
        "Configure the syslog daemon. Restart the syslog daemon and the Log Analytics agent."
      ],
      "image": "Images/hotspot36.png",
      "explanation": "To forward CEF logs from an external source to Azure Sentinel, you must:\n1. Install the Log Analytics agent.\n2. Configure the agent to listen on the correct port and receive CEF data.\n3. Adjust the syslog daemon to correctly forward logs to the agent.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/connect-common-event-format"
    },
    {
      "type": "drag_and_drop",
      "question": "From Azure Sentinel, you open the Investigation pane for a high-severity incident as shown in the following exhibit.\n\nUse the drop-down menus to select the answer choice that completes each statement based on the information presented in the graphic.\n\nNOTE: Each correct selection is worth one point.",
      "options": [
        "the inbound network security group (NSG) rules",
        "the last five Windows security log events",
        "the open ports on the host",
        "the running processes",
        "Entities",
        "Info",
        "Insights",
        "Timeline"
      ],
      "answer": [
        "the running processes",
        "Timeline"
      ],
      "image": "Images/hotspot37.jpg",
      "explanation": "Azure Sentinel’s Investigation pane provides interactive elements such as process trees and incident context. 'Running processes' are usually visible during investigation for host-related alerts, and 'Timeline' helps review the sequence of events.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/tutorial-investigate-cases"
    },
    {
      "type": "drag_and_drop",
      "question": "You have an Azure Sentinel deployment.\nYou need to query for all suspicious credential access activities.\nWhich three actions should you perform in sequence? To answer, move the appropriate actions from the list of actions to the answer area and arrange them in the correct order.\n\nSelect and Place:",
      "options": [
        "From Azure Sentinel, select Hunting.",
        "Select Run All Queries.",
        "Select New Query.",
        "Filter by tactics.",
        "From Azure Sentinel, select Notebooks."
      ],
      "answer": [
        "From Azure Sentinel, select Hunting.",
        "Filter by tactics.",
        "Select Run All Queries."
      ],
      "image": "Images/hotspot38.png",
      "explanation": "In Azure Sentinel, the Hunting feature enables threat analysts to proactively search for suspicious activities. Filtering by tactics like 'Credential Access' narrows the focus, and 'Run All Queries' executes them.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/hunting"
    },
    {
      "type": "drag_and_drop",
      "question": "Your company deploys Azure Sentinel.\nYou plan to delegate the administration of Azure Sentinel to various groups.\nYou need to delegate the following tasks:\n✑ Create and run playbooks\n✑ Create workbooks and analytic rules\n\nThe solution must use the principle of least privilege.\n\nWhich role should you assign for each task? To answer, drag the appropriate roles to the correct tasks. Each role may be used once, more than once, or not at all.\nNOTE: Each correct selection is worth one point.",
      "options": [
        "Azure Sentinel Contributor",
        "Azure Sentinel Responder",
        "Azure Sentinel Reader",
        "Logic App Contributor"
      ],
      "answer": [
        "Logic App Contributor",
        "Azure Sentinel Contributor"
      ],
      "image": "Images/hotspot40.png",
      "explanation": "To delegate responsibilities in line with the principle of least privilege:\n\n- **Logic App Contributor** should be assigned for playbook creation and execution, as it allows management of logic apps without broader permissions.\n- **Azure Sentinel Contributor** should be assigned for configuring analytics rules and creating workbooks, which requires contributor-level access in Sentinel.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/roles"
    },
    {
      "type": "drag_and_drop",
      "question": "You use Azure Sentinel to monitor irregular Azure activity.\nYou create custom analytics rules to detect threats as shown in the following exhibit.\n\nYou do NOT define any incident settings as part of the rule definition.\nUse the drop-down menus to select the answer choice that completes each statement based on the information presented in the graphic.\nNOTE: Each correct selection is worth one point.",
      "options": [
        "0 alerts",
        "1 alert",
        "2 alerts",
        "3 alerts"
      ],
      "answer": [
        "1 alert",
        "1 alert"
      ],
      "image": "Images/hotspot41.png",
      "explanation": "Each custom analytics rule without incident grouping or suppression logic will generate a separate alert for each detection.\nBased on the exhibit, two separate analytics rules each generate one alert independently.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/tutorial-detect-threats-custom"
    },
    {
      "type": "drag_and_drop",
      "question": "You deploy Azure Sentinel.\nYou need to implement connectors in Azure Sentinel to monitor Microsoft Teams and Linux virtual machines in Azure. The solution must minimize administrative effort.\nWhich data connector type should you use for each workload? To answer, select the appropriate options in the answer area.\nNOTE: Each correct selection is worth one point.",
      "options": [
        "Custom",
        "Office 365",
        "Security Events",
        "Syslog"
      ],
      "answer": [
        "Office 365",
        "Syslog"
      ],
      "image": "Images/hotspot42.jpg",
      "explanation": "To monitor Microsoft Teams activity in Azure Sentinel, the Office 365 connector is used, as Teams is a part of Microsoft 365.\nTo monitor Linux virtual machines, the Syslog connector is used to collect system logs efficiently.\n\nReference:\nhttps://learn.microsoft.com/en-us/azure/sentinel/connect-office-365\nhttps://learn.microsoft.com/en-us/azure/azure-monitor/agents/data-sources-syslog\n"
    },
    {
      "type": "drag_and_drop",
      "question": "You need to use an Azure Sentinel analytics rule to search for specific criteria in Amazon Web Services (AWS) logs and to generate incidents.\nWhich three actions should you perform in sequence? To answer, move the appropriate actions from the list of actions to the answer area and arrange them in the correct order.\nSelect and Place:",
      "options": [
        "Create a rule by using the Changes to Amazon VPC settings rule template",
        "From Analytics in Azure Sentinel, create a Microsoft incident creation rule",
        "Add the Amazon Web Services connector",
        "Set the alert logic",
        "From Analytics in Azure Sentinel, create a custom analytics rule that uses a scheduled query",
        "Select a Microsoft security service",
        "Add the Syslog connector"
      ],
      "answer": [
        "Add the Amazon Web Services connector",
        "From Analytics in Azure Sentinel, create a custom analytics rule that uses a scheduled query",
        "Set the alert logic"
      ],
      "image": "Images/hotspot43.jpg",
      "explanation": "To configure Azure Sentinel to generate incidents based on AWS logs, follow these steps:\n1. **Add the AWS connector** to ingest logs from your AWS environment.\n2. **Create a custom analytics rule** with a scheduled query to define the detection logic.\n3. **Set the alert logic** to determine how incidents are generated from alerts.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/connect-aws"
    },
    {
      "type": "drag_and_drop",
      "question": "You need to create a query for a workbook. The query must meet the following requirements:\n✑ List all incidents by incident number.\n✑ Only include the most recent log for each incident.\nHow should you complete the query? To answer, select the appropriate options in the answer area.\nNOTE: Each correct selection is worth one point.",
      "options": [
        "project",
        "sort",
        "summarize",
        "arg_max",
        "limit",
        "top"
      ],
      "answer": [
        "summarize",
        "arg_max"
      ],
      "image": "Images/hotspot44.jpg",
      "explanation": "The `summarize` operator groups data and performs aggregations across specified fields. In this case, `summarize` is used with `arg_max()` to extract the most recent log (i.e., maximum timestamp) per incident. The `arg_max()` function retrieves the entire row associated with the maximum value in a specified column.\n\nReference: https://learn.microsoft.com/en-us/azure/data-explorer/kusto/query/summarizeoperator\nhttps://www.drware.com/whats-new-soc-operational-metrics-now-available-in-sentinel/\n"
    },
    {
      "type": "drag_and_drop",
      "question": "You have the resources shown in the following table.\n| Name    | Description                                                                 |\n|---------|------------------------------------------------------------------------------|\n| SW1     | An Azure Sentinel workspace                                                 |\n| CEF1    | A Linux server configured to forward Common Event Format (CEF) logs to SW1 |\n| Server1 | A Linux server configured to send Common Event Format (CEF) logs to CEF1   |\n| Server2 | A Linux server configured to send Syslog logs to CEF1                      |\n\nYou need to prevent duplicate events from occurring in SW1.\nWhat should you use for each action? To answer, drag the appropriate resources to the correct actions. Each resource may be used once, more than once, or not at all. You may need to drag the split bar between panes or scroll to view content.\nNOTE: Each correct selection is worth one point.",
      "options": [
        "SW1",
        "CEF1",
        "Server1",
        "Server2"
      ],
      "answer": [
        "Server1",
        "CEF1"
      ],
      "image": "Images/hotspot35.jpg",
      "explanation": "To prevent duplicate logs in Azure Sentinel when using CEF forwarders:\n- Ensure that CEF logs are sent to a central forwarder (CEF1) from Server1.\n- The forwarder (CEF1) sends unique logs to the Sentinel workspace (SW1), avoiding direct duplicates.\n\nThis configuration ensures deduplication at the forwarder layer before ingestion.\n\nReference:https://learn.microsoft.com/en-us/azure/sentinel/cef-syslog-ama-overview?tabs=single"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft Sentinel workspace named sws1.\nYou need to create a hunting query to identify users that list storage keys of multiple Azure Storage accounts. The solution must exclude users that list storage keys for a single storage account.\nHow should you complete the query? To answer, select the appropriate options in the answer area.\nNOTE: Each correct selection is worth one point.",
      "options": [
        "AzureActivity",
        "BehaviourAnalytics",
        "SecurityEvent",
        "autocluster()",
        "bin()",
        "count()"
      ],
      "answer": [
        "AzureActivity",
        "autocluster()"
      ],
      "image": "Images/hotspot46.jpg",
      "explanation": "The `AzureActivity` table logs administrative operations including actions on Azure Storage accounts. The `autocluster()` function helps identify anomalies or patterns in data, such as users listing keys for multiple accounts. This setup effectively identifies users with access to multiple keys while minimizing manual filtering.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/hunting\nhttps://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Azure%20Activity/Hunting%20Queries/Anomalous_Listing_Of_Storage_Keys.yaml\n"
    },
    {
      "type": "drag_and_drop",
      "question": "You have a Microsoft Sentinel workspace named workspace1 and an Azure virtual machine named VM1.\nYou receive an alert for suspicious use of PowerShell on VM1.\nYou need to investigate the incident, identify which event triggered the alert, and identify whether the following actions occurred on VM1 after the alert:\n- The modification of local group memberships\n- The purging of event logs\nWhich three actions should you perform in sequence in the Azure portal?\nSelect and Place:",
      "options": [
        "From the details pane of the incident, select Investigate.",
        "From the Investigation blade, select the entity that represents VM1.",
        "From the Investigation blade, select the entity that represents powershell.exe.",
        "From the Investigation blade, select Timeline.",
        "From the Investigation blade, select Info.",
        "From the Investigation blade, select Insights."
      ],
      "answer": [
        "From the Investigation blade, select Insights.",
        "From the Investigation blade, select the entity that represents VM1.",
        "From the details pane of the incident, select Investigate."
      ],
      "image": "Images/hotspot47.jpg",
      "explanation": "To effectively investigate an alert in Microsoft Sentinel:\n1. **Select 'Insights'** to quickly understand significant behavioral patterns or activities linked to the incident.\n2. **Drill down into the entity (VM1)** to see its timeline and associated actions.\n3. **Use the 'Investigate' button** from the incident pane to launch the investigation graph for deeper analysis.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/investigate-cases\nhttps://github.com/Azure/Azure-Sentinel/wiki/Investigation-Insights---Overview\n"
    },
    {
      "type": "drag_and_drop",
      "question": "You have 100 Azure subscriptions that have enhanced security features in Microsoft Defender for Cloud enabled. All the subscriptions are linked to a single Azure Active Directory (Azure AD) tenant.\nYou need to stream the Defender for Cloud logs to a syslog server. The solution must minimize administrative effort.\nWhat should you do? To answer, select the appropriate options in the answer area.\nNOTE: Each correct selection is worth one point.",
      "options": [
        "Azure event hub",
        "Azure Storage account",
        "Log Analytics workspace",
        "Configuring continuous export in Defender for Cloud for each subscription",
        "Creating an Azure Policy assignment at the root management group",
        "Modifying the diagnostic settings of the tenant"
      ],
      "answer": [
        "Azure event hub",
        "Creating an Azure Policy assignment at the root management group"
      ],
      "image": "Images/hotspot48.png",
      "explanation": "To efficiently stream logs from multiple subscriptions to a syslog server, you should:\n1. Use **Azure Event Hub** to stream the logs externally.\n2. Apply a **policy at the root management group** to configure this setup across all subscriptions automatically, minimizing manual configuration.\n\nReference: https://learn.microsoft.com/en-us/azure/defender-for-cloud/export-to-siem#stream-alerts-with-continuous-export\nhttps://learn.microsoft.com/en-us/azure/defender-for-cloud/continuous-export?tabs=azure-policy#configure-continuous-export-at-scale-using-the-supplied-policies\n"
    },
    {
      "type": "drag_and_drop",
      "question": "You have an Azure subscription that contains 100 Linux virtual machines.\nYou need to configure Microsoft Sentinel to collect event logs from the virtual machines.\nWhich three actions should you perform in sequence? To answer, move the appropriate actions from the list of actions to the answer area and arrange them in the correct order.\nSelect and Place:",
      "options": [
        "Install the Log Analytics agent for Linux on the virtual machines.",
        "Add Microsoft Sentinel to a workspace.",
        "Add a Security Events connector to the workspace.",
        "Add an Microsoft Sentinel workbook.",
        "Add a Syslog connector to the workspace."
      ],
      "answer": [
        "Add Microsoft Sentinel to a workspace.",
        "Add a Syslog connector to the workspace.",
        "Install the Log Analytics agent for Linux on the virtual machines."
      ],
      "image": "Images/hotspot49.png",
      "explanation": "To collect logs from Linux VMs into Microsoft Sentinel:\n1. First, enable Microsoft Sentinel on a Log Analytics workspace.\n2. Then, add the **Syslog connector** to collect log data from Linux systems.\n3. Finally, install the **Log Analytics agent** on the virtual machines to start sending data.\n\nReference: https://learn.microsoft.com/en-us/azure/sentinel/connect-syslog"
    }
  ],
  "Topic 3": []
}
